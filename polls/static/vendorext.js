function dtmlXMLLoaderObject(funcObject,dhtmlObject,async,rSeed){return this.xmlDoc="","undefined"!=typeof async?this.async=async:this.async=!0,this.onloadAction=funcObject||null,this.mainObject=dhtmlObject||null,this.waitCall=null,this.rSeed=rSeed||!1,this}function callerFunction(funcObject,dhtmlObject){return this.handler=function(e){return e||(e=window.event),funcObject(e,dhtmlObject),!0},this.handler}function getAbsoluteLeft(htmlObject){return getOffset(htmlObject).left}function getAbsoluteTop(htmlObject){return getOffset(htmlObject).top}function getOffsetSum(elem){for(var top=0,left=0;elem;)top+=parseInt(elem.offsetTop),left+=parseInt(elem.offsetLeft),elem=elem.offsetParent;return{top:top,left:left}}function getOffsetRect(elem){var box=elem.getBoundingClientRect(),body=document.body,docElem=document.documentElement,scrollTop=window.pageYOffset||docElem.scrollTop||body.scrollTop,scrollLeft=window.pageXOffset||docElem.scrollLeft||body.scrollLeft,clientTop=docElem.clientTop||body.clientTop||0,clientLeft=docElem.clientLeft||body.clientLeft||0,top=box.top+scrollTop-clientTop,left=box.left+scrollLeft-clientLeft;return{top:Math.round(top),left:Math.round(left)}}function getOffset(elem){return elem.getBoundingClientRect?getOffsetRect(elem):getOffsetSum(elem)}function convertStringToBoolean(inputString){switch("string"==typeof inputString&&(inputString=inputString.toLowerCase()),inputString){case"1":case"true":case"yes":case"y":case 1:case!0:return!0;default:return!1}}function getUrlSymbol(str){return-1!=str.indexOf("?")?"&":"?"}function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function _dhtmlxError(type,name,params){return this.catches||(this.catches=[]),this}function dhtmlXHeir(a,b){for(var c in b)"function"==typeof b[c]&&(a[c]=b[c]);return a}function dataProcessor(serverProcessorURL){return this.serverProcessor=serverProcessorURL,this.action_param="!nativeeditor_status",this.object=null,this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._tMode="GET",this.post_delim="_",this._waitMode=0,this._in_progress={},this._invalid={},this.mandatoryFields=[],this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),dhtmlxEventable(this),this}var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(Animation,SimpleTimeline,TweenLite){var TimelineLite=function(vars){SimpleTimeline.call(this,vars),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var val,p,v=this.vars;for(p in v)val=v[p],_isArray(val)&&-1!==val.join("").indexOf("{self}")&&(v[p]=this._swapSelfInParams(val));_isArray(v.tweens)&&this.add(v.tweens,0,v.align,v.stagger)},_tinyNum=1e-10,TweenLiteInternals=TweenLite._internals,_internals=TimelineLite._internals={},_isSelector=TweenLiteInternals.isSelector,_isArray=TweenLiteInternals.isArray,_lazyTweens=TweenLiteInternals.lazyTweens,_lazyRender=TweenLiteInternals.lazyRender,_blankArray=[],_globals=_gsScope._gsDefine.globals,_copy=function(vars){var p,copy={};for(p in vars)copy[p]=vars[p];return copy},_pauseCallback=_internals.pauseCallback=function(tween,callback,params,scope){var tl=tween._timeline,time=tl._totalTime;!callback&&this._forcingPlayhead||tl._rawPrevTime===tween._startTime||(tl.pause(tween._startTime),callback&&callback.apply(scope||tl,params||_blankArray),this._forcingPlayhead&&tl.seek(time))},_slice=function(a){var i,b=[],l=a.length;for(i=0;i!==l;b.push(a[i++]));return b},p=TimelineLite.prototype=new SimpleTimeline;return TimelineLite.version="1.15.1",p.constructor=TimelineLite,p.kill()._gc=p._forcingPlayhead=!1,p.to=function(target,duration,vars,position){var Engine=vars.repeat&&_globals.TweenMax||TweenLite;return duration?this.add(new Engine(target,duration,vars),position):this.set(target,vars,position)},p.from=function(target,duration,vars,position){return this.add((vars.repeat&&_globals.TweenMax||TweenLite).from(target,duration,vars),position)},p.fromTo=function(target,duration,fromVars,toVars,position){var Engine=toVars.repeat&&_globals.TweenMax||TweenLite;return duration?this.add(Engine.fromTo(target,duration,fromVars,toVars),position):this.set(target,toVars,position)},p.staggerTo=function(targets,duration,vars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope){var i,tl=new TimelineLite({onComplete:onCompleteAll,onCompleteParams:onCompleteAllParams,onCompleteScope:onCompleteAllScope,smoothChildTiming:this.smoothChildTiming});for("string"==typeof targets&&(targets=TweenLite.selector(targets)||targets),targets=targets||[],_isSelector(targets)&&(targets=_slice(targets)),stagger=stagger||0,0>stagger&&(targets=_slice(targets),targets.reverse(),stagger*=-1),i=0;i<targets.length;i++)vars.startAt&&(vars.startAt=_copy(vars.startAt)),tl.to(targets[i],duration,_copy(vars),i*stagger);return this.add(tl,position)},p.staggerFrom=function(targets,duration,vars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope){return vars.immediateRender=0!=vars.immediateRender,vars.runBackwards=!0,this.staggerTo(targets,duration,vars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope)},p.staggerFromTo=function(targets,duration,fromVars,toVars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope){return toVars.startAt=fromVars,toVars.immediateRender=0!=toVars.immediateRender&&0!=fromVars.immediateRender,this.staggerTo(targets,duration,toVars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope)},p.call=function(callback,params,scope,position){return this.add(TweenLite.delayedCall(0,callback,params,scope),position)},p.set=function(target,vars,position){return position=this._parseTimeOrLabel(position,0,!0),null==vars.immediateRender&&(vars.immediateRender=position===this._time&&!this._paused),this.add(new TweenLite(target,0,vars),position)},TimelineLite.exportRoot=function(vars,ignoreDelayedCalls){vars=vars||{},null==vars.smoothChildTiming&&(vars.smoothChildTiming=!0);var tween,next,tl=new TimelineLite(vars),root=tl._timeline;for(null==ignoreDelayedCalls&&(ignoreDelayedCalls=!0),root._remove(tl,!0),tl._startTime=0,tl._rawPrevTime=tl._time=tl._totalTime=root._time,tween=root._first;tween;)next=tween._next,ignoreDelayedCalls&&tween instanceof TweenLite&&tween.target===tween.vars.onComplete||tl.add(tween,tween._startTime-tween._delay),tween=next;return root.add(tl,0),tl},p.add=function(value,position,align,stagger){var curTime,l,i,child,tl,beforeRawTime;if("number"!=typeof position&&(position=this._parseTimeOrLabel(position,0,!0,value)),!(value instanceof Animation)){if(value instanceof Array||value&&value.push&&_isArray(value)){for(align=align||"normal",stagger=stagger||0,curTime=position,l=value.length,i=0;l>i;i++)_isArray(child=value[i])&&(child=new TimelineLite({tweens:child})),this.add(child,curTime),"string"!=typeof child&&"function"!=typeof child&&("sequence"===align?curTime=child._startTime+child.totalDuration()/child._timeScale:"start"===align&&(child._startTime-=child.delay())),curTime+=stagger;return this._uncache(!0)}if("string"==typeof value)return this.addLabel(value,position);if("function"!=typeof value)throw"Cannot add "+value+" into the timeline; it is not a tween, timeline, function, or string.";value=TweenLite.delayedCall(0,value)}if(SimpleTimeline.prototype.add.call(this,value,position),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(tl=this,beforeRawTime=tl.rawTime()>value._startTime;tl._timeline;)beforeRawTime&&tl._timeline.smoothChildTiming?tl.totalTime(tl._totalTime,!0):tl._gc&&tl._enabled(!0,!1),tl=tl._timeline;return this},p.remove=function(value){if(value instanceof Animation)return this._remove(value,!1);if(value instanceof Array||value&&value.push&&_isArray(value)){for(var i=value.length;--i>-1;)this.remove(value[i]);return this}return"string"==typeof value?this.removeLabel(value):this.kill(null,value)},p._remove=function(tween,skipDisable){SimpleTimeline.prototype._remove.call(this,tween,skipDisable);var last=this._last;return last?this._time>last._startTime+last._totalDuration/last._timeScale&&(this._time=this.duration(),this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},p.append=function(value,offsetOrLabel){return this.add(value,this._parseTimeOrLabel(null,offsetOrLabel,!0,value))},p.insert=p.insertMultiple=function(value,position,align,stagger){return this.add(value,position||0,align,stagger)},p.appendMultiple=function(tweens,offsetOrLabel,align,stagger){return this.add(tweens,this._parseTimeOrLabel(null,offsetOrLabel,!0,tweens),align,stagger)},p.addLabel=function(label,position){return this._labels[label]=this._parseTimeOrLabel(position),this},p.addPause=function(position,callback,params,scope){var t=TweenLite.delayedCall(0,_pauseCallback,["{self}",callback,params,scope],this);return t.data="isPause",this.add(t,position)},p.removeLabel=function(label){return delete this._labels[label],this},p.getLabelTime=function(label){return null!=this._labels[label]?this._labels[label]:-1},p._parseTimeOrLabel=function(timeOrLabel,offsetOrLabel,appendIfAbsent,ignore){var i;if(ignore instanceof Animation&&ignore.timeline===this)this.remove(ignore);else if(ignore&&(ignore instanceof Array||ignore.push&&_isArray(ignore)))for(i=ignore.length;--i>-1;)ignore[i]instanceof Animation&&ignore[i].timeline===this&&this.remove(ignore[i]);if("string"==typeof offsetOrLabel)return this._parseTimeOrLabel(offsetOrLabel,appendIfAbsent&&"number"==typeof timeOrLabel&&null==this._labels[offsetOrLabel]?timeOrLabel-this.duration():0,appendIfAbsent);if(offsetOrLabel=offsetOrLabel||0,"string"!=typeof timeOrLabel||!isNaN(timeOrLabel)&&null==this._labels[timeOrLabel])null==timeOrLabel&&(timeOrLabel=this.duration());else{if(i=timeOrLabel.indexOf("="),-1===i)return null==this._labels[timeOrLabel]?appendIfAbsent?this._labels[timeOrLabel]=this.duration()+offsetOrLabel:offsetOrLabel:this._labels[timeOrLabel]+offsetOrLabel;offsetOrLabel=parseInt(timeOrLabel.charAt(i-1)+"1",10)*Number(timeOrLabel.substr(i+1)),timeOrLabel=i>1?this._parseTimeOrLabel(timeOrLabel.substr(0,i-1),0,appendIfAbsent):this.duration()}return Number(timeOrLabel)+offsetOrLabel},p.seek=function(position,suppressEvents){return this.totalTime("number"==typeof position?position:this._parseTimeOrLabel(position),suppressEvents!==!1)},p.stop=function(){return this.paused(!0)},p.gotoAndPlay=function(position,suppressEvents){return this.play(position,suppressEvents)},p.gotoAndStop=function(position,suppressEvents){return this.pause(position,suppressEvents)},p.render=function(time,suppressEvents,force){this._gc&&this._enabled(!0,!1);var tween,isComplete,next,callback,internalForce,totalDur=this._dirty?this.totalDuration():this._totalDuration,prevTime=this._time,prevStart=this._startTime,prevTimeScale=this._timeScale,prevPaused=this._paused;if(time>=totalDur?(this._totalTime=this._time=totalDur,this._reversed||this._hasPausedChild()||(isComplete=!0,callback="onComplete",0===this._duration&&(0===time||this._rawPrevTime<0||this._rawPrevTime===_tinyNum)&&this._rawPrevTime!==time&&this._first&&(internalForce=!0,this._rawPrevTime>_tinyNum&&(callback="onReverseComplete"))),this._rawPrevTime=this._duration||!suppressEvents||time||this._rawPrevTime===time?time:_tinyNum,time=totalDur+1e-4):1e-7>time?(this._totalTime=this._time=0,(0!==prevTime||0===this._duration&&this._rawPrevTime!==_tinyNum&&(this._rawPrevTime>0||0>time&&this._rawPrevTime>=0))&&(callback="onReverseComplete",isComplete=this._reversed),0>time?(this._active=!1,this._rawPrevTime>=0&&this._first&&(internalForce=!0),this._rawPrevTime=time):(this._rawPrevTime=this._duration||!suppressEvents||time||this._rawPrevTime===time?time:_tinyNum,time=0,this._initted||(internalForce=!0))):this._totalTime=this._time=this._rawPrevTime=time,this._time!==prevTime&&this._first||force||internalForce){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==prevTime&&time>0&&(this._active=!0),0===prevTime&&this.vars.onStart&&0!==this._time&&(suppressEvents||this.vars.onStart.apply(this.vars.onStartScope||this,this.vars.onStartParams||_blankArray)),this._time>=prevTime)for(tween=this._first;tween&&(next=tween._next,!this._paused||prevPaused);)(tween._active||tween._startTime<=this._time&&!tween._paused&&!tween._gc)&&(tween._reversed?tween.render((tween._dirty?tween.totalDuration():tween._totalDuration)-(time-tween._startTime)*tween._timeScale,suppressEvents,force):tween.render((time-tween._startTime)*tween._timeScale,suppressEvents,force)),tween=next;else for(tween=this._last;tween&&(next=tween._prev,!this._paused||prevPaused);)(tween._active||tween._startTime<=prevTime&&!tween._paused&&!tween._gc)&&(tween._reversed?tween.render((tween._dirty?tween.totalDuration():tween._totalDuration)-(time-tween._startTime)*tween._timeScale,suppressEvents,force):tween.render((time-tween._startTime)*tween._timeScale,suppressEvents,force)),tween=next;this._onUpdate&&(suppressEvents||(_lazyTweens.length&&_lazyRender(),this._onUpdate.apply(this.vars.onUpdateScope||this,this.vars.onUpdateParams||_blankArray))),callback&&(this._gc||(prevStart===this._startTime||prevTimeScale!==this._timeScale)&&(0===this._time||totalDur>=this.totalDuration())&&(isComplete&&(_lazyTweens.length&&_lazyRender(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!suppressEvents&&this.vars[callback]&&this.vars[callback].apply(this.vars[callback+"Scope"]||this,this.vars[callback+"Params"]||_blankArray)))}},p._hasPausedChild=function(){for(var tween=this._first;tween;){if(tween._paused||tween instanceof TimelineLite&&tween._hasPausedChild())return!0;tween=tween._next}return!1},p.getChildren=function(nested,tweens,timelines,ignoreBeforeTime){ignoreBeforeTime=ignoreBeforeTime||-9999999999;for(var a=[],tween=this._first,cnt=0;tween;)tween._startTime<ignoreBeforeTime||(tween instanceof TweenLite?tweens!==!1&&(a[cnt++]=tween):(timelines!==!1&&(a[cnt++]=tween),nested!==!1&&(a=a.concat(tween.getChildren(!0,tweens,timelines)),cnt=a.length))),tween=tween._next;return a},p.getTweensOf=function(target,nested){var tweens,i,disabled=this._gc,a=[],cnt=0;for(disabled&&this._enabled(!0,!0),tweens=TweenLite.getTweensOf(target),i=tweens.length;--i>-1;)(tweens[i].timeline===this||nested&&this._contains(tweens[i]))&&(a[cnt++]=tweens[i]);return disabled&&this._enabled(!1,!0),a},p.recent=function(){return this._recent},p._contains=function(tween){for(var tl=tween.timeline;tl;){if(tl===this)return!0;tl=tl.timeline}return!1},p.shiftChildren=function(amount,adjustLabels,ignoreBeforeTime){ignoreBeforeTime=ignoreBeforeTime||0;for(var p,tween=this._first,labels=this._labels;tween;)tween._startTime>=ignoreBeforeTime&&(tween._startTime+=amount),tween=tween._next;if(adjustLabels)for(p in labels)labels[p]>=ignoreBeforeTime&&(labels[p]+=amount);return this._uncache(!0)},p._kill=function(vars,target){if(!vars&&!target)return this._enabled(!1,!1);for(var tweens=target?this.getTweensOf(target):this.getChildren(!0,!0,!1),i=tweens.length,changed=!1;--i>-1;)tweens[i]._kill(vars,target)&&(changed=!0);return changed},p.clear=function(labels){var tweens=this.getChildren(!1,!0,!0),i=tweens.length;for(this._time=this._totalTime=0;--i>-1;)tweens[i]._enabled(!1,!1);return labels!==!1&&(this._labels={}),this._uncache(!0)},p.invalidate=function(){for(var tween=this._first;tween;)tween.invalidate(),tween=tween._next;return Animation.prototype.invalidate.call(this)},p._enabled=function(enabled,ignoreTimeline){if(enabled===this._gc)for(var tween=this._first;tween;)tween._enabled(enabled,!0),tween=tween._next;return SimpleTimeline.prototype._enabled.call(this,enabled,ignoreTimeline)},p.totalTime=function(time,suppressEvents,uncapped){this._forcingPlayhead=!0;var val=Animation.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,val},p.duration=function(value){return arguments.length?(0!==this.duration()&&0!==value&&this.timeScale(this._duration/value),this):(this._dirty&&this.totalDuration(),this._duration)},p.totalDuration=function(value){if(!arguments.length){if(this._dirty){for(var prev,end,max=0,tween=this._last,prevStart=999999999999;tween;)prev=tween._prev,tween._dirty&&tween.totalDuration(),tween._startTime>prevStart&&this._sortChildren&&!tween._paused?this.add(tween,tween._startTime-tween._delay):prevStart=tween._startTime,tween._startTime<0&&!tween._paused&&(max-=tween._startTime,this._timeline.smoothChildTiming&&(this._startTime+=tween._startTime/this._timeScale),this.shiftChildren(-tween._startTime,!1,-9999999999),prevStart=0),end=tween._startTime+tween._totalDuration/tween._timeScale,end>max&&(max=end),tween=prev;this._duration=this._totalDuration=max,this._dirty=!1}return this._totalDuration}return 0!==this.totalDuration()&&0!==value&&this.timeScale(this._totalDuration/value),this},p.usesFrames=function(){for(var tl=this._timeline;tl._timeline;)tl=tl._timeline;return tl===Animation._rootFramesTimeline},p.rawTime=function(){return this._paused?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale},TimelineLite},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(name){"use strict";var getGlobal=function(){return(_gsScope.GreenSockGlobals||_gsScope)[name]};"function"==typeof define&&define.amd?define(["TweenLite"],getGlobal):"undefined"!=typeof module&&module.exports&&(require("./TweenLite.js"),module.exports=getGlobal())}("TimelineLite"),function($){$.reject=function(options){var opts=$.extend(!0,{reject:{all:!1,msie:6},display:[],browserShow:!0,browserInfo:{chrome:{text:"Google Chrome",url:"http://www.google.com/chrome/"},firefox:{text:"Mozilla Firefox",url:"http://www.mozilla.com/firefox/"},safari:{text:"Safari",url:"http://www.apple.com/safari/download/"},opera:{text:"Opera",url:"http://www.opera.com/download/"},msie:{text:"Internet Explorer",url:"http://www.microsoft.com/windows/Internet-explorer/"}},header:"Did you know that your Internet Browser is out of date?",paragraph1:"Your browser is out of date, and may not be compatible with our website. A list of the most popular web browsers can be found below.",paragraph2:"Just click on the icons to get to the download page",close:!0,closeMessage:"By closing this window you acknowledge that your experience on this website may be degraded",closeLink:"Close This Window",closeURL:"#",closeESC:!0,closeCookie:!1,cookieSettings:{path:"/",expires:0},imagePath:"./images/",overlayBgColor:"#000",overlayOpacity:.8,fadeInTime:"fast",fadeOutTime:"fast",analytics:!1},options);opts.display.length<1&&(opts.display=["chrome","firefox","safari","opera","msie"]),$.isFunction(opts.beforeReject)&&opts.beforeReject(),opts.close||(opts.closeESC=!1);var browserCheck=function(settings){var layout=settings[$.layout.name],browser=settings[$.browser.name];return!!(settings.all||browser&&(browser===!0||$.browser.versionNumber<=browser)||settings[$.browser.className]||layout&&(layout===!0||$.layout.versionNumber<=layout)||settings[$.os.name])};if(!browserCheck(opts.reject))return $.isFunction(opts.onFail)&&opts.onFail(),!1;if(opts.close&&opts.closeCookie){var COOKIE_NAME="jreject-close",_cookie=function(name,value){if("undefined"!=typeof value){var expires="";if(0!==opts.cookieSettings.expires){var date=new Date;date.setTime(date.getTime()+1e3*opts.cookieSettings.expires),expires="; expires="+date.toGMTString()}var path=opts.cookieSettings.path||"/";return document.cookie=name+"="+encodeURIComponent(value?value:"")+expires+"; path="+path,!0}var cookie,val=null;if(document.cookie&&""!==document.cookie)for(var cookies=document.cookie.split(";"),clen=cookies.length,i=0;clen>i;++i)if(cookie=$.trim(cookies[i]),cookie.substring(0,name.length+1)==name+"="){var len=name.length;val=decodeURIComponent(cookie.substring(len+1));break}return val};if(_cookie(COOKIE_NAME))return!1}var html='<div id="jr_overlay"></div><div id="jr_wrap"><div id="jr_inner"><h1 id="jr_header">'+opts.header+"</h1>"+(""===opts.paragraph1?"":"<p>"+opts.paragraph1+"</p>")+(""===opts.paragraph2?"":"<p>"+opts.paragraph2+"</p>"),displayNum=0;if(opts.browserShow){html+="<ul>";for(var x in opts.display){var browser=opts.display[x],info=opts.browserInfo[browser]||!1;if(info&&(void 0==info.allow||browserCheck(info.allow))){var url=info.url||"#";html+='<li id="jr_'+browser+'"><div class="jr_icon"></div><div><a href="'+url+'">'+(info.text||"Unknown")+"</a></div></li>",++displayNum}}html+="</ul>"}html+='<div id="jr_close">'+(opts.close?'<a href="'+opts.closeURL+'">'+opts.closeLink+"</a><p>"+opts.closeMessage+"</p>":"")+"</div></div></div>";var element=$("<div>"+html+"</div>"),size=_pageSize(),scroll=_scrollSize();element.bind("closejr",function(){if(!opts.close)return!1;$.isFunction(opts.beforeClose)&&opts.beforeClose(),$(this).unbind("closejr"),$("#jr_overlay,#jr_wrap").fadeOut(opts.fadeOutTime,function(){$(this).remove(),$.isFunction(opts.afterClose)&&opts.afterClose()});var elmhide="embed.jr_hidden, object.jr_hidden, select.jr_hidden, applet.jr_hidden";return $(elmhide).show().removeClass("jr_hidden"),opts.closeCookie&&_cookie(COOKIE_NAME,"true"),!0});var analytics=function(url){if(!opts.analytics)return!1;var host=url.split(/\/+/g)[1];try{ga("send","event","External","Click",host,url)}catch(e){try{_gaq.push(["_trackEvent","External Links",host,url])}catch(e){}}},openBrowserLinks=function(url){return analytics(url),window.open(url,"jr_"+Math.round(11*Math.random())),!1};return element.find("#jr_overlay").css({width:size[0],height:size[1],background:opts.overlayBgColor,opacity:opts.overlayOpacity}),element.find("#jr_wrap").css({top:scroll[1]+size[3]/4,left:scroll[0]}),element.find("#jr_inner").css({minWidth:100*displayNum,maxWidth:140*displayNum,width:"trident"==$.layout.name?155*displayNum:"auto"}),element.find("#jr_inner li").css({background:'transparent url("'+opts.imagePath+'background_browser.gif") no-repeat scroll left top'}),element.find("#jr_inner li .jr_icon").each(function(){var self=$(this);self.css("background","transparent url("+opts.imagePath+"browser_"+self.parent("li").attr("id").replace(/jr_/,"")+".gif) no-repeat scroll left top"),self.click(function(){var url=$(this).next("div").children("a").attr("href");openBrowserLinks(url)})}),element.find("#jr_inner li a").click(function(){return openBrowserLinks($(this).attr("href")),!1}),element.find("#jr_close a").click(function(){return $(this).trigger("closejr"),"#"===opts.closeURL?!1:void 0}),$("#jr_overlay").focus(),$("embed, object, select, applet").each(function(){$(this).is(":visible")&&$(this).hide().addClass("jr_hidden")}),$("body").append(element.hide().fadeIn(opts.fadeInTime)),$(window).bind("resize scroll",function(){var size=_pageSize();$("#jr_overlay").css({width:size[0],height:size[1]});var scroll=_scrollSize();$("#jr_wrap").css({top:scroll[1]+size[3]/4,left:scroll[0]})}),opts.closeESC&&$(document).bind("keydown",function(event){27==event.keyCode&&element.trigger("closejr")}),$.isFunction(opts.afterReject)&&opts.afterReject(),!0};var _pageSize=function(){var xScroll=window.innerWidth&&window.scrollMaxX?window.innerWidth+window.scrollMaxX:document.body.scrollWidth>document.body.offsetWidth?document.body.scrollWidth:document.body.offsetWidth,yScroll=window.innerHeight&&window.scrollMaxY?window.innerHeight+window.scrollMaxY:document.body.scrollHeight>document.body.offsetHeight?document.body.scrollHeight:document.body.offsetHeight,windowWidth=window.innerWidth?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth,windowHeight=window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight;return[windowWidth>xScroll?xScroll:windowWidth,windowHeight>yScroll?windowHeight:yScroll,windowWidth,windowHeight]},_scrollSize=function(){return[window.pageXOffset?window.pageXOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollLeft:document.body.scrollLeft,window.pageYOffset?window.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop]}}(jQuery),function($){$.browserTest=function(a,z){var u="unknown",x="X",m=function(r,h){for(var i=0;i<h.length;i+=1)r=r.replace(h[i][0],h[i][1]);return r},c=function(i,a,b,c){var r={name:m((a.exec(i)||[u,u])[1],b)};if(r[r.name]=!0,r.opera?r.version=window.opera.version():r.version=(c.exec(i)||[x,x,x,x])[3],/safari/.test(r.name)){var safariversion=/(safari)(\/|\s)([a-z0-9\.\+]*?)(\;|dev|rel|\s|$)/,res=safariversion.exec(i);res&&res[3]&&res[3]<400&&(r.version="2.0")}else"presto"===r.name&&(r.version=$.browser.version>9.27?"futhark":"linear_b");if(/msie/.test(r.name)&&r.version===x){var ieVersion=/rv:(\d+\.\d+)/.exec(i);r.version=ieVersion[1]}r.versionNumber=parseFloat(r.version,10)||0;var minorStart=1;return r.versionNumber<100&&r.versionNumber>9&&(minorStart=2),r.versionX=r.version!==x?r.version.substr(0,minorStart):x,r.className=r.name+r.versionX,r};a=(/Opera|Navigator|Minefield|KHTML|Chrome|CriOS/.test(a)?m(a,[[/(Firefox|MSIE|KHTML,\slike\sGecko|Konqueror)/,""],["Chrome Safari","Chrome"],["CriOS","Chrome"],["KHTML","Konqueror"],["Minefield","Firefox"],["Navigator","Netscape"]]):a).toLowerCase(),$.browser=$.extend(z?{}:$.browser,c(a,/(camino|chrome|crios|firefox|netscape|konqueror|lynx|msie|trident|opera|safari)/,[["trident","msie"]],/(camino|chrome|crios|firefox|netscape|netscape6|opera|version|konqueror|lynx|msie|rv|safari)(:|\/|\s)([a-z0-9\.\+]*?)(\;|dev|rel|\s|$)/)),$.layout=c(a,/(gecko|konqueror|msie|trident|opera|webkit)/,[["konqueror","khtml"],["msie","trident"],["opera","presto"]],/(applewebkit|rv|konqueror|msie)(\:|\/|\s)([a-z0-9\.]*?)(\;|\)|\s)/),$.os={name:(/(win|mac|linux|sunos|solaris|iphone|ipad)/.exec(navigator.platform.toLowerCase())||[u])[0].replace("sunos","solaris")},z||$("html").addClass([$.os.name,$.browser.name,$.browser.className,$.layout.name,$.layout.className].join(" "))},$.browserTest(navigator.userAgent)}(jQuery),$.rejectLessThan=function(options){var opts=$.extend(!0,{reject:{all:!1,unknown:!0}},options),reject=[];$.each(opts.reject,function(key,val){if("all"==key||"unknown"==key)reject[key]=val;else for(var i=1;val-1>=i;i++)reject[key+i]=!0;opts.reject=reject}),$.reject(opts)},$(document).ready(function(){$.rejectLessThan({reject:{chrome:28,firefox:22,safari:6,opera:15,msie:10},display:["firefox","chrome","msie"],imagePath:"/images/",browserInfo:{firefox:{text:"Mozilla Firefox<br/>Windows XP SP2 minimum<br/>Mac OS X 10.6 minimum",url:"http://www.mozilla.org/fr/firefox"},chrome:{text:"Google Chrome<br/>Windows XP SP2 minimum<br/>Mac OS X 10.6 minimum",url:"http://www.google.fr/intl/fr/chrome/"},msie:{text:"Internet Explorer<br/>Windows 7 minimum",url:"http://windows.microsoft.com/fr-fr/internet-explorer/download-ie"}},header:"Votre navigateur n'est peut être pas compatible",paragraph1:"La version de votre navigateur ne vous permet pas d'utiliser cet outil et ses fonctionnalités avancées.",paragraph2:"Pour télécharger une version compatible, veuillez cliquer sur l'un des navigateurs suivants :",close:!0,closeMessage:"En fermant cette fenêtre, vous reconnaissez que votre expérience sur ce site peut être dégradée",closeLink:"Fermer cette fenêtre",closeCookie:!1})}),window.dhtmlXScheduler=window.scheduler={version:"4.3.0"},window.dhtmlx||(dhtmlx=function(obj){for(var a in obj)dhtmlx[a]=obj[a];return dhtmlx}),dhtmlx.extend_api=function(name,map,ext){var t=window[name];t&&(window[name]=function(obj){var that;if(obj&&"object"==typeof obj&&!obj.tagName){that=t.apply(this,map._init?map._init(obj):arguments);for(var a in dhtmlx)map[a]&&this[map[a]](dhtmlx[a]);for(var a in obj)map[a]?this[map[a]](obj[a]):0===a.indexOf("on")&&this.attachEvent(a,obj[a])}else that=t.apply(this,arguments);return map._patch&&map._patch(this),that||this},window[name].prototype=t.prototype,ext&&dhtmlXHeir(window[name].prototype,ext))},dhtmlxAjax={get:function(url,callback){var t=new dtmlXMLLoaderObject(!0);return t.async=arguments.length<3,t.waitCall=callback,t.loadXML(url),t},post:function(url,post,callback){var t=new dtmlXMLLoaderObject(!0);return t.async=arguments.length<4,t.waitCall=callback,t.loadXML(url,!0,post),t},getSync:function(url){return this.get(url,null,!0)},postSync:function(url,post){return this.post(url,post,null,!0)}},dtmlXMLLoaderObject.count=0,dtmlXMLLoaderObject.prototype.waitLoadFunction=function(dhtmlObject){var once=!0;return this.check=function(){if(dhtmlObject&&dhtmlObject.onloadAction&&(!dhtmlObject.xmlDoc.readyState||4==dhtmlObject.xmlDoc.readyState)){if(!once)return;once=!1,dtmlXMLLoaderObject.count++,"function"==typeof dhtmlObject.onloadAction&&dhtmlObject.onloadAction(dhtmlObject.mainObject,null,null,null,dhtmlObject),dhtmlObject.waitCall&&(dhtmlObject.waitCall.call(this,dhtmlObject),dhtmlObject.waitCall=null)}},this.check},dtmlXMLLoaderObject.prototype.getXMLTopNode=function(tagName,oldObj){var z;if(this.xmlDoc.responseXML){var temp=this.xmlDoc.responseXML.getElementsByTagName(tagName);if(0===temp.length&&-1!=tagName.indexOf(":"))var temp=this.xmlDoc.responseXML.getElementsByTagName(tagName.split(":")[1]);z=temp[0]}else z=this.xmlDoc.documentElement;if(z)return this._retry=!1,z;if(!this._retry&&_isIE){this._retry=!0;var oldObj=this.xmlDoc;return this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),!0),this.getXMLTopNode(tagName,oldObj)}return dhtmlxError.throwError("LoadXML","Incorrect XML",[oldObj||this.xmlDoc,this.mainObject]),document.createElement("DIV")},dtmlXMLLoaderObject.prototype.loadXMLString=function(xmlString,silent){if(_isIE)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(xmlString);else{var parser=new DOMParser;this.xmlDoc=parser.parseFromString(xmlString,"text/xml")}silent||(this.onloadAction&&this.onloadAction(this.mainObject,null,null,null,this),this.waitCall&&(this.waitCall(),this.waitCall=null))},dtmlXMLLoaderObject.prototype.loadXML=function(filePath,postMode,postVars,rpc){this.rSeed&&(filePath+=(-1!=filePath.indexOf("?")?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf()),this.filePath=filePath,!_isIE&&window.XMLHttpRequest?this.xmlDoc=new XMLHttpRequest:this.xmlDoc=new ActiveXObject("Microsoft.XMLHTTP"),this.async&&(this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this)),"string"==typeof postMode?this.xmlDoc.open(postMode,filePath,this.async):this.xmlDoc.open(postMode?"POST":"GET",filePath,this.async),rpc?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type","text/xml")):postMode&&this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.xmlDoc.send(null||postVars),this.async||new this.waitLoadFunction(this)()},dtmlXMLLoaderObject.prototype.destructor=function(){return this._filterXPath=null,this._getAllNamedChilds=null,this._retry=null,this.async=null,this.rSeed=null,this.filePath=null,this.onloadAction=null,this.mainObject=null,this.xmlDoc=null,this.doXPath=null,this.doXPathOpera=null,this.doXSLTransToObject=null,this.doXSLTransToString=null,
this.loadXML=null,this.loadXMLString=null,this.doSerialization=null,this.xmlNodeToJSON=null,this.getXMLTopNode=null,this.setXSLParamValue=null,null},dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(node){for(var t={},i=0;i<node.attributes.length;i++)t[node.attributes[i].name]=node.attributes[i].value;t._tagvalue=node.firstChild?node.firstChild.nodeValue:"";for(var i=0;i<node.childNodes.length;i++){var name=node.childNodes[i].tagName;name&&(t[name]||(t[name]=[]),t[name].push(this.xmlNodeToJSON(node.childNodes[i])))}return t},dhtmlDragAndDropObject.prototype.removeDraggableItem=function(htmlNode){htmlNode.onmousedown=null,htmlNode.dragStarter=null,htmlNode.dragLanding=null},dhtmlDragAndDropObject.prototype.addDraggableItem=function(htmlNode,dhtmlObject){htmlNode.onmousedown=this.preCreateDragCopy,htmlNode.dragStarter=dhtmlObject,this.addDragLanding(htmlNode,dhtmlObject)},dhtmlDragAndDropObject.prototype.addDragLanding=function(htmlNode,dhtmlObject){htmlNode.dragLanding=dhtmlObject},dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(e){return!e&&!window.event||2!=(e||event).button?window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(e),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),e&&e.preventDefault?(e.preventDefault(),!1):!1):void 0},dhtmlDragAndDropObject.prototype.callDrag=function(e){e||(e=window.event);var dragger=window.dhtmlDragAndDrop;if(!((new Date).valueOf()-dragger.downtime<100)){if(!dragger.dragNode){if(!dragger.waitDrag)return dragger.stopDrag(e,!0);if(dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,e),!dragger.dragNode)return dragger.stopDrag();dragger.dragNode.onselectstart=function(){return!1},dragger.gldragNode=dragger.dragNode,document.body.appendChild(dragger.dragNode),document.body.onmouseup=dragger.stopDrag,dragger.waitDrag=0,dragger.dragNode.pWindow=window,dragger.initFrameRoute()}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var grd=dragger.gldragNode;dragger.gldragNode.old&&(grd=dragger.gldragNode.old),grd.parentNode.removeChild(grd);var oldBody=dragger.dragNode.pWindow;if(grd.pWindow&&grd.pWindow.dhtmlDragAndDrop.lastLanding&&grd.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(grd.pWindow.dhtmlDragAndDrop.lastLanding),_isIE){var div=document.createElement("Div");div.innerHTML=dragger.dragNode.outerHTML,dragger.dragNode=div.childNodes[0]}else dragger.dragNode=dragger.dragNode.cloneNode(!0);dragger.dragNode.pWindow=window,dragger.gldragNode.old=dragger.dragNode,document.body.appendChild(dragger.dragNode),oldBody.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=e.clientX+15+(dragger.fx?-1*dragger.fx:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px",dragger.dragNode.style.top=e.clientY+3+(dragger.fy?-1*dragger.fy:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";var z;z=e.srcElement?e.srcElement:e.target,dragger.checkLanding(z,e)}},dhtmlDragAndDropObject.prototype.calculateFramePosition=function(n){if(window.name){for(var el=parent.frames[window.name].frameElement.offsetParent,fx=0,fy=0;el;)fx+=el.offsetLeft,fy+=el.offsetTop,el=el.offsetParent;if(parent.dhtmlDragAndDrop){var ls=parent.dhtmlDragAndDrop.calculateFramePosition(1);fx+=1*ls.split("_")[0],fy+=1*ls.split("_")[1]}if(n)return fx+"_"+fy;this.fx=fx,this.fy=fy}return"0_0"},dhtmlDragAndDropObject.prototype.checkLanding=function(htmlObject,e){htmlObject&&htmlObject.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=htmlObject,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,e.clientX,e.clientY,e),this.lastLanding_scr=_isIE?e.srcElement:e.target):htmlObject&&"BODY"!=htmlObject.tagName?this.checkLanding(htmlObject.parentNode,e):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,e.clientX,e.clientY,e),this.lastLanding=0,this._onNotFound&&this._onNotFound())},dhtmlDragAndDropObject.prototype.stopDrag=function(e,mode){var dragger=window.dhtmlDragAndDrop;if(!mode){dragger.stopFrameRoute();var temp=dragger.lastLanding;dragger.lastLanding=null,temp&&temp.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,temp,_isIE?event.srcElement:e.target)}dragger.lastLanding=null,dragger.dragNode&&dragger.dragNode.parentNode==document.body&&dragger.dragNode.parentNode.removeChild(dragger.dragNode),dragger.dragNode=0,dragger.gldragNode=0,dragger.fx=0,dragger.fy=0,dragger.dragStartNode=0,dragger.dragStartObject=0,document.body.onmouseup=dragger.tempDOMU,document.body.onmousemove=dragger.tempDOMM,dragger.tempDOMU=null,dragger.tempDOMM=null,dragger.waitDrag=0},dhtmlDragAndDropObject.prototype.stopFrameRoute=function(win){win&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=win&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.stopFrameRoute(window)}catch(e){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=win&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(e){}},dhtmlDragAndDropObject.prototype.initFrameRoute=function(win,mode){win&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=win.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=win.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=win.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=win.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&mode&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=win&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(e){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=win&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!win||mode?1:0)}catch(e){}},_isFF=!1,_isIE=!1,_isOpera=!1,_isKHTML=!1,_isMacOS=!1,_isChrome=!1,_FFrv=!1,_KHTMLrv=!1,_OperaRv=!1,-1!=navigator.userAgent.indexOf("Macintosh")&&(_isMacOS=!0),navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0),-1!=navigator.userAgent.indexOf("Safari")||-1!=navigator.userAgent.indexOf("Konqueror")?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):-1!=navigator.userAgent.indexOf("Opera")?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):-1!=navigator.appName.indexOf("Microsoft")?(_isIE=!0,-1==navigator.appVersion.indexOf("MSIE 8.0")&&-1==navigator.appVersion.indexOf("MSIE 9.0")&&-1==navigator.appVersion.indexOf("MSIE 10.0")||"BackCompat"==document.compatMode||(_isIE=8)):"Netscape"==navigator.appName&&-1!=navigator.userAgent.indexOf("Trident")?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])),dtmlXMLLoaderObject.prototype.doXPath=function(xpathExp,docObj,namespace,result_type){if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(xpathExp,docObj);if(_isIE)return docObj||(docObj=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),docObj||dhtmlxError.throwError("LoadXML","Incorrect XML",[docObj||this.xmlDoc,this.mainObject]),namespace&&docObj.setProperty("SelectionNamespaces","xmlns:xsl='"+namespace+"'"),"single"==result_type?docObj.selectSingleNode(xpathExp):docObj.selectNodes(xpathExp)||new Array(0);var nodeObj=docObj;docObj||(docObj=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),docObj||dhtmlxError.throwError("LoadXML","Incorrect XML",[docObj||this.xmlDoc,this.mainObject]),-1!=docObj.nodeName.indexOf("document")?nodeObj=docObj:(nodeObj=docObj,docObj=docObj.ownerDocument);var retType=XPathResult.ANY_TYPE;"single"==result_type&&(retType=XPathResult.FIRST_ORDERED_NODE_TYPE);var rowsCol=[],col=docObj.evaluate(xpathExp,nodeObj,function(pref){return namespace},retType,null);if(retType==XPathResult.FIRST_ORDERED_NODE_TYPE)return col.singleNodeValue;for(var thisColMemb=col.iterateNext();thisColMemb;)rowsCol[rowsCol.length]=thisColMemb,thisColMemb=col.iterateNext();return rowsCol},_dhtmlxError.prototype.catchError=function(type,func_name){this.catches[type]=func_name},_dhtmlxError.prototype.throwError=function(type,name,params){return this.catches[type]?this.catches[type](type,name,params):this.catches.ALL?this.catches.ALL(type,name,params):(window.alert("Error type: "+arguments[0]+"\nDescription: "+arguments[1]),null)},window.dhtmlxError=new _dhtmlxError,dtmlXMLLoaderObject.prototype.doXPathOpera=function(xpathExp,docObj){var z=xpathExp.replace(/[\/]+/gi,"/").split("/"),obj=null,i=1;if(!z.length)return[];if("."==z[0])obj=[docObj];else{if(""!==z[0])return[];obj=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(z[i].replace(/\[[^\]]*\]/g,"")),i++}for(i;i<z.length;i++)obj=this._getAllNamedChilds(obj,z[i]);return-1!=z[i-1].indexOf("[")&&(obj=this._filterXPath(obj,z[i-1])),obj},dtmlXMLLoaderObject.prototype._filterXPath=function(a,b){for(var c=[],b=b.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),i=0;i<a.length;i++)a[i].getAttribute(b)&&(c[c.length]=a[i]);return c},dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(a,b){var c=[];_isKHTML&&(b=b.toUpperCase());for(var i=0;i<a.length;i++)for(var j=0;j<a[i].childNodes.length;j++)_isKHTML?a[i].childNodes[j].tagName&&a[i].childNodes[j].tagName.toUpperCase()==b&&(c[c.length]=a[i].childNodes[j]):a[i].childNodes[j].tagName==b&&(c[c.length]=a[i].childNodes[j]);return c},"undefined"==typeof window.dhtmlxEvent&&(window.dhtmlxEvent=function(el,event,handler){el.addEventListener?el.addEventListener(event,handler,!1):el.attachEvent&&el.attachEvent("on"+event,handler)}),dtmlXMLLoaderObject.prototype.xslDoc=null,dtmlXMLLoaderObject.prototype.setXSLParamValue=function(paramName,paramValue,xslDoc){xslDoc||(xslDoc=this.xslDoc),xslDoc.responseXML&&(xslDoc=xslDoc.responseXML);var item=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+paramName+"']",xslDoc,"http://www.w3.org/1999/XSL/Transform","single");item&&(item.firstChild.nodeValue=paramValue)},dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(xslDoc,xmlDoc){xslDoc||(xslDoc=this.xslDoc),xslDoc.responseXML&&(xslDoc=xslDoc.responseXML),xmlDoc||(xmlDoc=this.xmlDoc),xmlDoc.responseXML&&(xmlDoc=xmlDoc.responseXML);var result;if(_isIE){result=new ActiveXObject("Msxml2.DOMDocument.3.0");try{xmlDoc.transformNodeToObject(xslDoc,result)}catch(e){result=xmlDoc.transformNode(xslDoc)}}else this.XSLProcessor||(this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(xslDoc)),result=this.XSLProcessor.transformToDocument(xmlDoc);return result},dtmlXMLLoaderObject.prototype.doXSLTransToString=function(xslDoc,xmlDoc){var res=this.doXSLTransToObject(xslDoc,xmlDoc);return"string"==typeof res?res:this.doSerialization(res)},dtmlXMLLoaderObject.prototype.doSerialization=function(xmlDoc){if(xmlDoc||(xmlDoc=this.xmlDoc),xmlDoc.responseXML&&(xmlDoc=xmlDoc.responseXML),_isIE)return xmlDoc.xml;var xmlSerializer=new XMLSerializer;return xmlSerializer.serializeToString(xmlDoc)},dhtmlxEventable=function(obj){obj.attachEvent=function(name,catcher,callObj){return name="ev_"+name.toLowerCase(),this[name]||(this[name]=new this.eventCatcher(callObj||this)),name+":"+this[name].addEvent(catcher)},obj.callEvent=function(name,arg0){return name="ev_"+name.toLowerCase(),this[name]?this[name].apply(this,arg0):!0},obj.checkEvent=function(name){return!!this["ev_"+name.toLowerCase()]},obj.eventCatcher=function(obj){var dhx_catch=[],z=function(){for(var res=!0,i=0;i<dhx_catch.length;i++)if(dhx_catch[i]){var zr=dhx_catch[i].apply(obj,arguments);res=res&&zr}return res};return z.addEvent=function(ev){return"function"!=typeof ev&&(ev=eval(ev)),ev?dhx_catch.push(ev)-1:!1},z.removeEvent=function(id){dhx_catch[id]=null},z},obj.detachEvent=function(id){if(id){var list=id.split(":");this[list[0]].removeEvent(list[1])}},obj.detachAllEvents=function(){for(var name in this)0===name.indexOf("ev_")&&(this.detachEvent(name),this[name]=null)},obj=null},window.dhtmlx||(window.dhtmlx={}),function(){function callback(config,result){var usercall=config.callback;modality(!1),config.box.parentNode.removeChild(config.box),_dhx_msg_cfg=config.box=null,usercall&&usercall(result)}function modal_key(e){if(_dhx_msg_cfg){e=e||event;var code=e.which||event.keyCode;return dhtmlx.message.keyboard&&((13==code||32==code)&&callback(_dhx_msg_cfg,!0),27==code&&callback(_dhx_msg_cfg,!1)),e.preventDefault&&e.preventDefault(),!(e.cancelBubble=!0)}}function modality(mode){modality.cover||(modality.cover=document.createElement("DIV"),modality.cover.onkeydown=modal_key,modality.cover.className="dhx_modal_cover",document.body.appendChild(modality.cover));document.body.scrollHeight;modality.cover.style.display=mode?"inline-block":"none"}function button(text,result,css){var className=css?css:text||"",button_css="dhtmlx_"+className.toLowerCase().replace(/ /g,"_")+"_button";return"<div class='dhtmlx_popup_button "+button_css+"' result='"+result+"' ><div>"+text+"</div></div>"}function info(text){t.area||(t.area=document.createElement("DIV"),t.area.className="dhtmlx_message_area",t.area.style[t.position]="5px",document.body.appendChild(t.area)),t.hide(text.id);var message=document.createElement("DIV");return message.innerHTML="<div>"+text.text+"</div>",message.className="dhtmlx-info dhtmlx-"+text.type,message.onclick=function(){t.hide(text.id),text=null},"bottom"==t.position&&t.area.firstChild?t.area.insertBefore(message,t.area.firstChild):t.area.appendChild(message),text.expire>0&&(t.timers[text.id]=window.setTimeout(function(){t.hide(text.id)},text.expire)),t.pull[text.id]=message,message=null,text.id}function _boxStructure(config,ok,cancel){var box=document.createElement("DIV");box.className=" dhtmlx_modal_box dhtmlx-"+config.type,box.setAttribute("dhxbox",1);var inner="";if(config.width&&(box.style.width=config.width),config.height&&(box.style.height=config.height),config.title&&(inner+='<div class="dhtmlx_popup_title">'+config.title+"</div>"),inner+='<div class="dhtmlx_popup_text"><span>'+(config.content?"":config.text)+'</span></div><div  class="dhtmlx_popup_controls">',ok){var ok_text=config.ok||scheduler.locale.labels.message_ok;void 0===ok_text&&(ok_text="OK"),inner+=button(ok_text,!0,"ok")}if(cancel){var cancel_text=config.cancel||scheduler.locale.labels.message_cancel;void 0===cancel_text&&(cancel_text="Cancel"),inner+=button(cancel_text,!1,"cancel")}if(config.buttons)for(var i=0;i<config.buttons.length;i++)inner+=button(config.buttons[i],i);if(inner+="</div>",box.innerHTML=inner,config.content){var node=config.content;"string"==typeof node&&(node=document.getElementById(node)),"none"==node.style.display&&(node.style.display=""),box.childNodes[config.title?1:0].appendChild(node)}return box.onclick=function(e){e=e||event;var source=e.target||e.srcElement;if(source.className||(source=source.parentNode),"dhtmlx_popup_button"==source.className.split(" ")[0]){var result=source.getAttribute("result");result="true"==result||("false"==result?!1:result),callback(config,result)}},config.box=box,(ok||cancel)&&(_dhx_msg_cfg=config),box}function _createBox(config,ok,cancel){var box=config.tagName?config:_boxStructure(config,ok,cancel);config.hidden||modality(!0),document.body.appendChild(box);var x=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-box.offsetWidth)/2)),y=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-box.offsetHeight)/2));return"top"==config.position?box.style.top="-3px":box.style.top=y+"px",box.style.left=x+"px",box.onkeydown=modal_key,box.focus(),config.hidden&&dhtmlx.modalbox.hide(box),box}function alertPopup(config){return _createBox(config,!0,!1)}function confirmPopup(config){return _createBox(config,!0,!0)}function boxPopup(config){return _createBox(config)}function box_params(text,type,callback){return"object"!=typeof text&&("function"==typeof type&&(callback=type,type=""),text={text:text,type:type,callback:callback}),text}function params(text,type,expire,id){return"object"!=typeof text&&(text={text:text,type:type,expire:expire,id:id}),text.id=text.id||t.uid(),text.expire=text.expire||t.expire,text}var _dhx_msg_cfg=null;document.attachEvent?document.attachEvent("onkeydown",modal_key):document.addEventListener("keydown",modal_key,!0),dhtmlx.alert=function(){var text=box_params.apply(this,arguments);return text.type=text.type||"confirm",alertPopup(text)},dhtmlx.confirm=function(){var text=box_params.apply(this,arguments);return text.type=text.type||"alert",confirmPopup(text)},dhtmlx.modalbox=function(){var text=box_params.apply(this,arguments);return text.type=text.type||"alert",boxPopup(text)},dhtmlx.modalbox.hide=function(node){for(;node&&node.getAttribute&&!node.getAttribute("dhxbox");)node=node.parentNode;node&&(node.parentNode.removeChild(node),modality(!1))};var t=dhtmlx.message=function(text,type,expire,id){text=params.apply(this,arguments),text.type=text.type||"info";var subtype=text.type.split("-")[0];switch(subtype){case"alert":return alertPopup(text);case"confirm":return confirmPopup(text);case"modalbox":return boxPopup(text);default:return info(text)}};t.seed=(new Date).valueOf(),t.uid=function(){return t.seed++},t.expire=4e3,t.keyboard=!0,t.position="top",t.pull={},t.timers={},t.hideAll=function(){for(var key in t.pull)t.hide(key)},t.hide=function(id){var obj=t.pull[id];obj&&obj.parentNode&&(window.setTimeout(function(){obj.parentNode.removeChild(obj),obj=null},2e3),obj.className+=" hidden",t.timers[id]&&window.clearTimeout(t.timers[id]),delete t.pull[id])}}(),dataProcessor.prototype={setTransactionMode:function(mode,total){this._tMode=mode,this._tSend=total,"REST"==mode&&(this._tSend=!1,this._endnm=!0)},escape:function(data){return this._utf?encodeURIComponent(data):escape(data)},enableUTFencoding:function(mode){this._utf=convertStringToBoolean(mode)},setDataColumns:function(val){this._columns="string"==typeof val?val.split(","):val},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(mode){this._endnm=convertStringToBoolean(mode)},enablePartialDataSend:function(mode){this._changed=convertStringToBoolean(mode)},setUpdateMode:function(mode,dnd){this.autoUpdate="cell"==mode,this.updateMode=mode,this.dnd=dnd},ignore:function(code,master){this._silent_mode=!0,code.call(master||window),this._silent_mode=!1},setUpdated:function(rowId,state,mode){if(!this._silent_mode){var ind=this.findRow(rowId);mode=mode||"updated";var existing=this.obj.getUserData(rowId,this.action_param);existing&&"updated"==mode&&(mode=existing),state?(this.set_invalid(rowId,!1),this.updatedRows[ind]=rowId,this.obj.setUserData(rowId,this.action_param,mode),this._in_progress[rowId]&&(this._in_progress[rowId]="wait")):this.is_invalid(rowId)||(this.updatedRows.splice(ind,1),this.obj.setUserData(rowId,this.action_param,"")),state||this._clearUpdateFlag(rowId),this.markRow(rowId,state,mode),state&&this.autoUpdate&&this.sendData(rowId)}},_clearUpdateFlag:function(id){},markRow:function(id,state,mode){var str="",invalid=this.is_invalid(id);if(invalid&&(str=this.styles[invalid],state=!0),this.callEvent("onRowMark",[id,state,mode,invalid])&&(str=this.styles[state?mode:"clear"]+str,this.obj[this._methods[0]](id,str),invalid&&invalid.details)){str+=this.styles[invalid+"_cell"];for(var i=0;i<invalid.details.length;i++)invalid.details[i]&&this.obj[this._methods[1]](id,i,str)}},getState:function(id){return this.obj.getUserData(id,this.action_param)},is_invalid:function(id){return this._invalid[id]},set_invalid:function(id,mode,details){details&&(mode={value:mode,details:details,toString:function(){return this.value.toString()}}),this._invalid[id]=mode},checkBeforeUpdate:function(rowId){return!0},sendData:function(rowId){return!this._waitMode||"tree"!=this.obj.mytype&&!this.obj._h2?(this.obj.editStop&&this.obj.editStop(),"undefined"==typeof rowId||this._tSend?this.sendAllData():this._in_progress[rowId]?!1:(this.messages=[],!this.checkBeforeUpdate(rowId)&&this.callEvent("onValidationError",[rowId,this.messages])?!1:void this._beforeSendData(this._getRowData(rowId),rowId))):void 0},_beforeSendData:function(data,rowId){return this.callEvent("onBeforeUpdate",[rowId,this.getState(rowId),data])?void this._sendData(data,rowId):!1},serialize:function(data,id){if("string"==typeof data)return data;if("undefined"!=typeof id)return this.serialize_one(data,"");var stack=[],keys=[];for(var key in data)data.hasOwnProperty(key)&&(stack.push(this.serialize_one(data[key],key+this.post_delim)),keys.push(key));return stack.push("ids="+this.escape(keys.join(","))),dhtmlx.security_key&&stack.push("dhx_security="+dhtmlx.security_key),stack.join("&")},serialize_one:function(data,pref){if("string"==typeof data)return data;var stack=[];for(var key in data)if(data.hasOwnProperty(key)){if(("id"==key||key==this.action_param)&&"REST"==this._tMode)continue;stack.push(this.escape((pref||"")+key)+"="+this.escape(data[key]))}return stack.join("&")},_sendData:function(a1,rowId){if(a1){if(!this.callEvent("onBeforeDataSending",rowId?[rowId,this.getState(rowId),a1]:[null,null,a1]))return!1;rowId&&(this._in_progress[rowId]=(new Date).valueOf());var a2=new dtmlXMLLoaderObject(function(that,b,c,d,xml){var ids=[];if(rowId)ids.push(rowId);else if(a1)for(var key in a1)ids.push(key);return that.afterUpdate(that,xml,ids)},this,!0),a3=this.serverProcessor+(this._user?getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&"):"");if("GET"==this._tMode)a2.loadXML(a3+(-1!=a3.indexOf("?")?"&":"?")+this.serialize(a1,rowId));else if("POST"==this._tMode)a2.loadXML(a3,!0,this.serialize(a1,rowId));else if("REST"==this._tMode){var state=this.getState(rowId),url=a3.replace(/(\&|\?)editing\=true/,"");"inserted"==state?a2.loadXML(url+rowId,"POST",this.serialize(a1,rowId)):"deleted"==state?a2.loadXML(url+rowId,"DELETE",""):a2.loadXML(url+rowId,"PUT",this.serialize(a1,rowId))}this._waitMode++}},sendAllData:function(){if(this.updatedRows.length){this.messages=[];for(var valid=!0,i=0;i<this.updatedRows.length;i++)valid&=this.checkBeforeUpdate(this.updatedRows[i]);if(!valid&&!this.callEvent("onValidationError",["",this.messages]))return!1;if(this._tSend)this._sendData(this._getAllData());else for(var i=0;i<this.updatedRows.length;i++)if(!this._in_progress[this.updatedRows[i]]){if(this.is_invalid(this.updatedRows[i]))continue;if(this._beforeSendData(this._getRowData(this.updatedRows[i]),this.updatedRows[i]),this._waitMode&&("tree"==this.obj.mytype||this.obj._h2))return}}},_getAllData:function(rowId){for(var out={},has_one=!1,i=0;i<this.updatedRows.length;i++){var id=this.updatedRows[i];this._in_progress[id]||this.is_invalid(id)||this.callEvent("onBeforeUpdate",[id,this.getState(id),this._getRowData(id)])&&(out[id]=this._getRowData(id,id+this.post_delim),has_one=!0,this._in_progress[id]=(new Date).valueOf())}return has_one?out:null},setVerificator:function(ind,verifFunction){this.mandatoryFields[ind]=verifFunction||function(value){return""!==value}},clearVerificator:function(ind){this.mandatoryFields[ind]=!1},findRow:function(pattern){var i=0;for(i=0;i<this.updatedRows.length&&pattern!=this.updatedRows[i];i++);return i},defineAction:function(name,handler){this._uActions||(this._uActions=[]),this._uActions[name]=handler},afterUpdateCallback:function(sid,tid,action,btag){var marker=sid,correct="error"!=action&&"invalid"!=action;if(correct||this.set_invalid(sid,action),this._uActions&&this._uActions[action]&&!this._uActions[action](btag))return delete this._in_progress[marker];"wait"!=this._in_progress[marker]&&this.setUpdated(sid,!1);var soid=sid;switch(action){case"inserted":case"insert":tid!=sid&&(this.obj[this._methods[2]](sid,tid),sid=tid);break;case"delete":case"deleted":return this.obj.setUserData(sid,this.action_param,"true_deleted"),this.obj[this._methods[3]](sid),delete this._in_progress[marker],this.callEvent("onAfterUpdate",[sid,action,tid,btag])}"wait"!=this._in_progress[marker]?(correct&&this.obj.setUserData(sid,this.action_param,""),delete this._in_progress[marker]):(delete this._in_progress[marker],this.setUpdated(tid,!0,this.obj.getUserData(sid,this.action_param))),this.callEvent("onAfterUpdate",[soid,action,tid,btag])},afterUpdate:function(that,xml,id){if(window.JSON)try{var tag=JSON.parse(xml.xmlDoc.responseText),action=tag.action||this.getState(id)||"updated",sid=tag.sid||id[0],tid=tag.tid||id[0];return that.afterUpdateCallback(sid,tid,action,tag),void that.finalizeUpdate()}catch(e){}if(xml.getXMLTopNode("data"),!xml.xmlDoc.responseXML)return this.obj&&this.obj.callEvent&&this.obj.callEvent("onSaveError",[id,xml.xmlDoc]),this.cleanUpdate(id);var atag=xml.doXPath("//data/action");if(!atag.length)return this.cleanUpdate(id);for(var i=0;i<atag.length;i++){var btag=atag[i],action=btag.getAttribute("type"),sid=btag.getAttribute("sid"),tid=btag.getAttribute("tid");that.afterUpdateCallback(sid,tid,action,btag)}that.finalizeUpdate()},cleanUpdate:function(id){if(id)for(var i=0;i<id.length;i++)delete this._in_progress[id[i]]},finalizeUpdate:function(){this._waitMode&&this._waitMode--,("tree"==this.obj.mytype||this.obj._h2)&&this.updatedRows.length&&this.sendData(),this.callEvent("onAfterUpdateFinish",[]),this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(anObj){this.obj=anObj,this.obj._dp_init&&this.obj._dp_init(this)},setOnAfterUpdate:function(ev){this.attachEvent("onAfterUpdate",ev)},enableDebug:function(mode){},setOnBeforeUpdateHandler:function(func){this.attachEvent("onBeforeDataSending",func)},setAutoUpdate:function(interval,user){interval=interval||2e3,this._user=user||(new Date).valueOf(),this._need_update=!1,this._loader=null,this._update_busy=!1,this.attachEvent("onAfterUpdate",function(sid,action,tid,xml_node){this.afterAutoUpdate(sid,action,tid,xml_node)}),this.attachEvent("onFullSync",function(){this.fullSync()});var self=this;window.setInterval(function(){self.loadUpdate()},interval)},afterAutoUpdate:function(sid,action,tid,xml_node){return"collision"==action?(this._need_update=!0,!1):!0},fullSync:function(){return this._need_update&&(this._need_update=!1,this.loadUpdate()),!0},getUpdates:function(url,callback){return this._update_busy?!1:(this._update_busy=!0,this._loader=this._loader||new dtmlXMLLoaderObject(!0),this._loader.async=!0,this._loader.waitCall=callback,void this._loader.loadXML(url))},_v:function(node){return node.firstChild?node.firstChild.nodeValue:""},_a:function(arr){for(var res=[],i=0;i<arr.length;i++)res[i]=this._v(arr[i]);return res},loadUpdate:function(){var self=this,version=this.obj.getUserData(0,"version"),url=this.serverProcessor+getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+version].join("&");url=url.replace("editing=true&",""),this.getUpdates(url,function(){var vers=self._loader.doXPath("//userdata");self.obj.setUserData(0,"version",self._v(vers[0]));var upds=self._loader.doXPath("//update");if(upds.length){self._silent_mode=!0;for(var i=0;i<upds.length;i++){var status=upds[i].getAttribute("status"),id=upds[i].getAttribute("id"),parent=upds[i].getAttribute("parent");switch(status){case"inserted":self.callEvent("insertCallback",[upds[i],id,parent]);break;case"updated":self.callEvent("updateCallback",[upds[i],id,parent]);break;case"deleted":self.callEvent("deleteCallback",[upds[i],id,parent])}}self._silent_mode=!1}self._update_busy=!1,self=null})}},window.dataProcessor&&!dataProcessor.prototype.init_original&&(dataProcessor.prototype.init_original=dataProcessor.prototype.init,dataProcessor.prototype.init=function(obj){this.init_original(obj),obj._dataprocessor=this,this.setTransactionMode("POST",!0),this.serverProcessor+=(-1!=this.serverProcessor.indexOf("?")?"&":"?")+"editing=true"}),dhtmlxError.catchError("LoadXML",function(a,b,c){var message=c[0].responseText;switch(scheduler.config.ajax_error){case"alert":window.alert(message);break;case"console":window.console.log(message)}}),dhtmlxEventable(scheduler),scheduler._detachDomEvent=function(el,event,handler){el.removeEventListener?el.removeEventListener(event,handler,!1):el.detachEvent&&el.detachEvent("on"+event,handler)},scheduler._init_once=function(){function getWindowSize(){return{w:window.innerWidth||document.documentElement.clientWidth,h:window.innerHeight||document.documentElement.clientHeight}}function equals(a,b){return a.w==b.w&&a.h==b.h}var oldSize=getWindowSize();dhtmlxEvent(window,"resize",function(){var newSize=getWindowSize();equals(oldSize,newSize)||(window.clearTimeout(scheduler._resize_timer),scheduler._resize_timer=window.setTimeout(function(){scheduler.callEvent("onSchedulerResize",[])&&(scheduler.update_view(),scheduler.callEvent("onAfterSchedulerResize",[]))},100)),oldSize=newSize}),scheduler._init_once=function(){}},scheduler.init=function(id,date,mode){date=date||scheduler._currentDate(),mode=mode||"week",this._obj&&this.unset_actions(),this._obj="string"==typeof id?document.getElementById(id):id,this._skin_init&&scheduler._skin_init(),scheduler.date.init(),this._els=[],this._scroll=!0,this._quirks=_isIE&&"BackCompat"==document.compatMode,this._quirks7=_isIE&&-1==navigator.appVersion.indexOf("MSIE 8"),this.get_elements(),this.init_templates(),this.set_actions(),this._init_once(),this._init_touch_events(),this.set_sizes(),scheduler.callEvent("onSchedulerReady",[]),this.setCurrentView(date,mode)},scheduler.xy={min_event_height:40,scale_width:50,scroll_width:18,scale_height:20,month_scale_height:20,menu_width:25,margin_top:0,margin_left:0,editor_width:140,month_head_height:22},scheduler.keys={edit_save:13,edit_cancel:27},scheduler.set_sizes=function(){var w=this._x=this._obj.clientWidth-this.xy.margin_left,h=this._y=this._obj.clientHeight-this.xy.margin_top,scale_x=this._table_view?0:this.xy.scale_width+this.xy.scroll_width,scale_s=this._table_view?-1:this.xy.scale_width;this.set_xy(this._els.dhx_cal_navline[0],w,this.xy.nav_height,0,0),this.set_xy(this._els.dhx_cal_header[0],w-scale_x,this.xy.scale_height,scale_s,this.xy.nav_height+(this._quirks?-1:1));var actual_height=this._els.dhx_cal_navline[0].offsetHeight;actual_height>0&&(this.xy.nav_height=actual_height);var data_y=this.xy.scale_height+this.xy.nav_height+(this._quirks?-2:0);this.set_xy(this._els.dhx_cal_data[0],w,h-(data_y+2),0,data_y+2)},scheduler.set_xy=function(node,w,h,x,y){node.style.width=Math.max(0,w)+"px",node.style.height=Math.max(0,h)+"px",arguments.length>3&&(node.style.left=x+"px",node.style.top=y+"px")},scheduler.get_elements=function(){for(var els=this._obj.getElementsByTagName("DIV"),i=0;i<els.length;i++){var class_name=els[i].className||"",attr_value=els[i].getAttribute("name")||"";class_name&&(class_name=class_name.split(" ")[0]),this._els[class_name]||(this._els[class_name]=[]),this._els[class_name].push(els[i]);var label=scheduler.locale.labels[attr_value||class_name];"string"!=typeof label&&attr_value&&!els[i].innerHTML&&(label=attr_value.split("_")[0]),label&&(els[i].innerHTML=label)}},scheduler.unset_actions=function(){for(var a in this._els)if(this._click[a])for(var i=0;i<this._els[a].length;i++)this._els[a][i].onclick=null;this._obj.onselectstart=null,this._obj.onmousemove=null,this._obj.onmousedown=null,this._obj.onmouseup=null,this._obj.ondblclick=null,this._obj.oncontextmenu=null},scheduler.set_actions=function(){for(var a in this._els)if(this._click[a])for(var i=0;i<this._els[a].length;i++)this._els[a][i].onclick=scheduler._click[a];
this._obj.onselectstart=function(e){return!1},this._obj.onmousemove=function(e){scheduler._temp_touch_block||scheduler._on_mouse_move(e||event)},this._obj.onmousedown=function(e){scheduler._ignore_next_click||scheduler._on_mouse_down(e||event)},this._obj.onmouseup=function(e){scheduler._ignore_next_click||scheduler._on_mouse_up(e||event)},this._obj.ondblclick=function(e){scheduler._on_dbl_click(e||event)},this._obj.oncontextmenu=function(e){var ev=e||event,src=ev.target||ev.srcElement,returnValue=scheduler.callEvent("onContextMenu",[scheduler._locate_event(src),ev]);return returnValue}},scheduler.select=function(id){this._select_id!=id&&(scheduler._close_not_saved(),this.editStop(!1),this.unselect(),this._select_id=id,this.updateEvent(id))},scheduler.unselect=function(id){if(!id||id==this._select_id){var t=this._select_id;this._select_id=null,t&&this.getEvent(t)&&this.updateEvent(t)}},scheduler.getState=function(){return{mode:this._mode,date:new Date(this._date),min_date:new Date(this._min_date),max_date:new Date(this._max_date),editor_id:this._edit_id,lightbox_id:this._lightbox_id,new_event:this._new_event,select_id:this._select_id,expanded:this.expanded,drag_id:this._drag_id,drag_mode:this._drag_mode}},scheduler._click={dhx_cal_data:function(e){if(scheduler._ignore_next_click)return e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,scheduler._ignore_next_click=!1,!1;var trg=e?e.target:event.srcElement,id=scheduler._locate_event(trg);if(e=e||event,id){if(!scheduler.callEvent("onClick",[id,e])||scheduler.config.readonly)return}else scheduler.callEvent("onEmptyClick",[scheduler.getActionData(e).date,e]);if(id&&scheduler.config.select){scheduler.select(id);var mask=trg.className;-1!=mask.indexOf("_icon")&&scheduler._click.buttons[mask.split(" ")[1].replace("icon_","")](id)}else scheduler._close_not_saved(),(new Date).valueOf()-(scheduler._new_event||0)>500&&scheduler.unselect()},dhx_cal_prev_button:function(){scheduler._click.dhx_cal_next_button(0,-1)},dhx_cal_next_button:function(dummy,step){scheduler.setCurrentView(scheduler.date.add(scheduler.date[scheduler._mode+"_start"](scheduler._date),step||1,scheduler._mode))},dhx_cal_today_button:function(){scheduler.callEvent("onBeforeTodayDisplayed",[])&&scheduler.setCurrentView(scheduler._currentDate())},dhx_cal_tab:function(){var name=this.getAttribute("name"),mode=name.substring(0,name.search("_tab"));scheduler.setCurrentView(scheduler._date,mode)},buttons:{"delete":function(id){var c=scheduler.locale.labels.confirm_deleting;scheduler._dhtmlx_confirm(c,scheduler.locale.labels.title_confirm_deleting,function(){scheduler.deleteEvent(id)})},edit:function(id){scheduler.edit(id)},save:function(id){scheduler.editStop(!0)},details:function(id){scheduler.showLightbox(id)},cancel:function(id){scheduler.editStop(!1)}}},scheduler._dhtmlx_confirm=function(message,title,callback){if(!message)return callback();var opts={text:message};title&&(opts.title=title),callback&&(opts.callback=function(result){result&&callback()}),dhtmlx.confirm(opts)},scheduler.addEventNow=function(start,end,e){var base={};start&&null!==start.constructor.toString().match(/object/i)&&(base=start,start=null);var d=6e4*(this.config.event_duration||this.config.time_step);start||(start=base.start_date||Math.round(scheduler._currentDate().valueOf()/d)*d);var start_date=new Date(start);if(!end){var start_hour=this.config.first_hour;start_hour>start_date.getHours()&&(start_date.setHours(start_hour),start=start_date.valueOf()),end=start.valueOf()+d}var end_date=new Date(end);start_date.valueOf()==end_date.valueOf()&&end_date.setTime(end_date.valueOf()+d),base.start_date=base.start_date||start_date,base.end_date=base.end_date||end_date,base.text=base.text||this.locale.labels.new_event,base.id=this._drag_id=this.uid(),this._drag_mode="new-size",this._loading=!0,this.addEvent(base),this.callEvent("onEventCreated",[this._drag_id,e]),this._loading=!1,this._drag_event={},this._on_mouse_up(e)},scheduler._on_dbl_click=function(e,src){if(src=src||e.target||e.srcElement,!this.config.readonly){var name=(src.className||"").split(" ")[0];switch(name){case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_wa_day_data":if(!scheduler.config.dblclick_create)break;this.addEventNow(this.getActionData(e).date,null,e);break;case"dhx_cal_event":case"dhx_wa_ev_body":case"dhx_agenda_line":case"dhx_grid_event":case"dhx_cal_event_line":case"dhx_cal_event_clear":var id=this._locate_event(src);if(!this.callEvent("onDblClick",[id,e]))return;this.config.details_on_dblclick||this._table_view||!this.getEvent(id)._timed||!this.config.select?this.showLightbox(id):this.edit(id);break;case"dhx_time_block":case"dhx_cal_container":return;default:var t=this["dblclick_"+name];if(t)t.call(this,e);else if(src.parentNode&&src!=this)return scheduler._on_dbl_click(e,src.parentNode)}}},scheduler._get_column_index=function(x_pos){var column=0;if(this._cols){for(var width=0,i=0;i<this._cols.length&&!width;i++)width=this._cols[i];if(column=width?x_pos/width:0,this._ignores)for(var i=0;column>=i;i++)this._ignores[i]&&column++}return column},scheduler._week_indexes_from_pos=function(pos){if(this._cols){var column=this._get_column_index(pos.x);return pos.x=Math.min(this._cols.length-1,Math.max(0,Math.ceil(column)-1)),pos.y=Math.max(0,Math.ceil(60*pos.y/(this.config.time_step*this.config.hour_size_px))-1)+this.config.first_hour*(60/this.config.time_step),pos}return pos},scheduler._mouse_coords=function(ev){var pos,b=document.body,d=document.documentElement;pos=_isIE||!ev.pageX&&!ev.pageY?{x:ev.clientX+(b.scrollLeft||d.scrollLeft||0)-b.clientLeft,y:ev.clientY+(b.scrollTop||d.scrollTop||0)-b.clientTop}:{x:ev.pageX,y:ev.pageY},pos.x-=getAbsoluteLeft(this._obj)+(this._table_view?0:this.xy.scale_width),pos.y-=getAbsoluteTop(this._obj)+this.xy.nav_height+(this._dy_shift||0)+this.xy.scale_height-this._els.dhx_cal_data[0].scrollTop,pos.ev=ev;var handler=this["mouse_"+this._mode];if(handler)return handler.call(this,pos);if(this._table_view){var column=this._get_column_index(pos.x);if(!this._cols||!this._colsS)return pos;var dy=0;for(dy=1;dy<this._colsS.heights.length&&!(this._colsS.heights[dy]>pos.y);dy++);pos.y=Math.ceil(24*(Math.max(0,column)+7*Math.max(0,dy-1))*60/this.config.time_step),(scheduler._drag_mode||"month"==this._mode)&&(pos.y=24*(Math.max(0,Math.ceil(column)-1)+7*Math.max(0,dy-1))*60/this.config.time_step),"move"==this._drag_mode&&scheduler._ignores_detected&&scheduler.config.preserve_length&&(pos._ignores=!0,this._drag_event._event_length||(this._drag_event._event_length=this._get_real_event_length(this._drag_event.start_date,this._drag_event.end_date,{x_step:1,x_unit:"day"}))),pos.x=0}else pos=this._week_indexes_from_pos(pos);return pos},scheduler._close_not_saved=function(){if((new Date).valueOf()-(scheduler._new_event||0)>500&&scheduler._edit_id){var c=scheduler.locale.labels.confirm_closing;scheduler._dhtmlx_confirm(c,scheduler.locale.labels.title_confirm_closing,function(){scheduler.editStop(scheduler.config.positive_closing)})}},scheduler._correct_shift=function(start,back){return start-=6e4*(new Date(scheduler._min_date).getTimezoneOffset()-new Date(start).getTimezoneOffset())*(back?-1:1)},scheduler._is_pos_changed=function(old_pos,new_pos){function diff(old_val,new_val,acc){return!!(Math.abs(old_val-new_val)>acc)}var delay=100,d_pos=5;return!!(!this._drag_pos.start||+new Date-this._drag_pos.start>delay||diff(old_pos.x,new_pos.x,d_pos)||diff(old_pos.y,new_pos.y,d_pos))},scheduler._on_mouse_move=function(e){if(this._drag_mode){var pos=this._mouse_coords(e);if(pos.force_redraw||this._is_pos_changed(this._drag_pos,pos)){var start,end;if(this._edit_id!=this._drag_id&&this._close_not_saved(),this._drag_pos=pos,this._drag_pos.has_moved=!0,"create"==this._drag_mode){if(this._close_not_saved(),this.unselect(this._select_id),this._loading=!0,start=this._get_date_from_pos(pos).valueOf(),!this._drag_start){var res=this.callEvent("onBeforeEventCreated",[e,this._drag_id]);if(!res)return;return void(this._drag_start=start)}end=start,end==this._drag_start;var start_date=new Date(this._drag_start),end_date=new Date(end);"day"!=this._mode&&"week"!=this._mode||start_date.getHours()!=end_date.getHours()||start_date.getMinutes()!=end_date.getMinutes()||(end_date=new Date(this._drag_start+1e3)),this._drag_id=this.uid(),this.addEvent(start_date,end_date,this.locale.labels.new_event,this._drag_id,pos.fields),this.callEvent("onEventCreated",[this._drag_id,e]),this._loading=!1,this._drag_mode="new-size"}var obj,ev=this.getEvent(this._drag_id);if("move"==this._drag_mode)start=this._min_date.valueOf()+6e4*(pos.y*this.config.time_step+24*pos.x*60-(scheduler._move_pos_shift||0)),!pos.custom&&this._table_view&&(start+=1e3*this.date.time_part(ev.start_date)),start=this._correct_shift(start),pos._ignores&&this.config.preserve_length&&this._table_view?(this.matrix&&(obj=this.matrix[this._mode]),obj=obj||{x_step:1,x_unit:"day"},end=1*start+this._get_fictional_event_length(start,this._drag_event._event_length,obj)):end=ev.end_date.valueOf()-(ev.start_date.valueOf()-start);else{if(start=ev.start_date.valueOf(),end=ev.end_date.valueOf(),this._table_view){var resize_date=this._min_date.valueOf()+pos.y*this.config.time_step*6e4+(pos.custom?0:864e5);if("month"==this._mode)if(resize_date=this._correct_shift(resize_date,!1),this._drag_from_start){var day=864e5;resize_date<=scheduler.date.date_part(new Date(end+day-1)).valueOf()&&(start=resize_date-day)}else end=resize_date;else pos.resize_from_start?start=resize_date:end=resize_date}else end=this.date.date_part(new Date(ev.end_date.valueOf()-1)).valueOf()+pos.y*this.config.time_step*6e4,this._els.dhx_cal_data[0].style.cursor="s-resize",("week"==this._mode||"day"==this._mode)&&(end=this._correct_shift(end));if("new-size"==this._drag_mode)if(end<=this._drag_start){var shift=pos.shift||(this._table_view&&!pos.custom?864e5:0);start=end-(pos.shift?0:shift),end=this._drag_start+(shift||6e4*this.config.time_step)}else start=this._drag_start;else start>=end&&(end=start+6e4*this.config.time_step)}var new_end=new Date(end-1),new_start=new Date(start);if(scheduler.config.limit_drag_out&&(+new_start<+scheduler._min_date||+end>+scheduler._max_date)){var duration=end-new_start;+new_start<+scheduler._min_date?(new_start=new Date(scheduler._min_date),end=new Date(+new_start+duration)):(end=new Date(scheduler._max_date),new_start=new Date(+end-duration));var new_end=new Date(end-1)}if(!this._table_view&&!scheduler.config.all_timed&&(!scheduler._get_section_view()&&pos.x!=this._get_event_sday({start_date:new Date(end),end_date:new Date(end)})||new Date(end).getHours()>=this.config.last_hour)){var duration=end-new_start,day=this._min_date.valueOf()+24*pos.x*60*6e4;end=scheduler.date.date_part(new Date(day)),end.setHours(this.config.last_hour),new_end=new Date(end-1),"move"==this._drag_mode&&(new_start=new Date(+end-duration))}if(this._table_view||new_end.getDate()==new_start.getDate()&&new_end.getHours()<this.config.last_hour||scheduler._allow_dnd)if(ev.start_date=new_start,ev.end_date=new Date(end),this.config.update_render){var sx=scheduler._els.dhx_cal_data[0].scrollTop;this.update_view(),scheduler._els.dhx_cal_data[0].scrollTop=sx}else this.updateEvent(this._drag_id);this._table_view&&this.for_rendered(this._drag_id,function(r){r.className+=" dhx_in_move"}),this.callEvent("onEventDrag",[this._drag_id,this._drag_mode,e])}}else if(scheduler.checkEvent("onMouseMove")){var id=this._locate_event(e.target||e.srcElement);this.callEvent("onMouseMove",[id,e])}},scheduler._on_mouse_down=function(e,src){if(2!=e.button&&!this.config.readonly&&!this._drag_mode){src=src||e.target||e.srcElement;var classname=src.className&&src.className.split(" ")[0];switch(classname){case"dhx_cal_event_line":case"dhx_cal_event_clear":this._table_view&&(this._drag_mode="move");break;case"dhx_event_move":case"dhx_wa_ev_body":this._drag_mode="move";break;case"dhx_event_resize":this._drag_mode="resize",(src.className||"").indexOf("dhx_event_resize_end")<0?scheduler._drag_from_start=!0:scheduler._drag_from_start=!1;break;case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_matrix_cell":case"dhx_marked_timespan":this._drag_mode="create";break;case"":if(src.parentNode)return scheduler._on_mouse_down(e,src.parentNode);break;default:if((!scheduler.checkEvent("onMouseDown")||scheduler.callEvent("onMouseDown",[classname]))&&src.parentNode&&src!=this&&"dhx_body"!=classname)return scheduler._on_mouse_down(e,src.parentNode);this._drag_mode=null,this._drag_id=null}if(this._drag_mode){var id=this._locate_event(src);this.config["drag_"+this._drag_mode]&&this.callEvent("onBeforeDrag",[id,this._drag_mode,e])?(this._drag_id=id,this._drag_event=scheduler._lame_clone(this.getEvent(this._drag_id)||{}),this._drag_pos=this._mouse_coords(e),this._drag_pos.start=+new Date):this._drag_mode=this._drag_id=0}this._drag_start=null}},scheduler._get_private_properties=function(event){var fields={};for(var i in event)0===i.indexOf("_")&&(fields[i]=!0);return fields},scheduler._clear_temporary_properties=function(clean,flagged_event){var initial=this._get_private_properties(clean),current_state=this._get_private_properties(flagged_event);for(var i in current_state)initial[i]||delete flagged_event[i]},scheduler._on_mouse_up=function(e){if(!e||2!=e.button||!scheduler.config.touch){if(this._drag_mode&&this._drag_id){this._els.dhx_cal_data[0].style.cursor="default";var drag_id=this._drag_id,mode=this._drag_mode,ev=this.getEvent(this._drag_id);if(this._drag_event._dhx_changed||!this._drag_event.start_date||ev.start_date.valueOf()!=this._drag_event.start_date.valueOf()||ev.end_date.valueOf()!=this._drag_event.end_date.valueOf()){var is_new="new-size"==this._drag_mode;if(this.callEvent("onBeforeEventChanged",[ev,e,is_new,this._drag_event]))if(this._drag_id=this._drag_mode=null,is_new&&this.config.edit_on_create){if(this.unselect(),this._new_event=new Date,this._table_view||this.config.details_on_create||!this.config.select)return scheduler.callEvent("onDragEnd",[drag_id,mode,e]),this.showLightbox(drag_id);this._drag_pos=!0,this._select_id=this._edit_id=drag_id}else this._new_event||this.callEvent(is_new?"onEventAdded":"onEventChanged",[drag_id,this.getEvent(drag_id)]);else is_new?this.deleteEvent(ev.id,!0):(this._drag_event._dhx_changed=!1,this._clear_temporary_properties(ev,this._drag_event),scheduler._lame_copy(ev,this._drag_event),this.updateEvent(ev.id))}this._drag_pos&&(this._drag_pos.has_moved||this._drag_pos===!0)&&this.render_view_data(),scheduler.callEvent("onDragEnd",[drag_id,mode,e])}this._drag_id=null,this._drag_mode=null,this._drag_pos=null}},scheduler._trigger_dyn_loading=function(){return this._load_mode&&this._load()?(this._render_wait=!0,!0):!1},scheduler.update_view=function(){var view=this[this._mode+"_view"];return view?view(!0):this._reset_scale(),this._trigger_dyn_loading()?!0:void this.render_view_data()},scheduler.isViewExists=function(mode){return!!(scheduler[mode+"_view"]||scheduler.date[mode+"_start"]&&scheduler.templates[mode+"_date"]&&scheduler.templates[mode+"_scale_date"])},scheduler.updateView=function(date,mode){date=date||this._date,mode=mode||this._mode;var dhx_cal_data="dhx_cal_data";this._mode?this._obj.className=this._obj.className.replace("dhx_scheduler_"+this._mode,"dhx_scheduler_"+mode):this._obj.className+=" dhx_scheduler_"+mode;var prev_scroll=this._mode==mode&&this.config.preserve_scroll?this._els[dhx_cal_data][0].scrollTop:!1;this[this._mode+"_view"]&&mode&&this._mode!=mode&&this[this._mode+"_view"](!1),this._close_not_saved();var dhx_multi_day="dhx_multi_day";this._els[dhx_multi_day]&&(this._els[dhx_multi_day][0].parentNode.removeChild(this._els[dhx_multi_day][0]),this._els[dhx_multi_day]=null),this._mode=mode,this._date=date,this._table_view="month"==this._mode,this._dy_shift=0;var tabs=this._els.dhx_cal_tab;if(tabs)for(var i=0;i<tabs.length;i++){var name=tabs[i].className;name=name.replace(/ active/g,""),tabs[i].getAttribute("name")==this._mode+"_tab"&&(name+=" active"),tabs[i].className=name}this.update_view(),"number"==typeof prev_scroll&&(this._els[dhx_cal_data][0].scrollTop=prev_scroll)},scheduler.setCurrentView=function(date,mode){this.callEvent("onBeforeViewChange",[this._mode,this._date,mode||this._mode,date||this._date])&&(this.updateView(date,mode),this.callEvent("onViewChange",[this._mode,this._date]))},scheduler._render_x_header=function(i,left,d,h,offset_top){offset_top=offset_top||0;var head=document.createElement("DIV");head.className="dhx_scale_bar",this.templates[this._mode+"_scalex_class"]&&(head.className+=" "+this.templates[this._mode+"_scalex_class"](d));var width=this._cols[i]-1;"month"==this._mode&&0===i&&this.config.left_border&&(head.className+=" dhx_scale_bar_border",left+=1),this.set_xy(head,width,this.xy.scale_height-2,left,offset_top),head.innerHTML=this.templates[this._mode+"_scale_date"](d,this._mode),h.appendChild(head)},scheduler._get_columns_num=function(from,to){var count=7;if(!scheduler._table_view){var count_n=scheduler.date["get_"+scheduler._mode+"_end"];count_n&&(to=count_n(from)),count=Math.round((to.valueOf()-from.valueOf())/864e5)}return count},scheduler._get_timeunit_start=function(){return this.date[this._mode+"_start"](new Date(this._date.valueOf()))},scheduler._get_view_end=function(){var dd=this._get_timeunit_start(),ed=scheduler.date.add(dd,1,this._mode);if(!scheduler._table_view){var count_n=scheduler.date["get_"+scheduler._mode+"_end"];count_n&&(ed=count_n(dd))}return ed},scheduler._calc_scale_sizes=function(width,from,to){var summ=width,count=this._get_columns_num(from,to);this._process_ignores(from,count,"day",1);for(var realcount=count-this._ignores_detected,i=0;count>i;i++)this._ignores[i]?(this._cols[i]=0,realcount++):this._cols[i]=Math.floor(summ/(realcount-i)),summ-=this._cols[i],this._colsS[i]=(this._cols[i-1]||0)+(this._colsS[i-1]||(this._table_view?0:this.xy.scale_width+2));this._colsS.col_length=count,this._colsS[count]=this._cols[count-1]+this._colsS[count-1]||0},scheduler._set_scale_col_size=function(div,width,left){var c=this.config;this.set_xy(div,width-1,c.hour_size_px*(c.last_hour-c.first_hour),left+this.xy.scale_width+1,0)},scheduler._render_scales=function(header,data_area){var sd=new Date(scheduler._min_date),ed=new Date(scheduler._max_date),today=this.date.date_part(scheduler._currentDate()),summ=parseInt(header.style.width,10),d=new Date(this._min_date),count=this._get_columns_num(sd,ed);this._calc_scale_sizes(summ,sd,ed);var left=0;header.innerHTML="";for(var i=0;count>i;i++){if(this._ignores[i]||this._render_x_header(i,left,d,header),!this._table_view){var scales=document.createElement("DIV"),cls="dhx_scale_holder";d.valueOf()==today.valueOf()&&(cls="dhx_scale_holder_now"),this._ignores_detected&&this._ignores[i]&&(cls+=" dhx_scale_ignore"),scales.className=cls+" "+this.templates.week_date_class(d,today),this._set_scale_col_size(scales,this._cols[i],left),data_area.appendChild(scales),this.callEvent("onScaleAdd",[scales,d])}left+=this._cols[i],d=this.date.add(d,1,"day"),d=this.date.day_start(d)}},scheduler._reset_scale=function(){if(this.templates[this._mode+"_date"]){var h=this._els.dhx_cal_header[0],data_area=this._els.dhx_cal_data[0],c=this.config;h.innerHTML="",data_area.innerHTML="";var str=(c.readonly||!c.drag_resize?" dhx_resize_denied":"")+(c.readonly||!c.drag_move?" dhx_move_denied":"");data_area.className="dhx_cal_data"+str,this._scales={},this._cols=[],this._colsS={height:0},this._dy_shift=0,this.set_sizes();var d,sd,dd=this._get_timeunit_start(),ed=scheduler._get_view_end();if(d=sd=this._table_view?scheduler.date.week_start(dd):dd,this._min_date=d,this._els.dhx_cal_date[0].innerHTML=this.templates[this._mode+"_date"](dd,ed,this._mode),this._max_date=ed,scheduler._render_scales(h,data_area),this._table_view)this._reset_month_scale(data_area,dd,sd);else if(this._reset_hours_scale(data_area,dd,sd),c.multi_day){var dhx_multi_day="dhx_multi_day";this._els[dhx_multi_day]&&(this._els[dhx_multi_day][0].parentNode.removeChild(this._els[dhx_multi_day][0]),this._els[dhx_multi_day]=null);var navline=this._els.dhx_cal_navline[0],top=navline.offsetHeight+this._els.dhx_cal_header[0].offsetHeight+1,c1=document.createElement("DIV");c1.className=dhx_multi_day,c1.style.visibility="hidden",this.set_xy(c1,Math.max(this._colsS[this._colsS.col_length]+this.xy.scroll_width-2,0),0,0,top),data_area.parentNode.insertBefore(c1,data_area);var c2=c1.cloneNode(!0);c2.className=dhx_multi_day+"_icon",c2.style.visibility="hidden",this.set_xy(c2,this.xy.scale_width,0,0,top),c1.appendChild(c2),this._els[dhx_multi_day]=[c1,c2],this._els[dhx_multi_day][0].onclick=this._click.dhx_cal_data}}},scheduler._reset_hours_scale=function(b,dd,sd){var c=document.createElement("DIV");c.className="dhx_scale_holder";for(var date=new Date(1980,1,1,this.config.first_hour,0,0),i=1*this.config.first_hour;i<this.config.last_hour;i++){var cc=document.createElement("DIV");cc.className="dhx_scale_hour",cc.style.height=this.config.hour_size_px-(this._quirks?0:1)+"px";var width=this.xy.scale_width;this.config.left_border&&(width-=1,cc.className+=" dhx_scale_hour_border"),cc.style.width=width+"px",cc.innerHTML=scheduler.templates.hour_scale(date),c.appendChild(cc),date=this.date.add(date,1,"hour")}b.appendChild(c),this.config.scroll_hour&&(b.scrollTop=this.config.hour_size_px*(this.config.scroll_hour-this.config.first_hour))},scheduler._currentDate=function(){return scheduler.config.now_date?new Date(scheduler.config.now_date):new Date},scheduler._process_ignores=function(sd,n,mode,step,preserve){this._ignores={},this._ignores_detected=0;var ignore=scheduler["ignore_"+this._mode];if(ignore)for(var ign_date=new Date(sd),i=0;n>i;i++)ignore(ign_date)&&(this._ignores_detected+=1,this._ignores[i]=!0,preserve&&n++),ign_date=scheduler.date.add(ign_date,step,mode),scheduler.date[mode+"_start"]&&(ign_date=scheduler.date[mode+"_start"](ign_date))},scheduler._render_month_scale=function(div,dd,sd){function getCellHeight(row){var h=scheduler._colsS.height;return void 0!==scheduler._colsS.heights[row+1]&&(h=scheduler._colsS.heights[row+1]-(scheduler._colsS.heights[row]||0)),h}var ed=scheduler.date.add(dd,1,"month"),view_start=new Date(sd),cd=scheduler._currentDate();this.date.date_part(cd),this.date.date_part(sd);for(var rows=Math.ceil(Math.round((ed.valueOf()-sd.valueOf())/864e5)/7),tdcss=[],i=0;7>=i;i++){var cell_width=(this._cols[i]||0)-1;0===i&&this.config.left_border&&(cell_width-=1),tdcss[i]=" style='width:"+cell_width+"px;"}for(var cellheight=0,html="<table cellpadding='0' cellspacing='0'>",rendered_dates=[],i=0;rows>i;i++){html+="<tr>";for(var row_height=Math.max(getCellHeight(i)-scheduler.xy.month_head_height,0),j=0;7>j;j++){html+="<td";var cls="";dd>sd?cls="dhx_before":sd>=ed?cls="dhx_after":sd.valueOf()==cd.valueOf()&&(cls="dhx_now"),this._ignores_detected&&this._ignores[j]&&(cls+=" dhx_scale_ignore"),html+=" class='"+cls+" "+this.templates.month_date_class(sd,cd)+"' >";var body_class="dhx_month_body",head_class="dhx_month_head";0===j&&this.config.left_border&&(body_class+=" dhx_month_body_border",head_class+=" dhx_month_head_border"),this._ignores_detected&&this._ignores[j]?html+="<div></div><div></div>":(html+="<div class='"+head_class+"'>"+this.templates.month_day(sd)+"</div>",html+="<div class='"+body_class+"' "+tdcss[j]+";height:"+row_height+"px;'></div></td>"),rendered_dates.push(sd);var bf1=sd.getDate();sd=this.date.add(sd,1,"day"),sd.getDate()-bf1>1&&(sd=new Date(sd.getFullYear(),sd.getMonth(),bf1+1,12,0))}html+="</tr>",scheduler._colsS.heights[i]=cellheight,cellheight+=getCellHeight(i)}html+="</table>",this._min_date=view_start,this._max_date=sd,div.innerHTML=html,this._scales={};for(var divs=div.getElementsByTagName("div"),i=0;i<rendered_dates.length;i++){var div=divs[2*i+1],date=rendered_dates[i];this._scales[+date]=div}for(var i=0;i<rendered_dates.length;i++){var date=rendered_dates[i];this.callEvent("onScaleAdd",[this._scales[+date],date])}return this._max_date},scheduler._reset_month_scale=function(b,dd,sd){var ed=scheduler.date.add(dd,1,"month"),cd=scheduler._currentDate();this.date.date_part(cd),this.date.date_part(sd);var rows=Math.ceil(Math.round((ed.valueOf()-sd.valueOf())/864e5)/7),height=Math.floor(b.clientHeight/rows)-this.xy.month_head_height;return this._colsS.height=height+this.xy.month_head_height,this._colsS.heights=[],scheduler._render_month_scale(b,dd,sd)},scheduler.getLabel=function(property,key){for(var sections=this.config.lightbox.sections,i=0;i<sections.length;i++)if(sections[i].map_to==property)for(var options=sections[i].options,j=0;j<options.length;j++)if(options[j].key==key)return options[j].label;return""},scheduler.updateCollection=function(list_name,collection){var list=scheduler.serverList(list_name);return list?(list.splice(0,list.length),list.push.apply(list,collection||[]),scheduler.callEvent("onOptionsLoad",[]),scheduler.resetLightbox(),!0):!1},scheduler._lame_clone=function(object,cache){var i,t,result;for(cache=cache||[],i=0;i<cache.length;i+=2)if(object===cache[i])return cache[i+1];if(object&&"object"==typeof object){for(result={},t=[Array,Date,Number,String,Boolean],i=0;i<t.length;i++)object instanceof t[i]&&(result=i?new t[i](object):new t[i]);cache.push(object,result);for(i in object)Object.prototype.hasOwnProperty.apply(object,[i])&&(result[i]=scheduler._lame_clone(object[i],cache))}return result||object},scheduler._lame_copy=function(target,source){for(var key in source)source.hasOwnProperty(key)&&(target[key]=source[key]);return target},scheduler._get_date_from_pos=function(pos){var start=this._min_date.valueOf()+6e4*(pos.y*this.config.time_step+24*(this._table_view?0:pos.x)*60);return new Date(this._correct_shift(start))},scheduler.getActionData=function(n_ev){var pos=this._mouse_coords(n_ev);return{date:this._get_date_from_pos(pos),section:pos.section}},scheduler._focus=function(node,select){node&&node.focus&&(this.config.touch?window.setTimeout(function(){node.focus()},100):(select&&node.select&&node.select(),node.focus()))},scheduler._get_real_event_length=function(sd,fd,obj){var end_slot,ev_length=fd-sd,hours=obj._start_correction+obj._end_correction||0,ignore=this["ignore_"+this._mode],start_slot=0;for(obj.render?(start_slot=this._get_date_index(obj,sd),end_slot=this._get_date_index(obj,fd)):end_slot=Math.round(ev_length/60/60/1e3/24);end_slot>start_slot;){var check=scheduler.date.add(fd,-obj.x_step,obj.x_unit);ev_length-=ignore&&ignore(fd)?fd-check:hours,fd=check,end_slot--}return ev_length},scheduler._get_fictional_event_length=function(end_date,ev_length,obj,back){var sd=new Date(end_date),dir=back?-1:1;if(obj._start_correction||obj._end_correction){var today;today=back?60*sd.getHours()+sd.getMinutes()-60*(obj.first_hour||0):60*(obj.last_hour||0)-(60*sd.getHours()+sd.getMinutes());var per_day=60*(obj.last_hour-obj.first_hour),days=Math.ceil((ev_length/6e4-today)/per_day);ev_length+=days*(1440-per_day)*60*1e3}var end_slot,fd=new Date(1*end_date+ev_length*dir),ignore=this["ignore_"+this._mode],start_slot=0;for(obj.render?(start_slot=this._get_date_index(obj,sd),end_slot=this._get_date_index(obj,fd)):end_slot=Math.round(ev_length/60/60/1e3/24);end_slot*dir>=start_slot*dir;){var check=scheduler.date.add(sd,obj.x_step*dir,obj.x_unit);ignore&&ignore(sd)&&(ev_length+=(check-sd)*dir,end_slot+=dir),sd=check,start_slot+=dir}return ev_length},scheduler._get_section_view=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode]:this._props&&this._props[this._mode]?this._props[this._mode]:null},scheduler._get_section_property=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode].y_property:this._props&&this._props[this._mode]?this._props[this._mode].map_to:null},scheduler._is_initialized=function(){var state=this.getState();return this._obj&&state.date&&state.mode},scheduler._is_lightbox_open=function(){var state=this.getState();return null!==state.lightbox_id&&void 0!==state.lightbox_id},scheduler.date={init:function(){for(var s=scheduler.locale.date.month_short,t=scheduler.locale.date.month_short_hash={},i=0;i<s.length;i++)t[s[i]]=i;for(var s=scheduler.locale.date.month_full,t=scheduler.locale.date.month_full_hash={},i=0;i<s.length;i++)t[s[i]]=i},date_part:function(date){var old=new Date(date);return date.setHours(0),date.setMinutes(0),date.setSeconds(0),date.setMilliseconds(0),date.getHours()&&(date.getDate()<old.getDate()||date.getMonth()<old.getMonth()||date.getFullYear()<old.getFullYear())&&date.setTime(date.getTime()+36e5*(24-date.getHours())),date},time_part:function(date){return(date.valueOf()/1e3-60*date.getTimezoneOffset())%86400},week_start:function(date){var shift=date.getDay();return scheduler.config.start_on_monday&&(0===shift?shift=6:shift--),this.date_part(this.add(date,-1*shift,"day"))},month_start:function(date){return date.setDate(1),this.date_part(date)},year_start:function(date){return date.setMonth(0),this.month_start(date)},day_start:function(date){return this.date_part(date)},_add_days:function(date,inc){var ndate=new Date(date.valueOf());return ndate.setDate(ndate.getDate()+inc),!date.getHours()&&ndate.getHours()&&(ndate.getDate()<date.getDate()||ndate.getMonth()<date.getMonth()||ndate.getFullYear()<date.getFullYear())&&ndate.setTime(ndate.getTime()+36e5*(24-ndate.getHours())),ndate},add:function(date,inc,mode){var ndate=new Date(date.valueOf());switch(mode){case"day":ndate=scheduler.date._add_days(ndate,inc);break;case"week":ndate=scheduler.date._add_days(ndate,7*inc);break;case"month":ndate.setMonth(ndate.getMonth()+inc);break;case"year":ndate.setYear(ndate.getFullYear()+inc);break;case"hour":ndate.setTime(ndate.getTime()+60*inc*60*1e3);break;case"minute":ndate.setTime(ndate.getTime()+60*inc*1e3);break;default:return scheduler.date["add_"+mode](date,inc,mode)}return ndate},to_fixed:function(num){return 10>num?"0"+num:num},copy:function(date){return new Date(date.valueOf())},date_to_str:function(format,utc){return format=format.replace(/%[a-zA-Z]/g,function(a){switch(a){case"%d":return'"+scheduler.date.to_fixed(date.getDate())+"';case"%m":return'"+scheduler.date.to_fixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+scheduler.date.to_fixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+scheduler.locale.date.day_short[date.getDay()]+"';case"%l":return'"+scheduler.locale.date.day_full[date.getDay()]+"';case"%M":return'"+scheduler.locale.date.month_short[date.getMonth()]+"';case"%F":return'"+scheduler.locale.date.month_full[date.getMonth()]+"';case"%h":return'"+scheduler.date.to_fixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+scheduler.date.to_fixed(date.getHours())+"';case"%i":return'"+scheduler.date.to_fixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?"pm":"am")+"';case"%A":return'"+(date.getHours()>11?"PM":"AM")+"';case"%s":return'"+scheduler.date.to_fixed(date.getSeconds())+"';case"%W":return'"+scheduler.date.to_fixed(scheduler.date.getISOWeek(date))+"';default:return a}}),utc&&(format=format.replace(/date\.get/g,"date.getUTC")),new Function("date",'return "'+format+'";')},str_to_date:function(format,utc){for(var splt="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);",mask=format.match(/%[a-zA-Z]/g),i=0;i<mask.length;i++)switch(mask[i]){case"%j":case"%d":splt+="set[2]=temp["+i+"]||1;";break;case"%n":case"%m":splt+="set[1]=(temp["+i+"]||1)-1;";break;case"%y":splt+="set[0]=temp["+i+"]*1+(temp["+i+"]>50?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":splt+="set[3]=temp["+i+"]||0;";break;case"%i":splt+="set[4]=temp["+i+"]||0;";break;case"%Y":splt+="set[0]=temp["+i+"]||0;";break;case"%a":case"%A":splt+="set[3]=set[3]%12+((temp["+i+"]||'').toLowerCase()=='am'?0:12);";break;case"%s":splt+="set[5]=temp["+i+"]||0;";break;case"%M":splt+="set[1]=scheduler.locale.date.month_short_hash[temp["+i+"]]||0;";
break;case"%F":splt+="set[1]=scheduler.locale.date.month_full_hash[temp["+i+"]]||0;"}var code="set[0],set[1],set[2],set[3],set[4],set[5]";return utc&&(code=" Date.UTC("+code+")"),new Function("date","var set=[0,0,1,0,0,0]; "+splt+" return new Date("+code+");")},getISOWeek:function(ndate){if(!ndate)return!1;var nday=ndate.getDay();0===nday&&(nday=7);var first_thursday=new Date(ndate.valueOf());first_thursday.setDate(ndate.getDate()+(4-nday));var year_number=first_thursday.getFullYear(),ordinal_date=Math.round((first_thursday.getTime()-new Date(year_number,0,1).getTime())/864e5),week_number=1+Math.floor(ordinal_date/7);return week_number},getUTCISOWeek:function(ndate){return this.getISOWeek(this.convert_to_utc(ndate))},convert_to_utc:function(date){return new Date(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate(),date.getUTCHours(),date.getUTCMinutes(),date.getUTCSeconds())}},scheduler.locale={date:{month_full:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},labels:{dhx_cal_today_button:"Today",day_tab:"Day",week_tab:"Week",month_tab:"Month",new_event:"New event",icon_save:"Save",icon_cancel:"Cancel",icon_details:"Details",icon_edit:"Edit",icon_delete:"Delete",confirm_closing:"",confirm_deleting:"Event will be deleted permanently, are you sure?",section_description:"Description",section_time:"Time period",full_day:"Full day",confirm_recurring:"Do you want to edit the whole set of repeated events?",section_recurring:"Repeat event",button_recurring:"Disabled",button_recurring_open:"Enabled",button_edit_series:"Edit series",button_edit_occurrence:"Edit occurrence",agenda_tab:"Agenda",date:"Date",description:"Description",year_tab:"Year",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel"}},scheduler.config={default_date:"%j %M %Y",month_date:"%F %Y",load_date:"%Y-%m-%d",week_date:"%l",day_date:"%D, %F %j",hour_date:"%H:%i",month_day:"%d",xml_date:"%m/%d/%Y %H:%i",api_date:"%d-%m-%Y %H:%i",preserve_length:!0,time_step:5,start_on_monday:1,first_hour:0,last_hour:24,readonly:!1,drag_resize:1,drag_move:1,drag_create:1,dblclick_create:1,edit_on_create:1,details_on_create:0,resize_month_events:!1,resize_month_timed:!1,cascade_event_display:!1,cascade_event_count:4,cascade_event_margin:30,multi_day:!0,multi_day_height_limit:0,drag_lightbox:!0,preserve_scroll:!0,select:!0,server_utc:!1,touch:!0,touch_tip:!0,touch_drag:500,quick_info_detached:!0,positive_closing:!1,drag_highlight:!0,limit_drag_out:!1,icons_edit:["icon_save","icon_cancel"],icons_select:["icon_details","icon_edit","icon_delete"],buttons_left:["dhx_save_btn","dhx_cancel_btn"],buttons_right:["dhx_delete_btn"],lightbox:{sections:[{name:"description",height:200,map_to:"text",type:"textarea",focus:!0},{name:"time",height:72,type:"time",map_to:"auto"}]},highlight_displayed_event:!0,left_border:!1,ajax_error:"alert",delay_render:0},scheduler.templates={},scheduler.init_templates=function(){var labels=scheduler.locale.labels;labels.dhx_save_btn=labels.icon_save,labels.dhx_cancel_btn=labels.icon_cancel,labels.dhx_delete_btn=labels.icon_delete;var d=scheduler.date.date_to_str,c=scheduler.config,f=function(a,b){for(var c in b)a[c]||(a[c]=b[c])};f(scheduler.templates,{day_date:d(c.default_date),month_date:d(c.month_date),week_date:function(d1,d2){return scheduler.templates.day_date(d1)+" &ndash; "+scheduler.templates.day_date(scheduler.date.add(d2,-1,"day"))},day_scale_date:d(c.default_date),month_scale_date:d(c.week_date),week_scale_date:d(c.day_date),hour_scale:d(c.hour_date),time_picker:d(c.hour_date),event_date:d(c.hour_date),month_day:d(c.month_day),xml_date:scheduler.date.str_to_date(c.xml_date,c.server_utc),load_format:d(c.load_date,c.server_utc),xml_format:d(c.xml_date,c.server_utc),api_date:scheduler.date.str_to_date(c.api_date),event_header:function(start,end,ev){return scheduler.templates.event_date(start)+" - "+scheduler.templates.event_date(end)},event_text:function(start,end,ev){return ev.text},event_class:function(start,end,ev){return""},month_date_class:function(d){return""},week_date_class:function(d){return""},event_bar_date:function(start,end,ev){return scheduler.templates.event_date(start)+" "},event_bar_text:function(start,end,ev){return ev.text},month_events_link:function(date,count){return"<a>View more("+count+" events)</a>"},drag_marker_class:function(start,end,event){return""},drag_marker_content:function(start,end,event){return""}}),this.callEvent("onTemplatesReady",[])},scheduler.uid=function(){return this._seed||(this._seed=(new Date).valueOf()),this._seed++},scheduler._events={},scheduler.clearAll=function(){this._events={},this._loaded={},this._edit_id=null,this._select_id=null,this._drag_id=null,this._drag_mode=null,this._drag_pos=null,this.clear_view(),this.callEvent("onClearAll",[])},scheduler.addEvent=function(start_date,end_date,text,id,extra_data){if(!arguments.length)return this.addEventNow();var ev=start_date;1!=arguments.length&&(ev=extra_data||{},ev.start_date=start_date,ev.end_date=end_date,ev.text=text,ev.id=id),ev.id=ev.id||scheduler.uid(),ev.text=ev.text||"","string"==typeof ev.start_date&&(ev.start_date=this.templates.api_date(ev.start_date)),"string"==typeof ev.end_date&&(ev.end_date=this.templates.api_date(ev.end_date));var d=6e4*(this.config.event_duration||this.config.time_step);ev.start_date.valueOf()==ev.end_date.valueOf()&&ev.end_date.setTime(ev.end_date.valueOf()+d),ev._timed=this.isOneDayEvent(ev);var is_new=!this._events[ev.id];return this._events[ev.id]=ev,this.event_updated(ev),this._loading||this.callEvent(is_new?"onEventAdded":"onEventChanged",[ev.id,ev]),ev.id},scheduler.deleteEvent=function(id,silent){var ev=this._events[id];(silent||this.callEvent("onBeforeEventDelete",[id,ev])&&this.callEvent("onConfirmedBeforeEventDelete",[id,ev]))&&(ev&&(this._select_id=null,delete this._events[id],this.event_updated(ev)),this.callEvent("onEventDeleted",[id,ev]))},scheduler.getEvent=function(id){return this._events[id]},scheduler.setEvent=function(id,hash){hash.id||(hash.id=id),this._events[id]=hash},scheduler.for_rendered=function(id,method){for(var i=this._rendered.length-1;i>=0;i--)this._rendered[i].getAttribute("event_id")==id&&method(this._rendered[i],i)},scheduler.changeEventId=function(id,new_id){if(id!=new_id){var ev=this._events[id];ev&&(ev.id=new_id,this._events[new_id]=ev,delete this._events[id]),this.for_rendered(id,function(r){r.setAttribute("event_id",new_id)}),this._select_id==id&&(this._select_id=new_id),this._edit_id==id&&(this._edit_id=new_id),this.callEvent("onEventIdChange",[id,new_id])}},function(){for(var attrs=["text","Text","start_date","StartDate","end_date","EndDate"],create_getter=function(name){return function(id){return scheduler.getEvent(id)[name]}},create_setter=function(name){return function(id,value){var ev=scheduler.getEvent(id);ev[name]=value,ev._changed=!0,ev._timed=this.isOneDayEvent(ev),scheduler.event_updated(ev,!0)}},i=0;i<attrs.length;i+=2)scheduler["getEvent"+attrs[i+1]]=create_getter(attrs[i]),scheduler["setEvent"+attrs[i+1]]=create_setter(attrs[i])}(),scheduler.event_updated=function(ev,force){this.is_visible_events(ev)?this.render_view_data():this.clear_event(ev.id)},scheduler.is_visible_events=function(ev){var in_visible_range=ev.start_date<this._max_date&&this._min_date<ev.end_date;if(in_visible_range){var end_dates_visible=this._table_view||ev.end_date.getHours()>=this.config.first_hour&&ev.end_date.getHours()<this.config.last_hour||ev.start_date.getHours()>=this.config.first_hour&&ev.start_date.getHours()<this.config.last_hour;if(end_dates_visible)return!0;var event_duration=(ev.end_date.valueOf()-ev.start_date.valueOf())/36e5,hidden_duration=24-(this.config.last_hour-this.config.first_hour);return event_duration>hidden_duration}return!1},scheduler.isOneDayEvent=function(ev){var delta=ev.end_date.getDate()-ev.start_date.getDate();return delta?(0>delta&&(delta=Math.ceil((ev.end_date.valueOf()-ev.start_date.valueOf())/864e5)),1==delta&&!ev.end_date.getHours()&&!ev.end_date.getMinutes()&&(ev.start_date.getHours()||ev.start_date.getMinutes())):ev.start_date.getMonth()==ev.end_date.getMonth()&&ev.start_date.getFullYear()==ev.end_date.getFullYear()},scheduler.get_visible_events=function(only_timed){var stack=[];for(var id in this._events)this.is_visible_events(this._events[id])&&(!only_timed||this._events[id]._timed)&&this.filter_event(id,this._events[id])&&stack.push(this._events[id]);return stack},scheduler.filter_event=function(id,ev){var filter=this["filter_"+this._mode];return filter?filter(id,ev):!0},scheduler._is_main_area_event=function(ev){return!!ev._timed},scheduler.render_view_data=function(evs,hold){if(!evs){if(this._not_render)return void(this._render_wait=!0);this._render_wait=!1,this.clear_view(),evs=this.get_visible_events(!(this._table_view||this.config.multi_day))}for(var i=0,len=evs.length;len>i;i++)this._recalculate_timed(evs[i]);if(this.config.multi_day&&!this._table_view){for(var tvs=[],tvd=[],i=0;i<evs.length;i++)this._is_main_area_event(evs[i])?tvs.push(evs[i]):tvd.push(evs[i]);this._rendered_location=this._els.dhx_multi_day[0],this._table_view=!0,this.render_data(tvd,hold),this._table_view=!1,this._rendered_location=this._els.dhx_cal_data[0],this._table_view=!1,this.render_data(tvs,hold)}else this._rendered_location=this._els.dhx_cal_data[0],this.render_data(evs,hold)},scheduler._view_month_day=function(e){var date=scheduler.getActionData(e).date;scheduler.callEvent("onViewMoreClick",[date])&&scheduler.setCurrentView(date,"day")},scheduler._render_month_link=function(ev){for(var parent=this._rendered_location,toRender=this._lame_clone(ev),d=ev._sday;d<ev._eday;d++){toRender._sday=d,toRender._eday=d+1;var date=scheduler.date,curr=scheduler._min_date;curr=date.add(curr,toRender._sweek,"week"),curr=date.add(curr,toRender._sday,"day");var count=scheduler.getEvents(curr,date.add(curr,1,"day")).length,pos=this._get_event_bar_pos(toRender),widt=pos.x2-pos.x,el=document.createElement("div");el.onclick=function(e){scheduler._view_month_day(e||event)},el.className="dhx_month_link",el.style.top=pos.y+"px",el.style.left=pos.x+"px",el.style.width=widt+"px",el.innerHTML=scheduler.templates.month_events_link(curr,count),this._rendered.push(el),parent.appendChild(el)}},scheduler._recalculate_timed=function(id){if(id){var ev;ev="object"!=typeof id?this._events[id]:id,ev&&(ev._timed=scheduler.isOneDayEvent(ev))}},scheduler.attachEvent("onEventChanged",scheduler._recalculate_timed),scheduler.attachEvent("onEventAdded",scheduler._recalculate_timed),scheduler.render_data=function(evs,hold){evs=this._pre_render_events(evs,hold);for(var i=0;i<evs.length;i++)if(this._table_view)if("month"!=scheduler._mode)this.render_event_bar(evs[i]);else{var max_evs=scheduler.config.max_month_events;max_evs!==1*max_evs||evs[i]._sorder<max_evs?this.render_event_bar(evs[i]):void 0!==max_evs&&evs[i]._sorder==max_evs&&scheduler._render_month_link(evs[i])}else this.render_event(evs[i])},scheduler._get_first_visible_cell=function(cells){for(var i=0;i<cells.length;i++)if(-1==(cells[i].className||"").indexOf("dhx_scale_ignore"))return cells[i];return cells[0]},scheduler._pre_render_events=function(evs,hold){var hb=this.xy.bar_height,h_old=this._colsS.heights,h=this._colsS.heights=[0,0,0,0,0,0,0],data=this._els.dhx_cal_data[0];if(evs=this._table_view?this._pre_render_events_table(evs,hold):this._pre_render_events_line(evs,hold),this._table_view)if(hold)this._colsS.heights=h_old;else{var evl=data.firstChild;if(evl.rows){for(var i=0;i<evl.rows.length;i++){h[i]++;var cells=evl.rows[i].cells,cellHeight=this._colsS.height-this.xy.month_head_height;if(h[i]*hb>cellHeight){var cHeight=cellHeight;1*this.config.max_month_events!==this.config.max_month_events||h[i]<=this.config.max_month_events?cHeight=h[i]*hb:(this.config.max_month_events+1)*hb>cellHeight&&(cHeight=(this.config.max_month_events+1)*hb);for(var j=0;j<cells.length;j++)cells[j].childNodes[1].style.height=cHeight+"px"}h[i]=(h[i-1]||0)+scheduler._get_first_visible_cell(cells).offsetHeight}if(h.unshift(0),evl.parentNode.offsetHeight<evl.parentNode.scrollHeight&&!scheduler._colsS.scroll_fix&&scheduler.xy.scroll_width){var scale_settings=scheduler._colsS,sum_width=scale_settings[scale_settings.col_length],row_heights=scale_settings.heights.slice();sum_width-=scheduler.xy.scroll_width||0,this._calc_scale_sizes(sum_width,this._min_date,this._max_date),scheduler._colsS.heights=row_heights,this.set_xy(this._els.dhx_cal_header[0],sum_width,this.xy.scale_height),scheduler._render_scales(this._els.dhx_cal_header[0]),scheduler._render_month_scale(this._els.dhx_cal_data[0],this._get_timeunit_start(),this._min_date),scale_settings.scroll_fix=!0}}else if(evs.length||"visible"!=this._els.dhx_multi_day[0].style.visibility||(h[0]=-1),evs.length||-1==h[0]){var full_multi_day_height=(evl.parentNode.childNodes,(h[0]+1)*hb+1),used_multi_day_height=full_multi_day_height,used_multi_day_height_css=full_multi_day_height+"px";this.config.multi_day_height_limit&&(used_multi_day_height=Math.min(full_multi_day_height,this.config.multi_day_height_limit),used_multi_day_height_css=used_multi_day_height+"px"),data.style.top=this._els.dhx_cal_navline[0].offsetHeight+this._els.dhx_cal_header[0].offsetHeight+used_multi_day_height+"px",data.style.height=this._obj.offsetHeight-parseInt(data.style.top,10)-(this.xy.margin_top||0)+"px";var multi_day_section=this._els.dhx_multi_day[0];multi_day_section.style.height=used_multi_day_height_css,multi_day_section.style.visibility=-1==h[0]?"hidden":"visible";var multi_day_icon=this._els.dhx_multi_day[1];multi_day_icon.style.height=used_multi_day_height_css,multi_day_icon.style.visibility=-1==h[0]?"hidden":"visible",multi_day_icon.className=h[0]?"dhx_multi_day_icon":"dhx_multi_day_icon_small",this._dy_shift=(h[0]+1)*hb,this.config.multi_day_height_limit&&(this._dy_shift=Math.min(this.config.multi_day_height_limit,this._dy_shift)),h[0]=0,used_multi_day_height!=full_multi_day_height&&(data.style.top=parseInt(data.style.top)+2+"px",multi_day_section.style.overflowY="auto",multi_day_icon.style.position="fixed",multi_day_icon.style.top="",multi_day_icon.style.left="")}}return evs},scheduler._get_event_sday=function(ev){return Math.floor((ev.start_date.valueOf()-this._min_date.valueOf())/864e5)},scheduler._get_event_mapped_end_date=function(ev){var end_date=ev.end_date;if(this.config.separate_short_events){var ev_duration=(ev.end_date-ev.start_date)/6e4;ev_duration<this._min_mapped_duration&&(end_date=this.date.add(end_date,this._min_mapped_duration-ev_duration,"minute"))}return end_date},scheduler._pre_render_events_line=function(evs,hold){evs.sort(function(a,b){return a.start_date.valueOf()==b.start_date.valueOf()?a.id>b.id?1:-1:a.start_date>b.start_date?1:-1});var days=[],evs_originals=[];this._min_mapped_duration=Math.ceil(60*this.xy.min_event_height/this.config.hour_size_px);for(var i=0;i<evs.length;i++){var ev=evs[i],sd=ev.start_date,ed=ev.end_date,sh=sd.getHours(),eh=ed.getHours();if(ev._sday=this._get_event_sday(ev),this._ignores[ev._sday])evs.splice(i,1),i--;else{if(days[ev._sday]||(days[ev._sday]=[]),!hold){ev._inner=!1;for(var stack=days[ev._sday];stack.length;){var t_ev=stack[stack.length-1],t_end_date=this._get_event_mapped_end_date(t_ev);if(!(t_end_date.valueOf()<=ev.start_date.valueOf()))break;stack.splice(stack.length-1,1)}for(var slot_index=stack.length,sorderSet=!1,j=0;j<stack.length;j++){var t_ev=stack[j],t_end_date=this._get_event_mapped_end_date(t_ev);if(t_end_date.valueOf()<=ev.start_date.valueOf()){sorderSet=!0,ev._sorder=t_ev._sorder,slot_index=j,ev._inner=!0;break}}if(stack.length&&(stack[stack.length-1]._inner=!0),!sorderSet)if(stack.length)if(stack.length<=stack[stack.length-1]._sorder){if(stack[stack.length-1]._sorder)for(j=0;j<stack.length;j++){for(var _is_sorder=!1,k=0;k<stack.length;k++)if(stack[k]._sorder==j){_is_sorder=!0;break}if(!_is_sorder){ev._sorder=j;break}}else ev._sorder=0;ev._inner=!0}else{var _max_sorder=stack[0]._sorder;for(j=1;j<stack.length;j++)stack[j]._sorder>_max_sorder&&(_max_sorder=stack[j]._sorder);ev._sorder=_max_sorder+1,ev._inner=!1}else ev._sorder=0;stack.splice(slot_index,slot_index==stack.length?0:1,ev),stack.length>(stack.max_count||0)?(stack.max_count=stack.length,ev._count=stack.length):ev._count=ev._count?ev._count:1}(sh<this.config.first_hour||eh>=this.config.last_hour)&&(evs_originals.push(ev),evs[i]=ev=this._copy_event(ev),sh<this.config.first_hour&&(ev.start_date.setHours(this.config.first_hour),ev.start_date.setMinutes(0)),eh>=this.config.last_hour&&(ev.end_date.setMinutes(0),ev.end_date.setHours(this.config.last_hour)),ev.start_date>ev.end_date||sh==this.config.last_hour)&&(evs.splice(i,1),i--)}}if(!hold){for(var i=0;i<evs.length;i++)evs[i]._count=days[evs[i]._sday].max_count;for(var i=0;i<evs_originals.length;i++)evs_originals[i]._count=days[evs_originals[i]._sday].max_count}return evs},scheduler._time_order=function(evs){evs.sort(function(a,b){return a.start_date.valueOf()==b.start_date.valueOf()?a._timed&&!b._timed?1:!a._timed&&b._timed?-1:a.id>b.id?1:-1:a.start_date>b.start_date?1:-1})},scheduler._pre_render_events_table=function(evs,hold){this._time_order(evs);for(var start_date,out=[],weeks=[[],[],[],[],[],[],[]],max=this._colsS.heights,cols=this._cols.length,chunks_info={},i=0;i<evs.length;i++){var ev=evs[i],id=ev.id;chunks_info[id]||(chunks_info[id]={first_chunk:!0,last_chunk:!0});var chunk_info=chunks_info[id],sd=start_date||ev.start_date,ed=ev.end_date;sd<this._min_date&&(chunk_info.first_chunk=!1,sd=this._min_date),ed>this._max_date&&(chunk_info.last_chunk=!1,ed=this._max_date);var locate_s=this.locate_holder_day(sd,!1,ev);if(ev._sday=locate_s%cols,!this._ignores[ev._sday]||!ev._timed){var locate_e=this.locate_holder_day(ed,!0,ev)||cols;ev._eday=locate_e%cols||cols,ev._length=locate_e-locate_s,ev._sweek=Math.floor((this._correct_shift(sd.valueOf(),1)-this._min_date.valueOf())/(864e5*cols));var stack_line,stack=weeks[ev._sweek];for(stack_line=0;stack_line<stack.length&&!(stack[stack_line]._eday<=ev._sday);stack_line++);if(ev._sorder&&hold||(ev._sorder=stack_line),ev._sday+ev._length<=cols)start_date=null,out.push(ev),stack[stack_line]=ev,max[ev._sweek]=stack.length-1,ev._first_chunk=chunk_info.first_chunk,ev._last_chunk=chunk_info.last_chunk;else{var copy=this._copy_event(ev);copy.id=ev.id,copy._length=cols-ev._sday,copy._eday=cols,copy._sday=ev._sday,copy._sweek=ev._sweek,copy._sorder=ev._sorder,copy.end_date=this.date.add(sd,copy._length,"day"),copy._first_chunk=chunk_info.first_chunk,chunk_info.first_chunk&&(chunk_info.first_chunk=!1),out.push(copy),stack[stack_line]=copy,start_date=copy.end_date,max[ev._sweek]=stack.length-1,i--}}}return out},scheduler._copy_dummy=function(){var a=new Date(this.start_date),b=new Date(this.end_date);this.start_date=a,this.end_date=b},scheduler._copy_event=function(ev){return this._copy_dummy.prototype=ev,new this._copy_dummy},scheduler._rendered=[],scheduler.clear_view=function(){for(var i=0;i<this._rendered.length;i++){var obj=this._rendered[i];obj.parentNode&&obj.parentNode.removeChild(obj)}this._rendered=[]},scheduler.updateEvent=function(id){var ev=this.getEvent(id);this.clear_event(id),ev&&this.is_visible_events(ev)&&this.filter_event(id,ev)&&(this._table_view||this.config.multi_day||ev._timed)&&(this.config.update_render?this.render_view_data():"month"!=this.getState().mode||this.getState().drag_id||this.isOneDayEvent(ev)?this.render_view_data([ev],!0):this.render_view_data())},scheduler.clear_event=function(id){this.for_rendered(id,function(node,i){node.parentNode&&node.parentNode.removeChild(node),scheduler._rendered.splice(i,1)})},scheduler._y_from_date=function(date){var sm=60*date.getHours()+date.getMinutes();return Math.round((60*sm*1e3-60*this.config.first_hour*60*1e3)*this.config.hour_size_px/36e5)%(24*this.config.hour_size_px)},scheduler._calc_event_y=function(ev,min_height){min_height=min_height||0;var sm=60*ev.start_date.getHours()+ev.start_date.getMinutes(),em=60*ev.end_date.getHours()+ev.end_date.getMinutes()||60*scheduler.config.last_hour,top=this._y_from_date(ev.start_date),height=Math.max(min_height,(em-sm)*this.config.hour_size_px/60);return{top:top,height:height}},scheduler.render_event=function(ev){var menu=scheduler.xy.menu_width,menu_offset=this.config.use_select_menu_space?0:menu;if(!(ev._sday<0)){var parent=scheduler.locate_holder(ev._sday);if(parent){var pos_y=this._calc_event_y(ev,scheduler.xy.min_event_height),top=pos_y.top,height=pos_y.height,ev_count=ev._count||1,ev_sorder=ev._sorder||0,width=Math.floor((parent.clientWidth-menu_offset)/ev_count),left=ev_sorder*width+1;if(ev._inner||(width*=ev_count-ev_sorder),this.config.cascade_event_display){var limit=this.config.cascade_event_count,margin=this.config.cascade_event_margin;left=ev_sorder%limit*margin;var right=ev._inner?(ev_count-ev_sorder-1)%limit*margin/2:0;width=Math.floor(parent.clientWidth-menu_offset-left-right)}var d=this._render_v_bar(ev,menu_offset+left,top,width,height,ev._text_style,scheduler.templates.event_header(ev.start_date,ev.end_date,ev),scheduler.templates.event_text(ev.start_date,ev.end_date,ev));if(this._rendered.push(d),parent.appendChild(d),left=left+parseInt(parent.style.left,10)+menu_offset,this._edit_id==ev.id){d.style.zIndex=1,width=Math.max(width-4,scheduler.xy.editor_width),d=document.createElement("DIV"),d.setAttribute("event_id",ev.id),this.set_xy(d,width,height-20,left,top+14),d.className="dhx_cal_event dhx_cal_editor";var tplClass=scheduler.templates.event_class(ev.start_date,ev.end_date,ev);tplClass&&(d.className+=" "+tplClass);var d2=document.createElement("DIV");this.set_xy(d2,width-6,height-26),d2.style.cssText+=";margin:2px 2px 2px 2px;overflow:hidden;",d.appendChild(d2),this._els.dhx_cal_data[0].appendChild(d),this._rendered.push(d),d2.innerHTML="<textarea class='dhx_cal_editor'>"+ev.text+"</textarea>",this._quirks7&&(d2.firstChild.style.height=height-12+"px"),this._editor=d2.firstChild,this._editor.onkeydown=function(e){if((e||event).shiftKey)return!0;var code=(e||event).keyCode;code==scheduler.keys.edit_save&&scheduler.editStop(!0),code==scheduler.keys.edit_cancel&&scheduler.editStop(!1)},this._editor.onselectstart=function(e){return(e||event).cancelBubble=!0,!0},scheduler._focus(d2.firstChild,!0),this._els.dhx_cal_data[0].scrollLeft=0}if(0!==this.xy.menu_width&&this._select_id==ev.id){this.config.cascade_event_display&&this._drag_mode&&(d.style.zIndex=1);for(var icons=this.config["icons_"+(this._edit_id==ev.id?"edit":"select")],icons_str="",bg_color=ev.color?"background-color: "+ev.color+";":"",color=ev.textColor?"color: "+ev.textColor+";":"",i=0;i<icons.length;i++)icons_str+="<div class='dhx_menu_icon "+icons[i]+"' style='"+bg_color+color+"' title='"+this.locale.labels[icons[i]]+"'></div>";var obj=this._render_v_bar(ev,left-menu+1,top,menu,20*icons.length+26-2,"","<div style='"+bg_color+color+"' class='dhx_menu_head'></div>",icons_str,!0);obj.style.left=left-menu+1,this._els.dhx_cal_data[0].appendChild(obj),this._rendered.push(obj)}this.config.drag_highlight&&this._drag_id==ev.id&&this.highlightEventPosition(ev)}}},scheduler._render_v_bar=function(ev,x,y,w,h,style,contentA,contentB,bottom){var d=document.createElement("DIV"),id=ev.id,cs=bottom?"dhx_cal_event dhx_cal_select_menu":"dhx_cal_event",cse=scheduler.templates.event_class(ev.start_date,ev.end_date,ev);cse&&(cs=cs+" "+cse);var bg_color=ev.color?"background:"+ev.color+";":"",color=ev.textColor?"color:"+ev.textColor+";":"",html='<div event_id="'+id+'" class="'+cs+'" style="position:absolute; top:'+y+"px; left:"+x+"px; width:"+(w-4)+"px; height:"+h+"px;"+(style||"")+'"></div>';d.innerHTML=html;var container=d.cloneNode(!0).firstChild;if(!bottom&&scheduler.renderEvent(container,ev,w,h,contentA,contentB))return container;container=d.firstChild;var inner_html='<div class="dhx_event_move dhx_header" style=" width:'+(w-6)+"px;"+bg_color+'" >&nbsp;</div>';inner_html+='<div class="dhx_event_move dhx_title" style="'+bg_color+color+'">'+contentA+"</div>",inner_html+='<div class="dhx_body" style=" width:'+(w-(this._quirks?4:14))+"px; height:"+(h-(this._quirks?20:30)+1)+"px;"+bg_color+color+'">'+contentB+"</div>";var footer_class="dhx_event_resize dhx_footer";return bottom&&(footer_class="dhx_resize_denied "+footer_class),inner_html+='<div class="'+footer_class+'" style=" width:'+(w-8)+"px;"+(bottom?" margin-top:-1px;":"")+bg_color+color+'" ></div>',container.innerHTML=inner_html,container},scheduler.renderEvent=function(){return!1},scheduler.locate_holder=function(day){return"day"==this._mode?this._els.dhx_cal_data[0].firstChild:this._els.dhx_cal_data[0].childNodes[day]},scheduler.locate_holder_day=function(date,past){var day=Math.floor((this._correct_shift(date,1)-this._min_date)/864e5);return past&&this.date.time_part(date)&&day++,day},scheduler._get_dnd_order=function(order,ev_height,max_height){if(!this._drag_event)return order;this._drag_event._orig_sorder?order=this._drag_event._orig_sorder:this._drag_event._orig_sorder=order;for(var evTop=ev_height*order;evTop+ev_height>max_height;)order--,evTop-=ev_height;return order=Math.max(order,0)},scheduler._get_event_bar_pos=function(ev){var x=this._colsS[ev._sday],x2=this._colsS[ev._eday];x2==x&&(x2=this._colsS[ev._eday+1]);var hb=this.xy.bar_height,order=ev._sorder;if(ev.id==this._drag_id){var cellHeight=this._colsS.heights[ev._sweek+1]-this._colsS.heights[ev._sweek]-this.xy.month_head_height;order=scheduler._get_dnd_order(order,hb,cellHeight)}var y_event_offset=order*hb,y=this._colsS.heights[ev._sweek]+(this._colsS.height?this.xy.month_scale_height+2:2)+y_event_offset;return{x:x,x2:x2,y:y}},scheduler.render_event_bar=function(ev){var parent=this._rendered_location,pos=this._get_event_bar_pos(ev),y=pos.y,x=pos.x,x2=pos.x2,resize_handle="";if(x2){var resizable=scheduler.config.resize_month_events&&"month"==this._mode&&(!ev._timed||scheduler.config.resize_month_timed),d=document.createElement("DIV"),left_chunk=ev.hasOwnProperty("_first_chunk")&&ev._first_chunk,right_chunk=ev.hasOwnProperty("_last_chunk")&&ev._last_chunk,resize_left=resizable&&(ev._timed||left_chunk),resize_right=resizable&&(ev._timed||right_chunk),cs="dhx_cal_event_clear";(!ev._timed||resizable)&&(cs="dhx_cal_event_line"),left_chunk&&(cs+=" dhx_cal_event_line_start"),right_chunk&&(cs+=" dhx_cal_event_line_end"),resize_left&&(resize_handle+="<div class='dhx_event_resize dhx_event_resize_start'></div>"),resize_right&&(resize_handle+="<div class='dhx_event_resize dhx_event_resize_end'></div>");var cse=scheduler.templates.event_class(ev.start_date,ev.end_date,ev);cse&&(cs+=" "+cse);var bg_color=ev.color?"background:"+ev.color+";":"",color=ev.textColor?"color:"+ev.textColor+";":"",style_text=["position:absolute","top:"+y+"px","left:"+x+"px","width:"+(x2-x-15)+"px",color,bg_color,ev._text_style||""].join(";"),html='<div event_id="'+ev.id+'" class="'+cs+'" style="'+style_text+'">';resizable&&(html+=resize_handle),"month"==scheduler.getState().mode&&(ev=scheduler.getEvent(ev.id)),ev._timed&&(html+=scheduler.templates.event_bar_date(ev.start_date,ev.end_date,ev)),html+=scheduler.templates.event_bar_text(ev.start_date,ev.end_date,ev)+"</div>",html+="</div>",d.innerHTML=html,this._rendered.push(d.firstChild),parent.appendChild(d.firstChild)}},scheduler._locate_event=function(node){for(var id=null;node&&!id&&node.getAttribute;)id=node.getAttribute("event_id"),node=node.parentNode;return id},scheduler.edit=function(id){this._edit_id!=id&&(this.editStop(!1,id),this._edit_id=id,this.updateEvent(id))},scheduler.editStop=function(mode,id){if(!id||this._edit_id!=id){var ev=this.getEvent(this._edit_id);ev&&(mode&&(ev.text=this._editor.value),this._edit_id=null,this._editor=null,this.updateEvent(ev.id),this._edit_stop_event(ev,mode))}},scheduler._edit_stop_event=function(ev,mode){this._new_event?(mode?this.callEvent("onEventAdded",[ev.id,ev]):ev&&this.deleteEvent(ev.id,!0),this._new_event=null):mode&&this.callEvent("onEventChanged",[ev.id,ev])},scheduler.getEvents=function(from,to){var result=[];for(var a in this._events){var ev=this._events[a];ev&&(!from&&!to||ev.start_date<to&&ev.end_date>from)&&result.push(ev)}return result},scheduler.getRenderedEvent=function(id){if(id){for(var rendered_events=scheduler._rendered,i=0;i<rendered_events.length;i++){var rendered_event=rendered_events[i];if(rendered_event.getAttribute("event_id")==id)return rendered_event}return null}},scheduler.showEvent=function(id,mode){var ev="number"==typeof id||"string"==typeof id?scheduler.getEvent(id):id;if(mode=mode||scheduler._mode,ev&&(!this.checkEvent("onBeforeEventDisplay")||this.callEvent("onBeforeEventDisplay",[ev,mode]))){var scroll_hour=scheduler.config.scroll_hour;scheduler.config.scroll_hour=ev.start_date.getHours();var preserve_scroll=scheduler.config.preserve_scroll;scheduler.config.preserve_scroll=!1;var original_color=ev.color,original_text_color=ev.textColor;scheduler.config.highlight_displayed_event&&(ev.color=scheduler.config.displayed_event_color,ev.textColor=scheduler.config.displayed_event_text_color),scheduler.setCurrentView(new Date(ev.start_date),mode),ev.color=original_color,ev.textColor=original_text_color,scheduler.config.scroll_hour=scroll_hour,scheduler.config.preserve_scroll=preserve_scroll,scheduler.matrix&&scheduler.matrix[mode]&&(scheduler._els.dhx_cal_data[0].scrollTop=getAbsoluteTop(scheduler.getRenderedEvent(ev.id))-getAbsoluteTop(scheduler._els.dhx_cal_data[0])-20),scheduler.callEvent("onAfterEventDisplay",[ev,mode])}},scheduler._append_drag_marker=function(m){if(!m.parentNode){var zone=scheduler._els.dhx_cal_data[0],scale=zone.lastChild;scale.className&&scale.className.indexOf("dhx_scale_holder")<0&&scale.previousSibling&&(scale=scale.previousSibling),scale&&0===scale.className.indexOf("dhx_scale_holder")&&scale.appendChild(m)}},scheduler._update_marker_position=function(m,event){var size=scheduler._calc_event_y(event,0);m.style.top=size.top+"px",m.style.height=size.height+"px"},scheduler.highlightEventPosition=function(event){var m=document.createElement("div");m.setAttribute("event_id",event.id),this._rendered.push(m),this._update_marker_position(m,event);var css=this.templates.drag_marker_class(event.start_date,event.end_date,event),html=this.templates.drag_marker_content(event.start_date,event.end_date,event);m.className="dhx_drag_marker",css&&(m.className+=" "+css),html&&(m.innerHTML=html),this._append_drag_marker(m)},scheduler._loaded={},scheduler._load=function(url,from){if(url=url||this._load_url){url+=(-1==url.indexOf("?")?"?":"&")+"timeshift="+(new Date).getTimezoneOffset(),this.config.prevent_cache&&(url+="&uid="+this.uid());var to;if(from=from||this._date,this._load_mode){var lf=this.templates.load_format;for(from=this.date[this._load_mode+"_start"](new Date(from.valueOf()));from>this._min_date;)from=this.date.add(from,-1,this._load_mode);to=from;for(var cache_line=!0;to<this._max_date;)to=this.date.add(to,1,this._load_mode),this._loaded[lf(from)]&&cache_line?from=this.date.add(from,1,this._load_mode):cache_line=!1;var temp_to=to;do to=temp_to,temp_to=this.date.add(to,-1,this._load_mode);while(temp_to>from&&this._loaded[lf(temp_to)]);if(from>=to)return!1;for(dhtmlxAjax.get(url+"&from="+lf(from)+"&to="+lf(to),function(l){scheduler.on_load(l)});to>from;)this._loaded[lf(from)]=!0,from=this.date.add(from,1,this._load_mode)}else dhtmlxAjax.get(url,function(l){scheduler.on_load(l)});return this.callEvent("onXLS",[]),!0}},scheduler.on_load=function(loader){var evs,error=!1;if(this._process&&"xml"!=this._process)try{evs=this[this._process].parse(loader.xmlDoc.responseText)}catch(e){error=!0}else evs=this._magic_parser(loader),evs||(error=!0);error&&(this.callEvent("onLoadError",[loader.xmlDoc]),
evs=[]),scheduler._process_loading(evs),this.callEvent("onXLE",[])},scheduler._process_loading=function(evs){this._loading=!0,this._not_render=!0;for(var i=0;i<evs.length;i++)this.callEvent("onEventLoading",[evs[i]])&&this.addEvent(evs[i]);this._not_render=!1,this._render_wait&&this.render_view_data(),this._loading=!1,this._after_call&&this._after_call(),this._after_call=null},scheduler._init_event=function(event){event.text=event.text||event._tagvalue||"",event.start_date=scheduler._init_date(event.start_date),event.end_date=scheduler._init_date(event.end_date)},scheduler._init_date=function(date){return date?"string"==typeof date?scheduler.templates.xml_date(date):new Date(date):null},scheduler.json={},scheduler.json.parse=function(data){"string"==typeof data&&(scheduler._temp=eval("("+data+")"),data=scheduler._temp?scheduler._temp.data||scheduler._temp.d||scheduler._temp:[]),data.dhx_security&&(dhtmlx.security_key=data.dhx_security);var collections=scheduler._temp&&scheduler._temp.collections?scheduler._temp.collections:{},collections_loaded=!1;for(var key in collections)if(collections.hasOwnProperty(key)){collections_loaded=!0;var collection=collections[key],arr=scheduler.serverList[key];if(!arr)continue;arr.splice(0,arr.length);for(var j=0;j<collection.length;j++){var option=collection[j],obj={key:option.value,label:option.label};for(var option_key in option)if(option.hasOwnProperty(option_key)){if("value"==option_key||"label"==option_key)continue;obj[option_key]=option[option_key]}arr.push(obj)}}collections_loaded&&scheduler.callEvent("onOptionsLoad",[]);for(var evs=[],i=0;i<data.length;i++){var event=data[i];scheduler._init_event(event),evs.push(event)}return evs},scheduler.parse=function(data,type){this._process=type,this.on_load({xmlDoc:{responseText:data}})},scheduler.load=function(url,call){"string"==typeof call&&(this._process=call,call=arguments[2]),this._load_url=url,this._after_call=call,this._load(url,this._date)},scheduler.setLoadMode=function(mode){"all"==mode&&(mode=""),this._load_mode=mode},scheduler.serverList=function(name,array){return array?(this.serverList[name]=array.slice(0),this.serverList[name]):(this.serverList[name]=this.serverList[name]||[],this.serverList[name])},scheduler._userdata={},scheduler._magic_parser=function(loader){var xml;if(!loader.getXMLTopNode){var xml_string=loader.xmlDoc.responseText;loader=new dtmlXMLLoaderObject(function(){}),loader.loadXMLString(xml_string)}if(xml=loader.getXMLTopNode("data"),"data"!=xml.tagName)return null;var skey=xml.getAttribute("dhx_security");skey&&(dhtmlx.security_key=skey);for(var opts=loader.doXPath("//coll_options"),i=0;i<opts.length;i++){var bind=opts[i].getAttribute("for"),arr=this.serverList[bind];if(arr){arr.splice(0,arr.length);for(var itms=loader.doXPath(".//item",opts[i]),j=0;j<itms.length;j++){for(var itm=itms[j],attrs=itm.attributes,obj={key:itms[j].getAttribute("value"),label:itms[j].getAttribute("label")},k=0;k<attrs.length;k++){var attr=attrs[k];"value"!=attr.nodeName&&"label"!=attr.nodeName&&(obj[attr.nodeName]=attr.nodeValue)}arr.push(obj)}}}opts.length&&scheduler.callEvent("onOptionsLoad",[]);for(var ud=loader.doXPath("//userdata"),i=0;i<ud.length;i++){var udx=this._xmlNodeToJSON(ud[i]);this._userdata[udx.name]=udx.text}var evs=[];xml=loader.doXPath("//event");for(var i=0;i<xml.length;i++){var ev=evs[i]=this._xmlNodeToJSON(xml[i]);scheduler._init_event(ev)}return evs},scheduler._xmlNodeToJSON=function(node){for(var t={},i=0;i<node.attributes.length;i++)t[node.attributes[i].name]=node.attributes[i].value;for(var i=0;i<node.childNodes.length;i++){var child=node.childNodes[i];1==child.nodeType&&(t[child.tagName]=child.firstChild?child.firstChild.nodeValue:"")}return t.text||(t.text=node.firstChild?node.firstChild.nodeValue:""),t},scheduler.attachEvent("onXLS",function(){if(this.config.show_loading===!0){var t;t=this.config.show_loading=document.createElement("DIV"),t.className="dhx_loading",t.style.left=Math.round((this._x-128)/2)+"px",t.style.top=Math.round((this._y-15)/2)+"px",this._obj.appendChild(t)}}),scheduler.attachEvent("onXLE",function(){var t=this.config.show_loading;t&&"object"==typeof t&&(this._obj.removeChild(t),this.config.show_loading=!0)}),scheduler.ical={parse:function(str){var data=str.match(RegExp(this.c_start+"[^\f]*"+this.c_end,""));if(data.length){data[0]=data[0].replace(/[\r\n]+(?=[a-z \t])/g," "),data[0]=data[0].replace(/\;[^:\r\n]*:/g,":");for(var match,incoming=[],event_r=RegExp("(?:"+this.e_start+")([^\f]*?)(?:"+this.e_end+")","g");null!==(match=event_r.exec(data));){for(var param,e={},param_r=/[^\r\n]+[\r\n]+/g;null!==(param=param_r.exec(match[1]));)this.parse_param(param.toString(),e);e.uid&&!e.id&&(e.id=e.uid),incoming.push(e)}return incoming}},parse_param:function(str,obj){var d=str.indexOf(":");if(-1!=d){var name=str.substr(0,d).toLowerCase(),value=str.substr(d+1).replace(/\\\,/g,",").replace(/[\r\n]+$/,"");"summary"==name?name="text":"dtstart"==name?(name="start_date",value=this.parse_date(value,0,0)):"dtend"==name&&(name="end_date",value=this.parse_date(value,0,0)),obj[name]=value}},parse_date:function(value,dh,dm){var t=value.split("T");t[1]&&(dh=t[1].substr(0,2),dm=t[1].substr(2,2));var dy=t[0].substr(0,4),dn=parseInt(t[0].substr(4,2),10)-1,dd=t[0].substr(6,2);return scheduler.config.server_utc&&!t[1]?new Date(Date.UTC(dy,dn,dd,dh,dm)):new Date(dy,dn,dd,dh,dm)},c_start:"BEGIN:VCALENDAR",e_start:"BEGIN:VEVENT",e_end:"END:VEVENT",c_end:"END:VCALENDAR"},scheduler._lightbox_controls={},scheduler.formSection=function(name){var config=this.config.lightbox.sections,i=0;for(i;i<config.length&&config[i].name!=name;i++);var section=config[i];scheduler._lightbox||scheduler.getLightbox();var header=document.getElementById(section.id),node=header.nextSibling,result={section:section,header:header,node:node,getValue:function(ev){return scheduler.form_blocks[section.type].get_value(node,ev||{},section)},setValue:function(value,ev){return scheduler.form_blocks[section.type].set_value(node,value,ev||{},section)}},handler=scheduler._lightbox_controls["get_"+section.type+"_control"];return handler?handler(result):result},scheduler._lightbox_controls.get_template_control=function(result){return result.control=result.node,result},scheduler._lightbox_controls.get_select_control=function(result){return result.control=result.node.getElementsByTagName("select")[0],result},scheduler._lightbox_controls.get_textarea_control=function(result){return result.control=result.node.getElementsByTagName("textarea")[0],result},scheduler._lightbox_controls.get_time_control=function(result){return result.control=result.node.getElementsByTagName("select"),result},scheduler.form_blocks={template:{render:function(sns){var height=(sns.height||"30")+"px";return"<div class='dhx_cal_ltext dhx_cal_template' style='height:"+height+";'></div>"},set_value:function(node,value,ev,config){node.innerHTML=value||""},get_value:function(node,ev,config){return node.innerHTML||""},focus:function(node){}},textarea:{render:function(sns){var height=(sns.height||"130")+"px";return"<div class='dhx_cal_ltext' style='height:"+height+";'><textarea></textarea></div>"},set_value:function(node,value,ev){node.firstChild.value=value||""},get_value:function(node,ev){return node.firstChild.value},focus:function(node){var a=node.firstChild;scheduler._focus(a,!0)}},select:{render:function(sns){for(var height=(sns.height||"23")+"px",html="<div class='dhx_cal_ltext' style='height:"+height+";'><select style='width:100%;'>",i=0;i<sns.options.length;i++)html+="<option value='"+sns.options[i].key+"'>"+sns.options[i].label+"</option>";return html+="</select></div>"},set_value:function(node,value,ev,sns){var select=node.firstChild;!select._dhx_onchange&&sns.onchange&&(select.onchange=sns.onchange,select._dhx_onchange=!0),"undefined"==typeof value&&(value=(select.options[0]||{}).value),select.value=value||""},get_value:function(node,ev){return node.firstChild.value},focus:function(node){var a=node.firstChild;scheduler._focus(a,!0)}},time:{render:function(sns){sns.time_format||(sns.time_format=["%H:%i","%d","%m","%Y"]),sns._time_format_order={};var time_format=sns.time_format,cfg=scheduler.config,dt=this.date.date_part(scheduler._currentDate()),last=1440,first=0;scheduler.config.limit_time_select&&(last=60*cfg.last_hour+1,first=60*cfg.first_hour,dt.setHours(cfg.first_hour));for(var html="",p=0;p<time_format.length;p++){var time_option=time_format[p];switch(p>0&&(html+=" "),time_option){case"%Y":sns._time_format_order[3]=p,html+="<select>";for(var year=dt.getFullYear()-5,i=0;10>i;i++)html+="<option value='"+(year+i)+"'>"+(year+i)+"</option>";html+="</select> ";break;case"%m":sns._time_format_order[2]=p,html+="<select>";for(var i=0;12>i;i++)html+="<option value='"+i+"'>"+this.locale.date.month_full[i]+"</option>";html+="</select>";break;case"%d":sns._time_format_order[1]=p,html+="<select>";for(var i=1;32>i;i++)html+="<option value='"+i+"'>"+i+"</option>";html+="</select>";break;case"%H:%i":sns._time_format_order[0]=p,html+="<select>";var i=first,tdate=dt.getDate();for(sns._time_values=[];last>i;){var time=this.templates.time_picker(dt);html+="<option value='"+i+"'>"+time+"</option>",sns._time_values.push(i),dt.setTime(dt.valueOf()+60*this.config.time_step*1e3);var diff=dt.getDate()!=tdate?1:0;i=24*diff*60+60*dt.getHours()+dt.getMinutes()}html+="</select>"}}return"<div style='height:30px;padding-top:0px;font-size:inherit;' class='dhx_section_time'>"+html+"<span style='font-weight:normal; font-size:10pt;'> &nbsp;&ndash;&nbsp; </span>"+html+"</div>"},set_value:function(node,value,ev,config){function _fill_lightbox_select(s,i,d){for(var time_values=config._time_values,direct_value=60*d.getHours()+d.getMinutes(),fixed_value=direct_value,value_found=!1,k=0;k<time_values.length;k++){var t_v=time_values[k];if(t_v===direct_value){value_found=!0;break}direct_value>t_v&&(fixed_value=t_v)}s[i+map[0]].value=value_found?direct_value:fixed_value,value_found||fixed_value||(s[i+map[0]].selectedIndex=-1),s[i+map[1]].value=d.getDate(),s[i+map[2]].value=d.getMonth(),s[i+map[3]].value=d.getFullYear()}var start_date,end_date,cfg=scheduler.config,s=node.getElementsByTagName("select"),map=config._time_format_order;if(cfg.full_day){if(!node._full_day){var html="<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> "+scheduler.locale.labels.full_day+"&nbsp;</label></input>";scheduler.config.wide_form||(html=node.previousSibling.innerHTML+html),node.previousSibling.innerHTML=html,node._full_day=!0}var input=node.previousSibling.getElementsByTagName("input")[0];input.checked=0===scheduler.date.time_part(ev.start_date)&&0===scheduler.date.time_part(ev.end_date),s[map[0]].disabled=input.checked,s[map[0]+s.length/2].disabled=input.checked,input.onclick=function(){if(input.checked){var obj={};scheduler.form_blocks.time.get_value(node,obj,config),start_date=scheduler.date.date_part(obj.start_date),end_date=scheduler.date.date_part(obj.end_date),(+end_date==+start_date||+end_date>=+start_date&&(0!==ev.end_date.getHours()||0!==ev.end_date.getMinutes()))&&(end_date=scheduler.date.add(end_date,1,"day"))}else start_date=null,end_date=null;s[map[0]].disabled=input.checked,s[map[0]+s.length/2].disabled=input.checked,_fill_lightbox_select(s,0,start_date||ev.start_date),_fill_lightbox_select(s,4,end_date||ev.end_date)}}if(cfg.auto_end_date&&cfg.event_duration)for(var _update_lightbox_select=function(){start_date=new Date(s[map[3]].value,s[map[2]].value,s[map[1]].value,0,s[map[0]].value),end_date=new Date(start_date.getTime()+60*scheduler.config.event_duration*1e3),_fill_lightbox_select(s,4,end_date)},i=0;4>i;i++)s[i].onchange=_update_lightbox_select;_fill_lightbox_select(s,0,ev.start_date),_fill_lightbox_select(s,4,ev.end_date)},get_value:function(node,ev,config){var s=node.getElementsByTagName("select"),map=config._time_format_order;if(ev.start_date=new Date(s[map[3]].value,s[map[2]].value,s[map[1]].value,0,s[map[0]].value),ev.end_date=new Date(s[map[3]+4].value,s[map[2]+4].value,s[map[1]+4].value,0,s[map[0]+4].value),!s[map[3]].value||!s[map[3]+4].value){var original=this.getEvent(this._lightbox_id);original&&(ev.start_date=original.start_date,ev.end_date=original.end_date)}return ev.end_date<=ev.start_date&&(ev.end_date=scheduler.date.add(ev.start_date,scheduler.config.time_step,"minute")),{start_date:new Date(ev.start_date),end_date:new Date(ev.end_date)}},focus:function(node){scheduler._focus(node.getElementsByTagName("select")[0])}}},scheduler.showCover=function(box){if(box){box.style.display="block";var scroll_top=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,scroll_left=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft,view_height=window.innerHeight||document.documentElement.clientHeight;scroll_top?box.style.top=Math.round(scroll_top+Math.max((view_height-box.offsetHeight)/2,0))+"px":box.style.top=Math.round(Math.max((view_height-box.offsetHeight)/2,0)+9)+"px",document.documentElement.scrollWidth>document.body.offsetWidth?box.style.left=Math.round(scroll_left+(document.body.offsetWidth-box.offsetWidth)/2)+"px":box.style.left=Math.round((document.body.offsetWidth-box.offsetWidth)/2)+"px"}this.show_cover()},scheduler.showLightbox=function(id){if(id){if(!this.callEvent("onBeforeLightbox",[id]))return void(this._new_event&&(this._new_event=null));var box=this.getLightbox();this.showCover(box),this._fill_lightbox(id,box),this.callEvent("onLightbox",[id])}},scheduler._fill_lightbox=function(id,box){var ev=this.getEvent(id),s=box.getElementsByTagName("span");scheduler.templates.lightbox_header?(s[1].innerHTML="",s[2].innerHTML=scheduler.templates.lightbox_header(ev.start_date,ev.end_date,ev)):(s[1].innerHTML=this.templates.event_header(ev.start_date,ev.end_date,ev),s[2].innerHTML=(this.templates.event_bar_text(ev.start_date,ev.end_date,ev)||"").substr(0,70));for(var sns=this.config.lightbox.sections,i=0;i<sns.length;i++){var current_sns=sns[i],node=document.getElementById(current_sns.id).nextSibling,block=this.form_blocks[current_sns.type],value=void 0!==ev[current_sns.map_to]?ev[current_sns.map_to]:current_sns.default_value;block.set_value.call(this,node,value,ev,current_sns),sns[i].focus&&block.focus.call(this,node)}scheduler._lightbox_id=id},scheduler._lightbox_out=function(ev){for(var sns=this.config.lightbox.sections,i=0;i<sns.length;i++){var node=document.getElementById(sns[i].id);node=node?node.nextSibling:node;var block=this.form_blocks[sns[i].type],res=block.get_value.call(this,node,ev,sns[i]);"auto"!=sns[i].map_to&&(ev[sns[i].map_to]=res)}return ev},scheduler._empty_lightbox=function(data){var id=scheduler._lightbox_id,ev=this.getEvent(id);this.getLightbox();this._lame_copy(ev,data),this.setEvent(ev.id,ev),this._edit_stop_event(ev,!0),this.render_view_data()},scheduler.hide_lightbox=function(id){this.hideCover(this.getLightbox()),this._lightbox_id=null,this.callEvent("onAfterLightbox",[])},scheduler.hideCover=function(box){box&&(box.style.display="none"),this.hide_cover()},scheduler.hide_cover=function(){this._cover&&this._cover.parentNode.removeChild(this._cover),this._cover=null},scheduler.show_cover=function(){if(!this._cover){this._cover=document.createElement("DIV"),this._cover.className="dhx_cal_cover";var _document_height=void 0!==document.height?document.height:document.body.offsetHeight,_scroll_height=document.documentElement?document.documentElement.scrollHeight:0;this._cover.style.height=Math.max(_document_height,_scroll_height)+"px",document.body.appendChild(this._cover)}},scheduler.save_lightbox=function(){var data=this._lightbox_out({},this._lame_copy(this.getEvent(this._lightbox_id)));(!this.checkEvent("onEventSave")||this.callEvent("onEventSave",[this._lightbox_id,data,this._new_event]))&&(this._empty_lightbox(data),this.hide_lightbox())},scheduler.startLightbox=function(id,box){this._lightbox_id=id,this._custom_lightbox=!0,this._temp_lightbox=this._lightbox,this._lightbox=box,this.showCover(box)},scheduler.endLightbox=function(mode,box){this._edit_stop_event(scheduler.getEvent(this._lightbox_id),mode),mode&&scheduler.render_view_data(),this.hideCover(box),this._custom_lightbox&&(this._lightbox=this._temp_lightbox,this._custom_lightbox=!1),this._temp_lightbox=this._lightbox_id=null},scheduler.resetLightbox=function(){scheduler._lightbox&&!scheduler._custom_lightbox&&scheduler._lightbox.parentNode.removeChild(scheduler._lightbox),scheduler._lightbox=null},scheduler.cancel_lightbox=function(){this.callEvent("onEventCancel",[this._lightbox_id,this._new_event]),this.endLightbox(!1),this.hide_lightbox()},scheduler._init_lightbox_events=function(){this.getLightbox().onclick=function(e){var src=e?e.target:event.srcElement;if(src.className||(src=src.previousSibling),src&&src.className)switch(src.className){case"dhx_save_btn":scheduler.save_lightbox();break;case"dhx_delete_btn":var c=scheduler.locale.labels.confirm_deleting;scheduler._dhtmlx_confirm(c,scheduler.locale.labels.title_confirm_deleting,function(){scheduler.deleteEvent(scheduler._lightbox_id),scheduler._new_event=null,scheduler.hide_lightbox()});break;case"dhx_cancel_btn":scheduler.cancel_lightbox();break;default:if(src.getAttribute("dhx_button"))scheduler.callEvent("onLightboxButton",[src.className,src,e]);else{var index,block,sec;-1!=src.className.indexOf("dhx_custom_button")&&(-1!=src.className.indexOf("dhx_custom_button_")?(index=src.parentNode.getAttribute("index"),sec=src.parentNode.parentNode):(index=src.getAttribute("index"),sec=src.parentNode,src=src.firstChild)),index&&(block=scheduler.form_blocks[scheduler.config.lightbox.sections[index].type],block.button_click(index,src,sec,sec.nextSibling))}}},this.getLightbox().onkeydown=function(e){switch((e||event).keyCode){case scheduler.keys.edit_save:if((e||event).shiftKey)return;scheduler.save_lightbox();break;case scheduler.keys.edit_cancel:scheduler.cancel_lightbox()}}},scheduler.setLightboxSize=function(){var d=this._lightbox;if(d){var con=d.childNodes[1];con.style.height="0px",con.style.height=con.scrollHeight+"px",d.style.height=con.scrollHeight+scheduler.xy.lightbox_additional_height+"px",con.style.height=con.scrollHeight+"px"}},scheduler._init_dnd_events=function(){dhtmlxEvent(document.body,"mousemove",scheduler._move_while_dnd),dhtmlxEvent(document.body,"mouseup",scheduler._finish_dnd),scheduler._init_dnd_events=function(){}},scheduler._move_while_dnd=function(e){if(scheduler._dnd_start_lb){document.dhx_unselectable||(document.body.className+=" dhx_unselectable",document.dhx_unselectable=!0);var lb=scheduler.getLightbox(),now=e&&e.target?[e.pageX,e.pageY]:[event.clientX,event.clientY];lb.style.top=scheduler._lb_start[1]+now[1]-scheduler._dnd_start_lb[1]+"px",lb.style.left=scheduler._lb_start[0]+now[0]-scheduler._dnd_start_lb[0]+"px"}},scheduler._ready_to_dnd=function(e){var lb=scheduler.getLightbox();scheduler._lb_start=[parseInt(lb.style.left,10),parseInt(lb.style.top,10)],scheduler._dnd_start_lb=e&&e.target?[e.pageX,e.pageY]:[event.clientX,event.clientY]},scheduler._finish_dnd=function(){scheduler._lb_start&&(scheduler._lb_start=scheduler._dnd_start_lb=!1,document.body.className=document.body.className.replace(" dhx_unselectable",""),document.dhx_unselectable=!1)},scheduler.getLightbox=function(){if(!this._lightbox){var d=document.createElement("DIV");d.className="dhx_cal_light",scheduler.config.wide_form&&(d.className+=" dhx_cal_light_wide"),scheduler.form_blocks.recurring&&(d.className+=" dhx_cal_light_rec"),/msie|MSIE 6/.test(navigator.userAgent)&&(d.className+=" dhx_ie6"),d.style.visibility="hidden";for(var html=this._lightbox_template,buttons=this.config.buttons_left,i=0;i<buttons.length;i++)html+="<div class='dhx_btn_set dhx_left_btn_set "+buttons[i]+"_set'><div dhx_button='1' class='"+buttons[i]+"'></div><div>"+scheduler.locale.labels[buttons[i]]+"</div></div>";buttons=this.config.buttons_right;for(var i=0;i<buttons.length;i++)html+="<div class='dhx_btn_set dhx_right_btn_set "+buttons[i]+"_set' style='float:right;'><div dhx_button='1' class='"+buttons[i]+"'></div><div>"+scheduler.locale.labels[buttons[i]]+"</div></div>";html+="</div>",d.innerHTML=html,scheduler.config.drag_lightbox&&(d.firstChild.onmousedown=scheduler._ready_to_dnd,d.firstChild.onselectstart=function(){return!1},d.firstChild.style.cursor="pointer",scheduler._init_dnd_events()),document.body.insertBefore(d,document.body.firstChild),this._lightbox=d;var sns=this.config.lightbox.sections;html="";for(var i=0;i<sns.length;i++){var block=this.form_blocks[sns[i].type];if(block){sns[i].id="area_"+this.uid();var button="";sns[i].button&&(button="<div class='dhx_custom_button' index='"+i+"'><div class='dhx_custom_button_"+sns[i].button+"'></div><div>"+this.locale.labels["button_"+sns[i].button]+"</div></div>"),this.config.wide_form&&(html+="<div class='dhx_wrap_section'>");var label_name=this.locale.labels["section_"+sns[i].name];"string"!=typeof label_name&&(label_name=sns[i].name),html+="<div id='"+sns[i].id+"' class='dhx_cal_lsection'>"+button+label_name+"</div>"+block.render.call(this,sns[i]),html+="</div>"}}for(var ds=d.getElementsByTagName("div"),i=0;i<ds.length;i++){var t_ds=ds[i];if("dhx_cal_larea"==t_ds.className){t_ds.innerHTML=html;break}}this.setLightboxSize(),this._init_lightbox_events(this),d.style.display="none",d.style.visibility="visible"}return this._lightbox},scheduler.attachEvent("onEventIdChange",function(old_id,new_id){this._lightbox_id==old_id&&(this._lightbox_id=new_id)}),scheduler._lightbox_template="<div class='dhx_cal_ltitle'><span class='dhx_mark'>&nbsp;</span><span class='dhx_time'></span><span class='dhx_title'></span></div><div class='dhx_cal_larea'></div>",scheduler._init_touch_events=function(){"force"!=this.config.touch&&(this.config.touch=this.config.touch&&(-1!=navigator.userAgent.indexOf("Mobile")||-1!=navigator.userAgent.indexOf("iPad")||-1!=navigator.userAgent.indexOf("Android")||-1!=navigator.userAgent.indexOf("Touch"))),this.config.touch&&(this.xy.scroll_width=0,window.navigator.msPointerEnabled?(this._touch_events(["MSPointerMove","MSPointerDown","MSPointerUp"],function(ev){return ev.pointerType==ev.MSPOINTER_TYPE_MOUSE?null:ev},function(ev){return!ev||ev.pointerType==ev.MSPOINTER_TYPE_MOUSE}),this._obj.ondblclick=function(){}):this._touch_events(["touchmove","touchstart","touchend"],function(ev){return ev.touches&&ev.touches.length>1?null:ev.touches[0]?{target:ev.target,pageX:ev.touches[0].pageX,pageY:ev.touches[0].pageY}:ev},function(){return!1}))},scheduler._touch_events=function(names,accessor,ignore){function attachTouchEvent(element,name,callback){dhtmlxEvent(element,name,function(e){return scheduler._is_lightbox_open()?!0:callback(e)})}function check_direction_swipe(s_ev,e_ev,step){if(s_ev&&e_ev){var dy=Math.abs(s_ev.pageY-e_ev.pageY),dx=Math.abs(s_ev.pageX-e_ev.pageX);dx>step&&(!dy||dx/dy>3)&&(s_ev.pageX>e_ev.pageX?scheduler._click.dhx_cal_next_button():scheduler._click.dhx_cal_prev_button())}}function doMouseMove(e){var dnd=scheduler.getState().drag_mode,timeline=scheduler.matrix?scheduler.matrix[scheduler._mode]:!1,original_render=scheduler.render_view_data;"create"==dnd&&timeline&&(scheduler.render_view_data=function(){for(var id=scheduler.getState().drag_id,ev=scheduler.getEvent(id),property=timeline.y_property,evs=scheduler.getEvents(ev.start_date,ev.end_date),i=0;i<evs.length;i++)evs[i][property]!=ev[property]&&(evs.splice(i,1),i--);ev._sorder=evs.length-1,ev._count=evs.length,this.render_data([ev],scheduler.getState().mode)}),scheduler._on_mouse_move(e),"create"==dnd&&timeline&&(scheduler.render_view_data=original_render)}function drag_cancel(e){scheduler._hide_global_tip(),drag_mode&&(scheduler._on_mouse_up(accessor(e||event)),scheduler._temp_touch_block=!1),scheduler._drag_id=null,scheduler._drag_mode=null,scheduler._drag_pos=null,clearTimeout(timer),drag_mode=action_mode=!1,scroll_mode=!0}var source,tracker,timer,drag_mode,scroll_mode,action_mode,a_webkit=-1!=navigator.userAgent.indexOf("Android")&&-1!=navigator.userAgent.indexOf("WebKit"),dblclicktime=0;attachTouchEvent(document.body,names[0],function(e){if(!ignore(e)){if(drag_mode)return doMouseMove(accessor(e)),scheduler._update_global_tip(),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,!1;if(tracker&&a_webkit&&check_direction_swipe(tracker,accessor(e),0),tracker=accessor(e),action_mode)return tracker?void((source.target!=tracker.target||Math.abs(source.pageX-tracker.pageX)>5||Math.abs(source.pageY-tracker.pageY)>5)&&(scroll_mode=!0,clearTimeout(timer))):void(scroll_mode=!0)}}),attachTouchEvent(this._els.dhx_cal_data[0],"scroll",drag_cancel),attachTouchEvent(this._els.dhx_cal_data[0],"touchcancel",drag_cancel),attachTouchEvent(this._els.dhx_cal_data[0],"contextmenu",function(e){return action_mode?(e&&e.preventDefault&&e.preventDefault(),(e||event).cancelBubble=!0,!1):void 0}),attachTouchEvent(this._els.dhx_cal_data[0],names[1],function(e){if(!ignore(e)){var fake_event;if(drag_mode=scroll_mode=!1,action_mode=!0,scheduler._temp_touch_block=!0,fake_event=tracker=accessor(e),!fake_event)return void(scroll_mode=!0);var now=new Date;if(!scroll_mode&&!drag_mode&&250>now-dblclicktime)return scheduler._click.dhx_cal_data(fake_event),window.setTimeout(function(){scheduler._on_dbl_click(fake_event)},50),e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,scheduler._block_next_stop=!0,!1;dblclicktime=now,scroll_mode||drag_mode||!scheduler.config.touch_drag||(timer=setTimeout(function(){drag_mode=!0;var target=source.target;if(target&&target.className&&-1!=target.className.indexOf("dhx_body")&&(target=target.previousSibling),scheduler._on_mouse_down(source,target),scheduler._drag_mode&&"create"!=scheduler._drag_mode){var pos=-1;if(scheduler.for_rendered(scheduler._drag_id,function(node,i){pos=node.getBoundingClientRect().top,node.style.display="none",scheduler._rendered.splice(i,1)}),pos>=0){var step=scheduler.config.time_step;scheduler._move_pos_shift=step*Math.round(60*(fake_event.pageY-pos)/(scheduler.config.hour_size_px*step))}}scheduler.config.touch_tip&&scheduler._show_global_tip(),scheduler._on_mouse_move(source)},scheduler.config.touch_drag),source=fake_event)}}),attachTouchEvent(this._els.dhx_cal_data[0],names[2],function(e){return ignore(e)?void 0:(drag_mode||check_direction_swipe(source,tracker,200),drag_mode&&(scheduler._ignore_next_click=!0),drag_cancel(e),scheduler._block_next_stop?(scheduler._block_next_stop=!1,e.preventDefault&&e.preventDefault(),e.cancelBubble=!0,!1):void 0)}),dhtmlxEvent(document.body,names[2],drag_cancel)},scheduler._show_global_tip=function(){scheduler._hide_global_tip();var toptip=scheduler._global_tip=document.createElement("DIV");toptip.className="dhx_global_tip",scheduler._update_global_tip(1),document.body.appendChild(toptip)},scheduler._update_global_tip=function(init){var toptip=scheduler._global_tip;if(toptip){var time="";if(scheduler._drag_id&&!init){var ev=scheduler.getEvent(scheduler._drag_id);ev&&(time="<div>"+(ev._timed?scheduler.templates.event_header(ev.start_date,ev.end_date,ev):scheduler.templates.day_date(ev.start_date,ev.end_date,ev))+"</div>")}"create"==scheduler._drag_mode||"new-size"==scheduler._drag_mode?toptip.innerHTML=(scheduler.locale.drag_to_create||"Drag to create")+time:toptip.innerHTML=(scheduler.locale.drag_to_move||"Drag to move")+time}},scheduler._hide_global_tip=function(){var toptip=scheduler._global_tip;toptip&&toptip.parentNode&&(toptip.parentNode.removeChild(toptip),scheduler._global_tip=0)},scheduler._dp_init=function(dp){dp._methods=["_set_event_text_style","","changeEventId","_dp_hook_delete"],this._dp_hook_delete=function(id){return this.deleteEvent(id,!0)},this.attachEvent("onEventAdded",function(id){!this._loading&&this._validId(id)&&dp.setUpdated(id,!0,"inserted")}),this.attachEvent("onConfirmedBeforeEventDelete",function(id){if(this._validId(id)){var z=dp.getState(id);return"inserted"==z||this._new_event?(dp.setUpdated(id,!1),!0):"deleted"==z?!1:"true_deleted"==z?!0:(dp.setUpdated(id,!0,"deleted"),!1)}}),this.attachEvent("onEventChanged",function(id){!this._loading&&this._validId(id)&&dp.setUpdated(id,!0,"updated")}),dp._getRowData=function(id,pref){var ev=this.obj.getEvent(id),data={};for(var a in ev)0!==a.indexOf("_")&&(ev[a]&&ev[a].getUTCFullYear?data[a]=this.obj.templates.xml_format(ev[a]):data[a]=ev[a]);return data},dp._clearUpdateFlag=function(){},dp.attachEvent("insertCallback",scheduler._update_callback),dp.attachEvent("updateCallback",scheduler._update_callback),dp.attachEvent("deleteCallback",function(upd,id){this.obj.setUserData(id,this.action_param,"true_deleted"),this.obj.deleteEvent(id)})},scheduler._validId=function(id){return!0},scheduler.setUserData=function(id,name,value){id?this.getEvent(id)[name]=value:this._userdata[name]=value},scheduler.getUserData=function(id,name){return id?this.getEvent(id)[name]:this._userdata[name]},scheduler._set_event_text_style=function(id,style){this.for_rendered(id,function(r){r.style.cssText+=";"+style});var ev=this.getEvent(id);ev._text_style=style,this.event_updated(ev)},scheduler._update_callback=function(upd,id){var data=scheduler._xmlNodeToJSON(upd.firstChild);data.text=data.text||data._tagvalue,data.start_date=scheduler.templates.xml_date(data.start_date),data.end_date=scheduler.templates.xml_date(data.end_date),scheduler.addEvent(data)},scheduler._skin_settings={fix_tab_position:[1,0],use_select_menu_space:[1,0],wide_form:[1,0],hour_size_px:[44,42],displayed_event_color:["#ff4a4a","ffc5ab"],displayed_event_text_color:["#ffef80","7e2727"]},scheduler._skin_xy={lightbox_additional_height:[90,50],nav_height:[59,22],bar_height:[24,20]},scheduler._configure=function(col,data,skin){for(var key in data)"undefined"==typeof col[key]&&(col[key]=data[key][skin])},scheduler._skin_init=function(){if(!scheduler.skin)for(var links=document.getElementsByTagName("link"),i=0;i<links.length;i++){var res=links[i].href.match("dhtmlxscheduler_([a-z]+).css");if(res){scheduler.skin=res[1];break}}var set=0;if(!scheduler.skin||"classic"!==scheduler.skin&&"glossy"!==scheduler.skin||(set=1),this._configure(scheduler.config,scheduler._skin_settings,set),this._configure(scheduler.xy,scheduler._skin_xy,set),"flat"===scheduler.skin&&(scheduler.xy.scale_height=35,scheduler.templates.hour_scale=function(date){var min=date.getMinutes();min=10>min?"0"+min:min;var html="<span class='dhx_scale_h'>"+date.getHours()+"</span><span class='dhx_scale_m'>&nbsp;"+min+"</span>";return html}),!set){var minic=scheduler.config.minicalendar;minic&&(minic.padding=14),scheduler.templates.event_bar_date=function(start,end,ev){return"• <b>"+scheduler.templates.event_date(start)+"</b> "},scheduler.attachEvent("onTemplatesReady",function(){var date_to_str=scheduler.date.date_to_str("%d");scheduler.templates._old_month_day||(scheduler.templates._old_month_day=scheduler.templates.month_day);var old_month_day=scheduler.templates._old_month_day;if(scheduler.templates.month_day=function(date){if("month"==this._mode){var label=date_to_str(date);return 1==date.getDate()&&(label=scheduler.locale.date.month_full[date.getMonth()]+" "+label),+date==+scheduler.date.date_part(new Date)&&(label=scheduler.locale.labels.dhx_cal_today_button+" "+label),label}return old_month_day.call(this,date)},scheduler.config.fix_tab_position){for(var navline_divs=scheduler._els.dhx_cal_navline[0].getElementsByTagName("div"),minical=null,last=211,i=0;i<navline_divs.length;i++){var div=navline_divs[i],name=div.getAttribute("name");if(name)switch(div.style.right="auto",name){case"day_tab":div.style.left="14px",div.className+=" dhx_cal_tab_first";break;case"week_tab":div.style.left="75px";break;case"month_tab":div.style.left="136px",div.className+=" dhx_cal_tab_last";break;default:div.style.left=last+"px",div.className+=" dhx_cal_tab_standalone",last=last+14+div.offsetWidth}else 0===(div.className||"").indexOf("dhx_minical_icon")&&div.parentNode==scheduler._els.dhx_cal_navline[0]&&(minical=div)}minical&&(minical.style.left=last+"px");
}}),scheduler._skin_init=function(){}}},window.jQuery&&!function($){var methods=[];$.fn.dhx_scheduler=function(config){if("string"!=typeof config){var views=[];return this.each(function(){if(this&&this.getAttribute&&!this.getAttribute("dhxscheduler")){for(var key in config)"data"!=key&&(scheduler.config[key]=config[key]);this.getElementsByTagName("div").length||(this.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;</div><div class="dhx_cal_next_button">&nbsp;</div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div><div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div></div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div>',this.className+=" dhx_cal_container"),scheduler.init(this,scheduler.config.date,scheduler.config.mode),config.data&&scheduler.parse(config.data),views.push(scheduler)}}),1===views.length?views[0]:views}return methods[config]?methods[config].apply(this,[]):void $.error("Method "+config+" does not exist on jQuery.dhx_scheduler")}}(jQuery),function(){function updateFlags(scheduler,date,mode){date&&(scheduler._date=date),mode&&(scheduler._mode=mode)}var setCurrentView=scheduler.setCurrentView,updateView=scheduler.updateView,update_view_timer=null,curr_view_timer=null,lazy_setCurrentView=function(date,mode){var self=this;window.clearTimeout(curr_view_timer),window.clearTimeout(update_view_timer),updateFlags(this,date,mode),curr_view_timer=setTimeout(function(){self.callEvent("onBeforeViewChange",[self._mode,self._date,mode||self._mode,date||self._date])&&(updateView.call(self,date,mode),self.callEvent("onViewChange",[self._mode,self._date]),window.clearTimeout(update_view_timer),curr_view_timer=0)},scheduler.config.delay_render)},lazy_updateView=function(date,mode){var self=this,ars=arguments;updateFlags(this,date,mode),window.clearTimeout(update_view_timer),update_view_timer=setTimeout(function(){curr_view_timer||updateView.apply(self,ars)},scheduler.config.delay_render)};scheduler.attachEvent("onSchedulerReady",function(){scheduler.config.delay_render?(scheduler.setCurrentView=lazy_setCurrentView,scheduler.updateView=lazy_updateView):(scheduler.setCurrentView=setCurrentView,scheduler.updateView=updateView)})}(),window.dhtmlXTooltip=scheduler.dhtmlXTooltip=window.dhtmlxTooltip={},dhtmlXTooltip.config={className:"dhtmlXTooltip tooltip",timeout_to_display:50,timeout_to_hide:50,delta_x:15,delta_y:-20},dhtmlXTooltip.tooltip=document.createElement("div"),dhtmlXTooltip.tooltip.className=dhtmlXTooltip.config.className,dhtmlXTooltip.show=function(e,t){if(!scheduler.config.touch||scheduler.config.touch_tooltip){var r=dhtmlXTooltip,s=this.tooltip,a=s.style;r.tooltip.className=r.config.className;var n=this.position(e),i=e.target||e.srcElement;if(!this.isTooltip(i)){var d=n.x+(r.config.delta_x||0),l=n.y-(r.config.delta_y||0);a.visibility="hidden",a.removeAttribute?(a.removeAttribute("right"),a.removeAttribute("bottom")):(a.removeProperty("right"),a.removeProperty("bottom")),a.left="0",a.top="0",this.tooltip.innerHTML=t,document.body.appendChild(this.tooltip);var _=this.tooltip.offsetWidth,o=this.tooltip.offsetHeight;document.body.offsetWidth-d-_<0?(a.removeAttribute?a.removeAttribute("left"):a.removeProperty("left"),a.right=document.body.offsetWidth-d+2*(r.config.delta_x||0)+"px"):a.left=0>d?n.x+Math.abs(r.config.delta_x||0)+"px":d+"px",document.body.offsetHeight-l-o<0?(a.removeAttribute?a.removeAttribute("top"):a.removeProperty("top"),a.bottom=document.body.offsetHeight-l-2*(r.config.delta_y||0)+"px"):a.top=0>l?n.y+Math.abs(r.config.delta_y||0)+"px":l+"px",a.visibility="visible",this.tooltip.onmouseleave=function(e){e=e||window.event;for(var t=scheduler.dhtmlXTooltip,r=e.relatedTarget;r!=scheduler._obj&&r;)r=r.parentNode;r!=scheduler._obj&&t.delay(t.hide,t,[],t.config.timeout_to_hide)},scheduler.callEvent("onTooltipDisplayed",[this.tooltip,this.tooltip.event_id])}}},dhtmlXTooltip._clearTimeout=function(){this.tooltip._timeout_id&&window.clearTimeout(this.tooltip._timeout_id)},dhtmlXTooltip.hide=function(){if(this.tooltip.parentNode){var e=this.tooltip.event_id;this.tooltip.event_id=null,this.tooltip.onmouseleave=null,this.tooltip.parentNode.removeChild(this.tooltip),scheduler.callEvent("onAfterTooltip",[e])}this._clearTimeout()},dhtmlXTooltip.delay=function(e,t,r,s){this._clearTimeout(),this.tooltip._timeout_id=setTimeout(function(){var s=e.apply(t,r);return e=t=r=null,s},s||this.config.timeout_to_display)},dhtmlXTooltip.isTooltip=function(e){var t=!1;for("dhtmlXTooltip"==e.className.split(" ")[0];e&&!t;)t=e.className==this.tooltip.className,e=e.parentNode;return t},dhtmlXTooltip.position=function(e){if(e=e||window.event,e.pageX||e.pageY)return{x:e.pageX,y:e.pageY};var t=window._isIE&&"BackCompat"!=document.compatMode?document.documentElement:document.body;return{x:e.clientX+t.scrollLeft-t.clientLeft,y:e.clientY+t.scrollTop-t.clientTop}},scheduler.attachEvent("onMouseMove",function(e,t){var r=window.event||t,s=r.target||r.srcElement,a=dhtmlXTooltip,n=a.isTooltip(s),i=a.isTooltipTarget&&a.isTooltipTarget(s);if(e||n||i){var d;if(e||a.tooltip.event_id){var l=scheduler.getEvent(e)||scheduler.getEvent(a.tooltip.event_id);if(!l)return;if(a.tooltip.event_id=l.id,d=scheduler.templates.tooltip_text(l.start_date,l.end_date,l),!d)return a.hide()}i&&(d="");var _;if(_isIE){_={pageX:void 0,pageY:void 0,clientX:void 0,clientY:void 0,target:void 0,srcElement:void 0};for(var o in _)_[o]=r[o]}if(!scheduler.callEvent("onBeforeTooltip",[e])||!d)return;a.delay(a.show,a,[_||r,d])}else a.delay(a.hide,a,[],a.config.timeout_to_hide)}),scheduler.attachEvent("onBeforeDrag",function(){return dhtmlXTooltip.hide(),!0}),scheduler.attachEvent("onEventDeleted",function(){return dhtmlXTooltip.hide(),!0}),scheduler.templates.tooltip_date_format=scheduler.date.date_to_str("%Y-%m-%d %H:%i"),scheduler.templates.tooltip_text=function(e,t,r){return"<b>Event:</b> "+r.text+"<br/><b>Start date:</b> "+scheduler.templates.tooltip_date_format(e)+"<br/><b>End date:</b> "+scheduler.templates.tooltip_date_format(t)},scheduler.config.year_x=4,scheduler.config.year_y=3,scheduler.xy.year_top=0,scheduler.templates.year_date=function(e){return scheduler.date.date_to_str(scheduler.locale.labels.year_tab+" %Y")(e)},scheduler.templates.year_month=scheduler.date.date_to_str("%F"),scheduler.templates.year_scale_date=scheduler.date.date_to_str("%D"),scheduler.templates.year_tooltip=function(e,t,r){return r.text},function(){var e=function(){return"year"==scheduler._mode};scheduler.dblclick_dhx_month_head=function(t){if(e()){var r=t.target||t.srcElement;if(-1!=r.parentNode.className.indexOf("dhx_before")||-1!=r.parentNode.className.indexOf("dhx_after"))return!1;var s=this.templates.xml_date(r.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("date"));s.setDate(parseInt(r.innerHTML,10));var a=this.date.add(s,1,"day");!this.config.readonly&&this.config.dblclick_create&&this.addEventNow(s.valueOf(),a.valueOf(),t)}};var t=scheduler.changeEventId;scheduler.changeEventId=function(){t.apply(this,arguments),e()&&this.year_view(!0)};var r=scheduler.render_data,s=scheduler.date.date_to_str("%Y/%m/%d"),a=scheduler.date.str_to_date("%Y/%m/%d");scheduler.render_data=function(t){if(!e())return r.apply(this,arguments);for(var s=0;s<t.length;s++)this._year_render_event(t[s])};var d=scheduler.clear_view;scheduler.clear_view=function(){if(!e())return d.apply(this,arguments);var t=scheduler._year_marked_cells,r=null;for(var s in t)t.hasOwnProperty(s)&&(r=t[s],r.className="dhx_month_head",r.setAttribute("date",""));scheduler._year_marked_cells={}},scheduler._hideToolTip=function(){this._tooltip&&(this._tooltip.style.display="none",this._tooltip.date=new Date(9999,1,1))},scheduler._showToolTip=function(e,t,r,s){if(this._tooltip){if(this._tooltip.date.valueOf()==e.valueOf())return;this._tooltip.innerHTML=""}else{var a=this._tooltip=document.createElement("DIV");a.className="dhx_year_tooltip",document.body.appendChild(a),a.onclick=scheduler._click.dhx_cal_data}for(var d=this.getEvents(e,this.date.add(e,1,"day")),n="",i=0;i<d.length;i++){var l=d[i];if(this.filter_event(l.id,l)){var _=l.color?"background:"+l.color+";":"",o=l.textColor?"color:"+l.textColor+";":"";n+="<div class='dhx_tooltip_line' style='"+_+o+"' event_id='"+d[i].id+"'>",n+="<div class='dhx_tooltip_date' style='"+_+o+"'>"+(d[i]._timed?this.templates.event_date(d[i].start_date):"")+"</div>",n+="<div class='dhx_event_icon icon_details'>&nbsp;</div>",n+=this.templates.year_tooltip(d[i].start_date,d[i].end_date,d[i])+"</div>"}}this._tooltip.style.display="",this._tooltip.style.top="0px",this._tooltip.style.left=document.body.offsetWidth-t.left-this._tooltip.offsetWidth<0?t.left-this._tooltip.offsetWidth+"px":t.left+s.offsetWidth+"px",this._tooltip.date=e,this._tooltip.innerHTML=n,this._tooltip.style.top=document.body.offsetHeight-t.top-this._tooltip.offsetHeight<0?t.top-this._tooltip.offsetHeight+s.offsetHeight+"px":t.top+"px"},scheduler._year_view_tooltip_handler=function(t){if(e()){var t=t||event,r=t.target||t.srcElement;"a"==r.tagName.toLowerCase()&&(r=r.parentNode),-1!=(r.className||"").indexOf("dhx_year_event")?scheduler._showToolTip(a(r.getAttribute("date")),getOffset(r),t,r):scheduler._hideToolTip()}},scheduler._init_year_tooltip=function(){scheduler._detachDomEvent(scheduler._els.dhx_cal_data[0],"mouseover",scheduler._year_view_tooltip_handler),dhtmlxEvent(scheduler._els.dhx_cal_data[0],"mouseover",scheduler._year_view_tooltip_handler)},scheduler.attachEvent("onSchedulerResize",function(){return e()?(this.year_view(!0),!1):!0}),scheduler._get_year_cell=function(e){var t=e.getMonth()+12*(e.getFullYear()-this._min_date.getFullYear())-this.week_starts._month,r=this._els.dhx_cal_data[0].childNodes[t],e=this.week_starts[t]+e.getDate()-1;return r.childNodes[2].firstChild.rows[Math.floor(e/7)].cells[e%7].firstChild},scheduler._year_marked_cells={},scheduler._mark_year_date=function(e,t){var r=s(e),a=this._get_year_cell(e),d=this.templates.event_class(t.start_date,t.end_date,t);scheduler._year_marked_cells[r]||(a.className="dhx_month_head dhx_year_event",a.setAttribute("date",r),scheduler._year_marked_cells[r]=a),a.className+=d?" "+d:""},scheduler._unmark_year_date=function(e){this._get_year_cell(e).className="dhx_month_head"},scheduler._year_render_event=function(e){var t=e.start_date;for(t=t.valueOf()<this._min_date.valueOf()?this._min_date:this.date.date_part(new Date(t));t<e.end_date;)if(this._mark_year_date(t,e),t=this.date.add(t,1,"day"),t.valueOf()>=this._max_date.valueOf())return},scheduler.year_view=function(e){var t;if(e&&(t=scheduler.xy.scale_height,scheduler.xy.scale_height=-1),scheduler._els.dhx_cal_header[0].style.display=e?"none":"",scheduler.set_sizes(),e&&(scheduler.xy.scale_height=t),scheduler._table_view=e,!this._load_mode||!this._load())if(e){if(scheduler._init_year_tooltip(),scheduler._reset_year_scale(),scheduler._load_mode&&scheduler._load())return void(scheduler._render_wait=!0);scheduler.render_view_data()}else scheduler._hideToolTip()},scheduler._reset_year_scale=function(){this._cols=[],this._colsS={};var e=[],t=this._els.dhx_cal_data[0],r=this.config;t.scrollTop=0,t.innerHTML="";var s=Math.floor(parseInt(t.style.width)/r.year_x),a=Math.floor((parseInt(t.style.height)-scheduler.xy.year_top)/r.year_y);190>a&&(a=190,s=Math.floor((parseInt(t.style.width)-scheduler.xy.scroll_width)/r.year_x));for(var d=s-11,n=0,i=document.createElement("div"),l=this.date.week_start(scheduler._currentDate()),_=0;7>_;_++)this._cols[_]=Math.floor(d/(7-_)),this._render_x_header(_,n,l,i),l=this.date.add(l,1,"day"),d-=this._cols[_],n+=this._cols[_];i.lastChild.className+=" dhx_scale_bar_last";for(var o=this.date[this._mode+"_start"](this.date.copy(this._date)),c=o,h=null,_=0;_<r.year_y;_++)for(var u=0;u<r.year_x;u++){h=document.createElement("DIV"),h.style.cssText="position:absolute;",h.setAttribute("date",this.templates.xml_format(o)),h.innerHTML="<div class='dhx_year_month'></div><div class='dhx_year_week'>"+i.innerHTML+"</div><div class='dhx_year_body'></div>",h.childNodes[0].innerHTML=this.templates.year_month(o);for(var v=this.date.week_start(o),f=this._reset_month_scale(h.childNodes[2],o,v),p=h.childNodes[2].firstChild.rows,g=p.length;6>g;g++){p[0].parentNode.appendChild(p[0].cloneNode(!0));for(var m=0,y=p[g].childNodes.length;y>m;m++)p[g].childNodes[m].className="dhx_after",p[g].childNodes[m].firstChild.innerHTML=scheduler.templates.month_day(f),f=scheduler.date.add(f,1,"day")}t.appendChild(h),h.childNodes[1].style.height=h.childNodes[1].childNodes[0].offsetHeight+"px";var x=Math.round((a-190)/2);h.style.marginTop=x+"px",this.set_xy(h,s-10,a-x-10,s*u+5,a*_+5+scheduler.xy.year_top),e[_*r.year_x+u]=(o.getDay()-(this.config.start_on_monday?1:0)+7)%7,o=this.date.add(o,1,"month")}this._els.dhx_cal_date[0].innerHTML=this.templates[this._mode+"_date"](c,o,this._mode),this.week_starts=e,e._month=c.getMonth(),this._min_date=c,this._max_date=o};var n=scheduler.getActionData;scheduler.getActionData=function(t){if(!e())return n.apply(scheduler,arguments);var r=t?t.target:event.srcElement,s=scheduler._get_year_month_date(r),a=scheduler._get_year_month_cell(r),d=scheduler._get_year_day_indexes(a);return d&&s?(s=scheduler.date.add(s,d.week,"week"),s=scheduler.date.add(s,d.day,"day")):s=null,{date:s,section:null}},scheduler._get_year_day_indexes=function(e){var t=scheduler._get_year_el_node(e,this._locate_year_month_table);if(!t)return null;for(var r=0,s=0,r=0,a=t.rows.length;a>r;r++){for(var d=t.rows[r].getElementsByTagName("td"),s=0,n=d.length;n>s&&d[s]!=e;s++);if(n>s)break}return a>r?{day:s,week:r}:null},scheduler._get_year_month_date=function(e){var e=scheduler._get_year_el_node(e,scheduler._locate_year_month_root);if(!e)return null;var t=e.getAttribute("date");return t?scheduler.date.week_start(scheduler.templates.xml_date(t)):null},scheduler._locate_year_month_day=function(e){return e.className&&-1!=e.className.indexOf("dhx_year_event")&&e.hasAttribute&&e.hasAttribute("date")};var i=scheduler._locate_event;scheduler._locate_event=function(e){var t=i.apply(scheduler,arguments);if(!t){var r=scheduler._get_year_el_node(e,scheduler._locate_year_month_day);if(!r||!r.hasAttribute("date"))return null;var s=scheduler.templates.xml_date(r.getAttribute("date")),a=scheduler.getEvents(s,scheduler.date.add(s,1,"day"));if(!a.length)return null;t=a[0].id}return t},scheduler._locate_year_month_cell=function(e){return"td"==e.nodeName.toLowerCase()},scheduler._locate_year_month_table=function(e){return"table"==e.nodeName.toLowerCase()},scheduler._locate_year_month_root=function(e){return e.hasAttribute&&e.hasAttribute("date")},scheduler._get_year_month_cell=function(e){return this._get_year_el_node(e,this._locate_year_month_cell)},scheduler._get_year_month_table=function(e){return this._get_year_el_node(e,this._locate_year_month_table)},scheduler._get_year_month_root=function(e){return this._get_year_el_node(this._get_year_month_table(e),this._locate_year_month_root)},scheduler._get_year_el_node=function(e,t){for(;e&&!t(e);)e=e.parentNode;return e}}(),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).cssVars=t()}(this,function(){"use strict";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function t(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){return Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)?Array.from(e):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(e){function s(){return!("<"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().charAt(0))}function a(e,t){r.onError(e,n[t],t)}function c(e,t){var s=r.onSuccess(e,n[t],t);e=!1===s?"":s||e,o[t]=e,-1===o.indexOf(null)&&r.onComplete(o)}var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={mimeType:t.mimeType||null,onBeforeSend:t.onBeforeSend||Function.prototype,onSuccess:t.onSuccess||Function.prototype,onError:t.onError||Function.prototype,onComplete:t.onComplete||Function.prototype},n=Array.isArray(e)?e:[e],o=Array.apply(null,Array(n.length)).map(function(e){return null}),i=document.createElement("a");n.forEach(function(e,t){if(i.setAttribute("href",e),i.href=String(i.href),Boolean(document.all&&!window.atob)&&i.host.split(":")[0]!==location.host.split(":")[0])if(i.protocol===location.protocol){var n=new XDomainRequest;n.open("GET",e),n.timeout=0,n.onprogress=Function.prototype,n.ontimeout=Function.prototype,n.onload=function(){s(n.responseText)?c(n.responseText,t):a(n,t)},n.onerror=function(e){a(n,t)},setTimeout(function(){n.send()},0)}else console.warn("Internet Explorer 9 Cross-Origin (CORS) requests must use the same protocol (".concat(e,")")),a(null,t);else{var o=new XMLHttpRequest;o.open("GET",e),r.mimeType&&o.overrideMimeType&&o.overrideMimeType(r.mimeType),r.onBeforeSend(o,e,t),o.onreadystatechange=function(){4===o.readyState&&(200===o.status&&s(o.responseText)?c(o.responseText,t):a(o,t))},o.send()}})}function n(e){function c(){if(-1===a.indexOf(null)){var e=a.join("");n.onComplete(e,a,s)}}function i(e,t,o,s){var i=n.onSuccess(e,o,s);!function e(t,o,s,a){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],l=u(t,s,i);l.rules.length?r(l.absoluteUrls,{onBeforeSend:function(e,t,r){n.onBeforeSend(e,o,t)},onSuccess:function(e,t,r){var s=n.onSuccess(e,o,t),a=u(e=!1===s?"":s||e,t,i);return a.rules.forEach(function(t,r){e=e.replace(t,a.absoluteRules[r])}),e},onError:function(r,n,u){c.push({xhr:r,url:n}),i.push(l.rules[u]),e(t,o,s,a,c,i)},onComplete:function(r){r.forEach(function(e,r){t=t.replace(l.rules[r],e)}),e(t,o,s,a,c,i)}}):a(t,c)}(e=void 0!==i&&!1===Boolean(i)?"":i||e,o,s,function(e,r){null===a[t]&&(r.forEach(function(e){return n.onError(e.xhr,o,e.url)}),!n.filter||n.filter.test(e)?a[t]=e:a[t]="",c())})}function u(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s={};return s.rules=(e.replace(t.cssComments,"").match(t.cssImports)||[]).filter(function(e){return-1===n.indexOf(e)}),s.urls=s.rules.map(function(e){return e.replace(t.cssImports,"$1")}),s.absoluteUrls=s.urls.map(function(e){return o(e,r)}),s.absoluteRules=s.rules.map(function(e,t){var n=s.urls[t],a=o(s.absoluteUrls[t],r);return e.replace(n,a)}),s}var t={cssComments:/\/\*[\s\S]+?\*\//g,cssImports:/(?:@import\s*)(?:url\(\s*)?(?:['"])([^'"]*)(?:['"])(?:\s*\))?(?:[^;]*;)/g},n={rootElement:e.rootElement||document,include:e.include||'style,link[rel="stylesheet"]',exclude:e.exclude||null,filter:e.filter||null,useCSSOM:e.useCSSOM||!1,onBeforeSend:e.onBeforeSend||Function.prototype,onSuccess:e.onSuccess||Function.prototype,onError:e.onError||Function.prototype,onComplete:e.onComplete||Function.prototype},s=Array.apply(null,n.rootElement.querySelectorAll(n.include)).filter(function(e){return t=e,r=n.exclude,!(t.matches||t.matchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector).call(t,r);var t,r}),a=Array.apply(null,Array(s.length)).map(function(e){return null});s.length?s.forEach(function(e,t){var s=e.getAttribute("href"),u=e.getAttribute("rel"),l="LINK"===e.nodeName&&s&&u&&"stylesheet"===u.toLowerCase(),f="STYLE"===e.nodeName;if(l)r(s,{mimeType:"text/css",onBeforeSend:function(t,r,o){n.onBeforeSend(t,e,r)},onSuccess:function(r,n,a){var c=o(s,location.href);i(r,t,e,c)},onError:function(r,o,s){a[t]="",n.onError(r,e,o),c()}});else if(f){var d=e.textContent;n.useCSSOM&&(d=Array.apply(null,e.sheet.cssRules).map(function(e){return e.cssText}).join("")),i(d,t,e,location.href)}else a[t]="",c()}):n.onComplete("",[])}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.href,r=document.implementation.createHTMLDocument(""),n=r.createElement("base"),o=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(o),n.href=t,o.href=e,o.href}function a(e,t,r){e instanceof RegExp&&(e=c(e,r)),t instanceof RegExp&&(t=c(t,r));var n=i(e,t,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+e.length,n[1]),post:r.slice(n[1]+t.length)}}function c(e,t){var r=t.match(e);return r?r[0]:null}function i(e,t,r){var n,o,s,a,c,i=r.indexOf(e),u=r.indexOf(t,i+1),l=i;if(i>=0&&u>0){for(n=[],s=r.length;l>=0&&!c;)l==i?(n.push(l),i=r.indexOf(e,l+1)):1==n.length?c=[n.pop(),u]:((o=n.pop())<s&&(s=o,a=u),u=r.indexOf(t,l+1)),l=u>i&&i>=0?i:u;n.length&&(c=[s,a])}return c}function u(t){function n(e){throw new Error("CSS parse error: ".concat(e))}function o(e){var r=e.exec(t);return r?(t=t.slice(r[0].length),r):void 0}function a(){return o(/^{\s*/)}function c(){return o(/^}/)}function i(){o(/^\s*/)}function u(){if(i(),"/"===t[0]&&"*"===t[1]){for(var e=2;t[e]&&("*"!==t[e]||"/"!==t[e+1]);)e++;if(!t[e])return n("end of comment is missing");var r=t.slice(2,e);return t=t.slice(e+2),{type:"comment",comment:r}}}function l(){for(var e,t=[];e=u();)t.push(e);return r.removeComments?[]:t}function f(){for(i();"}"===t[0];)n("extra closing bracket");var e=o(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);return e?e[0].trim().replace(/\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(e){return e.replace(/,/g,"‌")}).split(/\s*(?![^(]*\)),\s*/).map(function(e){return e.replace(/\u200C/g,",")}):void 0}function d(){o(/^([;\s]*)+/);var e=/\/\*[^*]*\*+([^\/*][^*]*\*+)*\//g,t=o(/^(\*?[-#\/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(t){if(t=t[0].trim(),!o(/^:\s*/))return n("property missing ':'");var r=o(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),s={type:"declaration",property:t.replace(e,""),value:r?r[0].replace(e,"").trim():""};return o(/^[;\s]*/),s}}function p(){if(!a())return n("missing '{'");for(var e,t=l();e=d();)t.push(e),t=t.concat(l());return c()?t:n("missing '}'")}function m(){i();for(var e,t=[];e=o(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)t.push(e[1]),o(/^,\s*/);return t.length?{type:"keyframe",values:t,declarations:p()}:void 0}function v(){if(i(),"@"===t[0]){var e=function(){var e=o(/^@([-\w]+)?keyframes\s*/);if(e){var t=e[1];if(!(e=o(/^([-\w]+)\s*/)))return n("@keyframes missing name");var r,s=e[1];if(!a())return n("@keyframes missing '{'");for(var i=l();r=m();)i.push(r),i=i.concat(l());return c()?{type:"keyframes",name:s,vendor:t,keyframes:i}:n("@keyframes missing '}'")}}()||function(){var e=o(/^@supports *([^{]+)/);return e?{type:"supports",supports:e[1].trim(),rules:y()}:void 0}()||function(){return o(/^@host\s*/)?{type:"host",rules:y()}:void 0}()||function(){var e=o(/^@media([^{]+)*/);return e?{type:"media",media:(e[1]||"").trim(),rules:y()}:void 0}()||function(){var e=o(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);return e?{type:"custom-media",name:e[1].trim(),media:e[2].trim()}:void 0}()||function(){return o(/^@page */)?{type:"page",selectors:f()||[],declarations:p()}:void 0}()||function(){var e=o(/^@([-\w]+)?document *([^{]+)/);return e?{type:"document",document:e[2].trim(),vendor:e[1]?e[1].trim():null,rules:y()}:void 0}()||function(){return o(/^@font-face\s*/)?{type:"font-face",declarations:p()}:void 0}()||function(){var e=o(/^@(import|charset|namespace)\s*([^;]+);/);return e?{type:e[1],name:e[2].trim()}:void 0}();if(e&&!r.preserveStatic){var s=!1;return s=e.declarations?e.declarations.some(function(e){return/var\(/.test(e.value)}):(e.keyframes||e.rules||[]).some(function(e){return(e.declarations||[]).some(function(e){return/var\(/.test(e.value)})}),s?e:{}}return e}}function h(){if(!r.preserveStatic){var e=s("{","}",t);if(e){var o=/:(?:root|host)(?![.:#(])/.test(e.pre)&&/--\S*\s*:/.test(e.body),a=/var\(/.test(e.body);if(!o&&!a)return t=t.slice(e.end+1),{}}}var c=f()||[],i=r.preserveStatic?p():p().filter(function(e){var t=c.some(function(e){return/:(?:root|host)(?![.:#(])/.test(e)})&&/^--\S/.test(e.property),r=/var\(/.test(e.value);return t||r});return c.length||n("selector missing"),{type:"rule",selectors:c,declarations:i}}function y(e){if(!e&&!a())return n("missing '{'");for(var r,o=l();t.length&&(e||"}"!==t[0])&&(r=v()||h());)r.type&&o.push(r),o=o.concat(l());return e||c()?o:n("missing '}'")}var r=e({},{preserveStatic:!0,removeComments:!1},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});return{type:"stylesheet",stylesheet:{rules:y(!0),errors:[]}}}function l(t){var r=e({},{parseHost:!1,store:{},onWarning:function(){}},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),n=new RegExp(":".concat(r.parseHost?"host":"root","(?![.:#(])"));return"string"==typeof t&&(t=u(t,r)),t.stylesheet.rules.forEach(function(e){"rule"===e.type&&e.selectors.some(function(e){return n.test(e)})&&e.declarations.forEach(function(e,t){var n=e.property,o=e.value;n&&0===n.indexOf("--")&&(r.store[n]=o)})}),r.store}function f(e){function o(e){for(var o="",s=0;s<e.length;s++){var a=e[s];r&&r(a);var c=n[a.type](a);c&&(o+=c,c.length&&a.selectors&&(o+=t))}return o}var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,n={charset:function(e){return"@charset "+e.name+";"},comment:function(e){return 0===e.comment.indexOf("__CSSVARSPONYFILL")?"/*"+e.comment+"*/":""},"custom-media":function(e){return"@custom-media "+e.name+" "+e.media+";"},declaration:function(e){return e.property+":"+e.value+";"},document:function(e){return"@"+(e.vendor||"")+"document "+e.document+"{"+o(e.rules)+"}"},"font-face":function(e){return"@font-face{"+o(e.declarations)+"}"},host:function(e){return"@host{"+o(e.rules)+"}"},"import":function(e){return"@import "+e.name+";"},keyframe:function(e){return e.values.join(",")+"{"+o(e.declarations)+"}"},keyframes:function(e){return"@"+(e.vendor||"")+"keyframes "+e.name+"{"+o(e.keyframes)+"}"},media:function(e){return"@media "+e.media+"{"+o(e.rules)+"}"},namespace:function(e){return"@namespace "+e.name+";"},page:function(e){return"@page "+(e.selectors.length?e.selectors.join(", "):"")+"{"+o(e.declarations)+"}"},rule:function(e){var t=e.declarations;return t.length?e.selectors.join(",")+"{"+o(t)+"}":void 0},supports:function(e){return"@supports "+e.supports+"{"+o(e.rules)+"}"}};return o(e.stylesheet.rules)}function m(t){var r=e({},{preserveStatic:!0,preserveVars:!1,variables:{},onWarning:function(){}},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});return"string"==typeof t&&(t=u(t,r)),function e(t,r){t.rules.forEach(function(n){n.rules?e(n,r):n.keyframes?n.keyframes.forEach(function(e){"keyframe"===e.type&&r(e.declarations,n)}):n.declarations&&r(n.declarations,t)})}(t.stylesheet,function(e,t){for(var n=0;n<e.length;n++){var o=e[n],s=o.type,a=o.property,c=o.value;if("declaration"===s)if(r.preserveVars||!a||0!==a.indexOf(d)){if(-1!==c.indexOf(p+"(")){var i=h(c,r);i!==o.value&&(i=v(i),r.preserveVars?(e.splice(n,0,{type:s,property:a,value:i}),n++):o.value=i)}}else e.splice(n,1),n--}}),f(t)}function v(e){return(e.match(/calc\(([^)]+)\)/g)||[]).forEach(function(t){var r="calc".concat(t.split("calc").join(""));e=e.replace(t,r)}),e}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;if(-1===e.indexOf("var("))return e;var n=s("(",")",e);return n?"var"===n.pre.slice(-3)?0===n.body.trim().length?(t.onWarning("var() must contain a non-whitespace string"),e):n.pre.slice(0,-3)+function(e){var n=e.split(",")[0].replace(/[\s\n\t]/g,""),o=(e.match(/(?:\s*,\s*){1}(.*)?/)||[])[1],s=Object.prototype.hasOwnProperty.call(t.variables,n)?String(t.variables[n]):void 0,a=s||(o?String(o):void 0),c=r||e;return s||t.onWarning('variable "'.concat(n,'" is undefined')),a&&"undefined"!==a&&a.length>0?h(a,t,c):"var(".concat(c,")")}(n.body)+h(n.post,t):n.pre+"(".concat(h(n.body,t),")")+h(n.post,t):(-1!==e.indexOf("var(")&&t.onWarning('missing closing ")" in the value "'.concat(e,'"')),e)}function k(){function a(e,t,r,n){!s.silent&&window.console&&console.error("".concat(o).concat(e,"\n"),t),s.onError(e,t,r,n)}function c(e){!s.silent&&window.console&&console.warn("".concat(o).concat(e)),s.onWarning(e)}var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o="cssVars(): ",s=e({},b,r);if(y){if(s.watch)return s.watch=b.watch,function(e){function t(e){return"LINK"===e.tagName&&-1!==(e.getAttribute("rel")||"").indexOf("stylesheet")&&!e.disabled}window.MutationObserver&&(O&&(O.disconnect(),O=null),(O=new MutationObserver(function(r){r.some(function(r){var n,o=!1;return"attributes"===r.type?o=t(r.target):"childList"===r.type&&(n=r.addedNodes,o=Array.apply(null,n).some(function(e){var r=1===e.nodeType&&e.hasAttribute("data-cssvars"),n=function(e){return"STYLE"===e.tagName&&!e.disabled}(e)&&E.cssVars.test(e.textContent);return!r&&(t(e)||n)})||function(t){return Array.apply(null,t).some(function(t){var r=1===t.nodeType,n=r&&"out"===t.getAttribute("data-cssvars"),o=r&&"src"===t.getAttribute("data-cssvars"),s=o;if(o||n){var a=t.getAttribute("data-cssvars-group"),c=e.rootElement.querySelector('[data-cssvars-group="'.concat(a,'"]'));o&&(L(e.rootElement),w.dom={}),c&&c.parentNode.removeChild(c)}return s})}(r.removedNodes)),o})&&k(e)})).observe(document.documentElement,{attributes:!0,attributeFilter:["disabled","href"],childList:!0,subtree:!0}))}(s),void k(s);if(!1===s.watch&&O&&(O.disconnect(),O=null),!s.__benchmark){if(C===s.rootElement)return void function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;clearTimeout(x),x=setTimeout(function(){e.__benchmark=null,k(e)},t)}(r);if(s.__benchmark=T(),s.exclude=[O?'[data-cssvars]:not([data-cssvars=""])':'[data-cssvars="out"]',s.exclude].filter(function(e){return e}).join(","),s.variables=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=/^-{2}/;return Object.keys(e).reduce(function(r,n){return r[t.test(n)?n:"--".concat(n.replace(/^-+/,""))]=e[n],r},{})}(s.variables),!O&&(Array.apply(null,s.rootElement.querySelectorAll('[data-cssvars="out"]')).forEach(function(e){var t=e.getAttribute("data-cssvars-group");(t?s.rootElement.querySelector('[data-cssvars="src"][data-cssvars-group="'.concat(t,'"]')):null)||e.parentNode.removeChild(e)}),A)){var i=s.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])');i.length<A&&(A=i.length,w.dom={})}}if("loading"!==document.readyState){var d=Boolean(s.shadowDOM||s.rootElement.shadowRoot||s.rootElement.host);if(g&&s.onlyLegacy){if(s.updateDOM){var p=s.rootElement.host||(s.rootElement===document?document.documentElement:s.rootElement);Object.keys(s.variables).forEach(function(e){p.style.setProperty(e,s.variables[e])})}}else d&&!j?n({rootElement:b.rootElement,include:b.include,exclude:s.exclude,onSuccess:function(e,t,r){return(e=((e=e.replace(E.cssComments,"").replace(E.cssMediaQueries,"")).match(E.cssVarDeclRules)||[]).join(""))||!1},onComplete:function(e,t,r){l(e,{store:w.dom,onWarning:c}),j=!0,k(s)}}):(C=s.rootElement,n({rootElement:s.rootElement,include:s.include,exclude:s.exclude,onBeforeSend:s.onBeforeSend,onError:function(e,t,r){var n=e.responseURL||_(r,location.href),o=e.statusText?"(".concat(e.statusText,")"):"Unspecified Error"+(0===e.status?" (possibly CORS related)":"");a("CSS XHR Error: ".concat(n," ").concat(e.status," ").concat(o),t,e,n)},onSuccess:function(e,t,r){var n=s.onSuccess(e,t,r);return e=void 0!==n&&!1===Boolean(n)?"":n||e,s.updateURLs&&(e=function(e,t){return(e.replace(E.cssComments,"").match(E.cssUrls)||[]).forEach(function(r){var n=r.replace(E.cssUrls,"$1"),o=_(n,t);e=e.replace(r,r.replace(n,o))}),e}(e,r)),e},onComplete:function(r,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i={},p=s.updateDOM?w.dom:Object.keys(w.job).length?w.job:w.job=JSON.parse(JSON.stringify(w.dom)),v=!1;
if(o.forEach(function(e,t){if(E.cssVars.test(n[t]))try{var r=u(n[t],{preserveStatic:s.preserveStatic,removeComments:!0});l(r,{parseHost:d,store:i,onWarning:c}),e.__cssVars={tree:r}}catch(t){a(t.message,e)}}),s.updateDOM&&e(w.user,s.variables),e(i,s.variables),v=Boolean((document.querySelector("[data-cssvars]")||Object.keys(w.dom).length)&&Object.keys(i).some(function(e){return i[e]!==p[e]})),e(p,w.user,i),v)L(s.rootElement),k(s);else{var h=[],y=[],g=!1;if(w.job={},s.updateDOM&&S.job++,o.forEach(function(t){var r=!t.__cssVars;if(t.__cssVars)try{m(t.__cssVars.tree,e({},s,{variables:p,onWarning:c}));var n=f(t.__cssVars.tree);if(s.updateDOM){if(t.getAttribute("data-cssvars")||t.setAttribute("data-cssvars","src"),n.length){var o=t.getAttribute("data-cssvars-group")||++S.group,i=n.replace(/\s/g,""),u=s.rootElement.querySelector('[data-cssvars="out"][data-cssvars-group="'.concat(o,'"]'))||document.createElement("style");g=g||E.cssKeyframes.test(n),u.hasAttribute("data-cssvars")||u.setAttribute("data-cssvars","out"),i===t.textContent.replace(/\s/g,"")?(r=!0,u&&u.parentNode&&(t.removeAttribute("data-cssvars-group"),u.parentNode.removeChild(u))):i!==u.textContent.replace(/\s/g,"")&&([t,u].forEach(function(e){e.setAttribute("data-cssvars-job",S.job),e.setAttribute("data-cssvars-group",o)}),u.textContent=n,h.push(n),y.push(u),u.parentNode||t.parentNode.insertBefore(u,t.nextSibling))}}else t.textContent.replace(/\s/g,"")!==n&&h.push(n)}catch(e){a(e.message,t)}r&&t.setAttribute("data-cssvars","skip"),t.hasAttribute("data-cssvars-job")||t.setAttribute("data-cssvars-job",S.job)}),A=s.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])').length,s.shadowDOM)for(var b,O=[s.rootElement].concat(t(s.rootElement.querySelectorAll("*"))),x=0;b=O[x];++x)if(b.shadowRoot&&b.shadowRoot.querySelector("style")){var j=e({},s,{rootElement:b.shadowRoot,variables:w.dom});k(j)}s.updateDOM&&g&&M(s.rootElement),C=!1,s.onComplete(h.join(""),y,JSON.parse(JSON.stringify(p)),T()-s.__benchmark)}}}))}else document.addEventListener("DOMContentLoaded",function e(t){k(r),document.removeEventListener("DOMContentLoaded",e)})}}function M(e){var t=["animation-name","-moz-animation-name","-webkit-animation-name"].filter(function(e){return getComputedStyle(document.body)[e]})[0];if(t){for(var r=e.getElementsByTagName("*"),n=[],o=0,s=r.length;s>o;o++){var a=r[o];"none"!==getComputedStyle(a)[t]&&(a.style[t]+="__CSSVARSPONYFILL-KEYFRAMES__",n.push(a))}document.body.offsetHeight;for(var c=0,i=n.length;i>c;c++){var u=n[c].style;u[t]=u[t].replace("__CSSVARSPONYFILL-KEYFRAMES__","")}}}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.href,r=document.implementation.createHTMLDocument(""),n=r.createElement("base"),o=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(o),n.href=t,o.href=e,o.href}function T(){return y&&(window.performance||{}).now?window.performance.now():(new Date).getTime()}function L(e){Array.apply(null,e.querySelectorAll('[data-cssvars="skip"],[data-cssvars="src"]')).forEach(function(e){return e.setAttribute("data-cssvars","")})}var s=a;a.range=i;var d="--",p="var",y="undefined"!=typeof window,g=y&&window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),S={group:0,job:0},b={rootElement:y?document:null,shadowDOM:!1,include:"style,link[rel=stylesheet]",exclude:"",variables:{},onlyLegacy:!0,preserveStatic:!0,preserveVars:!1,silent:!1,updateDOM:!0,updateURLs:!0,watch:null,onBeforeSend:function(){},onWarning:function(){},onError:function(){},onSuccess:function(){},onComplete:function(){}},E={cssComments:/\/\*[\s\S]+?\*\//g,cssKeyframes:/@(?:-\w*-)?keyframes/,cssMediaQueries:/@media[^{]+\{([\s\S]+?})\s*}/g,cssUrls:/url\((?!['"]?(?:data|http|\/\/):)['"]?([^'")]*)['"]?\)/g,cssVarDeclRules:/(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^}]*})/g,cssVarDecls:/(?:[\s;]*)(-{2}\w[\w-]*)(?:\s*:\s*)([^;]*);/g,cssVarFunc:/var\(\s*--[\w-]/,cssVars:/(?:(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^;]*;*\s*)|(?:var\(\s*))(--[^:)]+)(?:\s*[:)])/},w={dom:{},job:{},user:{}},C=!1,O=null,A=0,x=null,j=!1;return k.reset=function(){for(var e in C=!1,O&&(O.disconnect(),O=null),A=0,x=null,j=!1,w)w[e]={}},k}),function(factory){"function"==typeof define&&define.amd?define(["moment"],factory):"object"==typeof exports?module.exports=factory(require("../moment")):factory(("undefined"!=typeof global?global:this).moment)}(function(moment){return moment.defineLocale("fr",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"LT:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinalParse:/\d{1,2}(er|)/,ordinal:function(number){return number+(1===number?"er":"")},week:{dow:1,doy:4}})}),scheduler.locale={date:{month_full:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],month_short:["Jan","Fév","Mar","Avr","Mai","Juin","Juil","Aoû","Sep","Oct","Nov","Déc"],day_full:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],day_short:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]},labels:{dhx_cal_today_button:"Aujourd'hui",day_tab:"Jour",week_tab:"Semaine",month_tab:"Mois",new_event:"Nouvel événement",icon_save:"Enregistrer",icon_cancel:"Annuler",icon_details:"Détails",icon_edit:"Modifier",icon_delete:"Effacer",confirm_closing:"",confirm_deleting:"L'événement sera effacé sans appel, êtes-vous sûr ?",section_description:"Description",section_time:"Période",full_day:"Journée complète",confirm_recurring:"Voulez-vous éditer toute une série d'évènements répétés?",section_recurring:"Périodicité",button_recurring:"Désactivé",button_recurring_open:"Activé",button_edit_series:"Modifier la série",button_edit_occurrence:"Modifier une copie",agenda_tab:"Jour",date:"Date",description:"Description",year_tab:"Année",week_agenda_tab:"Jour",grid_tab:"Grille",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel"}},function(){function defaults(obj,std){for(var key in std)obj[key]||(obj[key]=std[key]);return obj}function getElementSizes(element,scheduler){var sizes={};return element=scheduler._els[element],element&&element[0]?(sizes.x=element[0].scrollWidth,sizes.y=element[0].scrollHeight):(sizes.x=0,sizes.y=0),sizes}function add_export_methods(scheduler){scheduler.exportToPDF=function(config){config=defaults(config||{},{name:"calendar.pdf",format:"A4",orientation:"landscape",dpi:96,zoom:1}),config.html=this._export_html(config),config.mode=this.getState().mode,this._send_to_export(config,"pdf")},scheduler.exportToPNG=function(config){config=defaults(config||{},{name:"calendar.png",format:"A4",orientation:"landscape",dpi:96,zoom:1}),config.html=this._export_html(config),config.mode=this.getState().mode,this._send_to_export(config,"png")},scheduler.exportToICal=function(config){config=defaults(config||{},{name:"calendar.ical",data:this._serialize_plain(null,config)}),this._send_to_export(config,"ical")},scheduler.exportToExcel=function(config){config=defaults(config||{},{name:"calendar.xlsx",title:"Events",data:this._serialize_plain(this.templates.xml_format,config),columns:this._serialize_columns()}),this._send_to_export(config,"excel")},scheduler._ajax_to_export=function(data,type,callback){delete data.callback;var url=data.server||"https://export.dhtmlx.com/scheduler";dhtmlxAjax.post(url,"type="+type+"&store=1&data="+encodeURIComponent(JSON.stringify(data)),function(loader){var fail=loader.xmlDoc.status>400,info=null;if(!fail)try{info=JSON.parse(loader.xmlDoc.responseText)}catch(e){}callback(info)})},scheduler._plain_export_copy=function(source,format){var target={};for(var key in source)target[key]=source[key];return target.start_date=format(target.start_date),target.end_date=format(target.end_date),target.$text=this.templates.event_text(source.start_date,source.end_date,source),target},scheduler._serialize_plain=function(format,config){format=format||scheduler.date.date_to_str("%Y%m%dT%H%i%s",!0);var events;events=config&&config.start&&config.end?scheduler.getEvents(config.start,config.end):scheduler.getEvents();for(var data=[],i=0;i<events.length;i++)data[i]=this._plain_export_copy(events[i],format);return data},scheduler._serialize_columns=function(){return[{id:"start_date",header:"Start Date",width:30},{id:"end_date",header:"End Date",width:30},{id:"$text",header:"Text",width:100}]},scheduler._send_to_export=function(data,type){if(data.version||(data.version=scheduler.version),data.skin||(data.skin=scheduler.skin),data.callback)return scheduler._ajax_to_export(data,type,data.callback);var form=this._create_hidden_form();form.firstChild.action=data.server||"https://export.dhtmlx.com/scheduler",form.firstChild.childNodes[0].value=JSON.stringify(data),form.firstChild.childNodes[1].value=type,form.firstChild.submit()},scheduler._create_hidden_form=function(){if(!this._hidden_export_form){var t=this._hidden_export_form=document.createElement("div");t.style.display="none",t.innerHTML="<form method='POST' target='_blank'><input type='text' name='data'><input type='hidden' name='type' value=''></form>",document.body.appendChild(t)}return this._hidden_export_form},scheduler._export_resize=function(){scheduler.callEvent("onSchedulerResize",[])&&(scheduler.update_view(),scheduler.callEvent("onAfterSchedulerResize",[]))},scheduler._get_export_size=function(format,orientation,zoom,dpi,header,footer,scales){dpi=parseInt(dpi)/25.4||4;var sizes={A5:{x:148,y:210},A4:{x:210,y:297},A3:{x:297,y:420},A2:{x:420,y:594},A1:{x:594,y:841},A0:{x:841,y:1189}},dataX=getElementSizes("dhx_cal_data",this).x,dataY=getElementSizes("dhx_cal_data",this).y,headY=getElementSizes("dhx_cal_header",this).y,multY=getElementSizes("dhx_multi_day",this).y,cSize={y:dataY+headY+multY};return"full"===format?cSize.x=dataX:cSize.x=Math.floor(("landscape"===orientation?sizes[format].y:sizes[format].x)*dpi),scales&&(cSize.x*=parseFloat(scales.x)||1,cSize.y*=parseFloat(scales.y)||1),cSize},scheduler._export_html=function(obj){var hy=scheduler.xy.nav_height,sw=scheduler.xy.scroll_width,xs=scheduler._obj.style.width,ys=scheduler._obj.style.height,size=scheduler._get_export_size(obj.format,obj.orientation,obj.zoom,obj.dpi,obj.header,obj.footer,obj.scales);scheduler._obj.style.width=size.x+"px",scheduler._obj.style.height=size.y+"px",scheduler.xy.nav_height=0,scheduler.xy.scroll_width=0,scheduler._export_resize();var html=scheduler._obj.innerHTML;return scheduler.xy.scroll_width=sw,scheduler.xy.nav_height=hy,scheduler._obj.style.width=xs,scheduler._obj.style.height=ys,scheduler._export_resize(),html}}window.dhtmlxAjax||(window.dhtmlxAjax={post:function(url,data,callback){return dhx4.ajax.post(url,data,callback)},get:function(url,callback){return dhx4.ajax.get(url,callback)}}),add_export_methods(scheduler),window.Scheduler&&Scheduler.plugin&&Scheduler.plugin(add_export_methods)}(),function(global){"use strict";var buffer,_Base64=global.Base64,version="2.1.9";if("undefined"!=typeof module&&module.exports)try{buffer=require("buffer").Buffer}catch(err){}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(bin){for(var t={},i=0,l=bin.length;l>i;i++)t[bin.charAt(i)]=i;return t}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(c){if(c.length<2){var cc=c.charCodeAt(0);return 128>cc?c:2048>cc?fromCharCode(192|cc>>>6)+fromCharCode(128|63&cc):fromCharCode(224|cc>>>12&15)+fromCharCode(128|cc>>>6&63)+fromCharCode(128|63&cc)}var cc=65536+1024*(c.charCodeAt(0)-55296)+(c.charCodeAt(1)-56320);return fromCharCode(240|cc>>>18&7)+fromCharCode(128|cc>>>12&63)+fromCharCode(128|cc>>>6&63)+fromCharCode(128|63&cc)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(u){return u.replace(re_utob,cb_utob)},cb_encode=function(ccc){var padlen=[0,2,1][ccc.length%3],ord=ccc.charCodeAt(0)<<16|(ccc.length>1?ccc.charCodeAt(1):0)<<8|(ccc.length>2?ccc.charCodeAt(2):0),chars=[b64chars.charAt(ord>>>18),b64chars.charAt(ord>>>12&63),padlen>=2?"=":b64chars.charAt(ord>>>6&63),padlen>=1?"=":b64chars.charAt(63&ord)];return chars.join("")},btoa=global.btoa?function(b){return global.btoa(b)}:function(b){return b.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=buffer?function(u){return(u.constructor===buffer.constructor?u:new buffer(u)).toString("base64")}:function(u){return btoa(utob(u))},encode=function(u,urisafe){return urisafe?_encode(String(u)).replace(/[+\/]/g,function(m0){return"+"==m0?"-":"_"}).replace(/=/g,""):_encode(String(u))},encodeURI=function(u){return encode(u,!0)},re_btou=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),cb_btou=function(cccc){switch(cccc.length){case 4:var cp=(7&cccc.charCodeAt(0))<<18|(63&cccc.charCodeAt(1))<<12|(63&cccc.charCodeAt(2))<<6|63&cccc.charCodeAt(3),offset=cp-65536;return fromCharCode((offset>>>10)+55296)+fromCharCode((1023&offset)+56320);case 3:return fromCharCode((15&cccc.charCodeAt(0))<<12|(63&cccc.charCodeAt(1))<<6|63&cccc.charCodeAt(2));default:return fromCharCode((31&cccc.charCodeAt(0))<<6|63&cccc.charCodeAt(1))}},btou=function(b){return b.replace(re_btou,cb_btou)},cb_decode=function(cccc){var len=cccc.length,padlen=len%4,n=(len>0?b64tab[cccc.charAt(0)]<<18:0)|(len>1?b64tab[cccc.charAt(1)]<<12:0)|(len>2?b64tab[cccc.charAt(2)]<<6:0)|(len>3?b64tab[cccc.charAt(3)]:0),chars=[fromCharCode(n>>>16),fromCharCode(n>>>8&255),fromCharCode(255&n)];return chars.length-=[0,0,2,1][padlen],chars.join("")},atob=global.atob?function(a){return global.atob(a)}:function(a){return a.replace(/[\s\S]{1,4}/g,cb_decode)},_decode=buffer?function(a){return(a.constructor===buffer.constructor?a:new buffer(a,"base64")).toString()}:function(a){return btou(atob(a))},decode=function(a){return _decode(String(a).replace(/[-_]/g,function(m0){return"-"==m0?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var Base64=global.Base64;return global.Base64=_Base64,Base64};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict},"function"==typeof Object.defineProperty){var noEnum=function(v){return{value:v,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum(function(){return decode(this)})),Object.defineProperty(String.prototype,"toBase64",noEnum(function(urisafe){return encode(this,urisafe)})),Object.defineProperty(String.prototype,"toBase64URI",noEnum(function(){return encode(this,!0)}))}}global.Meteor&&(Base64=global.Base64)}(this),angular.module("ngLocale",[],["$provide",function($provide){var PLURAL_CATEGORY={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};$provide.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],MONTH:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],SHORTDAY:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],SHORTMONTH:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],fullDate:"EEEE d MMMM y",longDate:"d MMMM y",medium:"d MMM y HH:mm:ss",mediumDate:"d MMM y",mediumTime:"HH:mm:ss","short":"dd/MM/y HH:mm",shortDate:"dd/MM/y",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"€",DECIMAL_SEP:",",GROUP_SEP:" ",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:" ¤",posPre:"",posSuf:" ¤"}]},id:"fr-fr",pluralCat:function(n,opt_precision){var i=0|n;return 0===i||1===i?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}})}]),function(b,c){var a,$=b.jQuery||b.Cowboy||(b.Cowboy={});$.throttle=a=function(e,f,j,i){function g(){function l(){d=+new Date,j.apply(o,n)}function k(){h=c}var o=this,m=+new Date-d,n=arguments;i&&!h&&l(),h&&clearTimeout(h),i===c&&m>e?l():f!==!0&&(h=setTimeout(i?k:l,i===c?e-m:e))}var h,d=0;return"boolean"!=typeof f&&(i=j,j=f,f=c),$.guid&&(g.guid=j.guid=j.guid||$.guid++),g},$.debounce=function(d,e,f){return f===c?a(d,e,!1):a(d,f,e!==!1)}}(this),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.io=e()}}(function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/")},{"./lib/":2}],2:[function(_dereq_,module,exports){function lookup(uri,opts){"object"==typeof uri&&(opts=uri,uri=void 0),opts=opts||{};var io,parsed=url(uri),source=parsed.source,id=parsed.id;return opts.forceNew||opts["force new connection"]||!1===opts.multiplex?(debug("ignoring socket cache for %s",source),io=Manager(source,opts)):(cache[id]||(debug("new io instance for %s",source),cache[id]=Manager(source,opts)),io=cache[id]),io.socket(parsed.path)}var url=_dereq_("./url"),parser=_dereq_("socket.io-parser"),Manager=_dereq_("./manager"),debug=_dereq_("debug")("socket.io-client");module.exports=exports=lookup;var cache=exports.managers={};exports.protocol=parser.protocol,exports.connect=lookup,exports.Manager=_dereq_("./manager"),exports.Socket=_dereq_("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":44}],3:[function(_dereq_,module,exports){function Manager(uri,opts){return this instanceof Manager?(uri&&"object"==typeof uri&&(opts=uri,uri=void 0),opts=opts||{},opts.path=opts.path||"/socket.io",this.nsps={},this.subs=[],this.opts=opts,this.reconnection(opts.reconnection!==!1),this.reconnectionAttempts(opts.reconnectionAttempts||1/0),this.reconnectionDelay(opts.reconnectionDelay||1e3),this.reconnectionDelayMax(opts.reconnectionDelayMax||5e3),this.randomizationFactor(opts.randomizationFactor||.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==opts.timeout?2e4:opts.timeout),this.readyState="closed",this.uri=uri,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new parser.Encoder,this.decoder=new parser.Decoder,this.autoConnect=opts.autoConnect!==!1,void(this.autoConnect&&this.open())):new Manager(uri,opts)}var eio=(_dereq_("./url"),_dereq_("engine.io-client")),Socket=_dereq_("./socket"),Emitter=_dereq_("component-emitter"),parser=_dereq_("socket.io-parser"),on=_dereq_("./on"),bind=_dereq_("component-bind"),debug=(_dereq_("object-component"),_dereq_("debug")("socket.io-client:manager")),indexOf=_dereq_("indexof"),Backoff=_dereq_("backo2");module.exports=Manager,Manager.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var nsp in this.nsps)this.nsps[nsp].emit.apply(this.nsps[nsp],arguments)},Manager.prototype.updateSocketIds=function(){for(var nsp in this.nsps)this.nsps[nsp].id=this.engine.id},Emitter(Manager.prototype),Manager.prototype.reconnection=function(v){return arguments.length?(this._reconnection=!!v,this):this._reconnection},Manager.prototype.reconnectionAttempts=function(v){return arguments.length?(this._reconnectionAttempts=v,this):this._reconnectionAttempts},Manager.prototype.reconnectionDelay=function(v){return arguments.length?(this._reconnectionDelay=v,this.backoff&&this.backoff.setMin(v),this):this._reconnectionDelay},Manager.prototype.randomizationFactor=function(v){return arguments.length?(this._randomizationFactor=v,this.backoff&&this.backoff.setJitter(v),this):this._randomizationFactor},Manager.prototype.reconnectionDelayMax=function(v){return arguments.length?(this._reconnectionDelayMax=v,this.backoff&&this.backoff.setMax(v),this):this._reconnectionDelayMax},Manager.prototype.timeout=function(v){return arguments.length?(this._timeout=v,this):this._timeout},Manager.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},Manager.prototype.open=Manager.prototype.connect=function(fn){if(debug("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;debug("opening %s",this.uri),this.engine=eio(this.uri,this.opts);var socket=this.engine,self=this;this.readyState="opening",this.skipReconnect=!1;var openSub=on(socket,"open",function(){self.onopen(),fn&&fn()}),errorSub=on(socket,"error",function(data){if(debug("connect_error"),self.cleanup(),self.readyState="closed",self.emitAll("connect_error",data),fn){var err=new Error("Connection error");err.data=data,fn(err)}else self.maybeReconnectOnOpen()});if(!1!==this._timeout){var timeout=this._timeout;debug("connect attempt will timeout after %d",timeout);var timer=setTimeout(function(){debug("connect attempt timed out after %d",timeout),openSub.destroy(),socket.close(),socket.emit("error","timeout"),self.emitAll("connect_timeout",timeout)},timeout);this.subs.push({destroy:function(){clearTimeout(timer)}})}return this.subs.push(openSub),this.subs.push(errorSub),this},Manager.prototype.onopen=function(){debug("open"),this.cleanup(),this.readyState="open",this.emit("open");var socket=this.engine;this.subs.push(on(socket,"data",bind(this,"ondata"))),this.subs.push(on(this.decoder,"decoded",bind(this,"ondecoded"))),this.subs.push(on(socket,"error",bind(this,"onerror"))),this.subs.push(on(socket,"close",bind(this,"onclose")))},Manager.prototype.ondata=function(data){this.decoder.add(data)},Manager.prototype.ondecoded=function(packet){this.emit("packet",packet)},Manager.prototype.onerror=function(err){debug("error",err),this.emitAll("error",err)},Manager.prototype.socket=function(nsp){var socket=this.nsps[nsp];if(!socket){socket=new Socket(this,nsp),this.nsps[nsp]=socket;var self=this;socket.on("connect",function(){socket.id=self.engine.id,~indexOf(self.connected,socket)||self.connected.push(socket)})}return socket},Manager.prototype.destroy=function(socket){var index=indexOf(this.connected,socket);~index&&this.connected.splice(index,1),this.connected.length||this.close()},Manager.prototype.packet=function(packet){debug("writing packet %j",packet);var self=this;self.encoding?self.packetBuffer.push(packet):(self.encoding=!0,this.encoder.encode(packet,function(encodedPackets){for(var i=0;i<encodedPackets.length;i++)self.engine.write(encodedPackets[i]);self.encoding=!1,self.processPacketQueue()}))},Manager.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var pack=this.packetBuffer.shift();this.packet(pack)}},Manager.prototype.cleanup=function(){for(var sub;sub=this.subs.shift();)sub.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},Manager.prototype.close=Manager.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},Manager.prototype.onclose=function(reason){debug("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",reason),this._reconnection&&!this.skipReconnect&&this.reconnect()},Manager.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var self=this;if(this.backoff.attempts>=this._reconnectionAttempts)debug("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var delay=this.backoff.duration();debug("will wait %dms before reconnect attempt",delay),this.reconnecting=!0;var timer=setTimeout(function(){self.skipReconnect||(debug("attempting reconnect"),self.emitAll("reconnect_attempt",self.backoff.attempts),self.emitAll("reconnecting",self.backoff.attempts),self.skipReconnect||self.open(function(err){err?(debug("reconnect attempt error"),self.reconnecting=!1,self.reconnect(),self.emitAll("reconnect_error",err.data)):(debug("reconnect success"),self.onreconnect())}))},delay);this.subs.push({destroy:function(){clearTimeout(timer)}})}},Manager.prototype.onreconnect=function(){var attempt=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",attempt)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:40,"object-component":41,"socket.io-parser":44}],4:[function(_dereq_,module,exports){function on(obj,ev,fn){return obj.on(ev,fn),{destroy:function(){obj.removeListener(ev,fn)}}}module.exports=on},{}],5:[function(_dereq_,module,exports){function Socket(io,nsp){this.io=io,this.nsp=nsp,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var parser=_dereq_("socket.io-parser"),Emitter=_dereq_("component-emitter"),toArray=_dereq_("to-array"),on=_dereq_("./on"),bind=_dereq_("component-bind"),debug=_dereq_("debug")("socket.io-client:socket"),hasBin=_dereq_("has-binary");module.exports=exports=Socket;var events={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},emit=Emitter.prototype.emit;Emitter(Socket.prototype),Socket.prototype.subEvents=function(){if(!this.subs){var io=this.io;this.subs=[on(io,"open",bind(this,"onopen")),on(io,"packet",bind(this,"onpacket")),on(io,"close",bind(this,"onclose"))]}},Socket.prototype.open=Socket.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},Socket.prototype.send=function(){var args=toArray(arguments);return args.unshift("message"),this.emit.apply(this,args),this},Socket.prototype.emit=function(ev){if(events.hasOwnProperty(ev))return emit.apply(this,arguments),this;var args=toArray(arguments),parserType=parser.EVENT;hasBin(args)&&(parserType=parser.BINARY_EVENT);var packet={type:parserType,data:args};return"function"==typeof args[args.length-1]&&(debug("emitting packet with ack id %d",this.ids),this.acks[this.ids]=args.pop(),packet.id=this.ids++),this.connected?this.packet(packet):this.sendBuffer.push(packet),this},Socket.prototype.packet=function(packet){packet.nsp=this.nsp,this.io.packet(packet)},Socket.prototype.onopen=function(){debug("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:parser.CONNECT})},Socket.prototype.onclose=function(reason){debug("close (%s)",reason),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",reason)},Socket.prototype.onpacket=function(packet){if(packet.nsp==this.nsp)switch(packet.type){case parser.CONNECT:this.onconnect();break;case parser.EVENT:this.onevent(packet);break;case parser.BINARY_EVENT:this.onevent(packet);break;case parser.ACK:this.onack(packet);break;case parser.BINARY_ACK:this.onack(packet);break;case parser.DISCONNECT:this.ondisconnect();break;case parser.ERROR:this.emit("error",packet.data)}},Socket.prototype.onevent=function(packet){var args=packet.data||[];debug("emitting event %j",args),null!=packet.id&&(debug("attaching ack callback to event"),args.push(this.ack(packet.id))),this.connected?emit.apply(this,args):this.receiveBuffer.push(args)},Socket.prototype.ack=function(id){var self=this,sent=!1;return function(){if(!sent){sent=!0;var args=toArray(arguments);debug("sending ack %j",args);var type=hasBin(args)?parser.BINARY_ACK:parser.ACK;self.packet({type:type,id:id,data:args})}}},Socket.prototype.onack=function(packet){debug("calling ack %s with %j",packet.id,packet.data);var fn=this.acks[packet.id];fn.apply(this,packet.data),delete this.acks[packet.id]},Socket.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},Socket.prototype.emitBuffered=function(){var i;for(i=0;i<this.receiveBuffer.length;i++)emit.apply(this,this.receiveBuffer[i]);for(this.receiveBuffer=[],i=0;i<this.sendBuffer.length;i++)this.packet(this.sendBuffer[i]);this.sendBuffer=[]},Socket.prototype.ondisconnect=function(){debug("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},Socket.prototype.destroy=function(){if(this.subs){for(var i=0;i<this.subs.length;i++)this.subs[i].destroy();this.subs=null}this.io.destroy(this)},Socket.prototype.close=Socket.prototype.disconnect=function(){return this.connected&&(debug("performing disconnect (%s)",this.nsp),this.packet({type:parser.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":36,"socket.io-parser":44,"to-array":48}],6:[function(_dereq_,module,exports){(function(global){function url(uri,loc){var obj=uri,loc=loc||global.location;return null==uri&&(uri=loc.protocol+"//"+loc.host),"string"==typeof uri&&("/"==uri.charAt(0)&&(uri="/"==uri.charAt(1)?loc.protocol+uri:loc.hostname+uri),/^(https?|wss?):\/\//.test(uri)||(debug("protocol-less url %s",uri),uri="undefined"!=typeof loc?loc.protocol+"//"+uri:"https://"+uri),debug("parse %s",uri),obj=parseuri(uri)),obj.port||(/^(http|ws)$/.test(obj.protocol)?obj.port="80":/^(http|ws)s$/.test(obj.protocol)&&(obj.port="443")),obj.path=obj.path||"/",obj.id=obj.protocol+"://"+obj.host+":"+obj.port,obj.href=obj.protocol+"://"+obj.host+(loc&&loc.port==obj.port?"":":"+obj.port),obj}var parseuri=_dereq_("parseuri"),debug=_dereq_("debug")("socket.io-client:url");module.exports=url}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:10,parseuri:42}],7:[function(_dereq_,module,exports){function Backoff(opts){opts=opts||{},this.ms=opts.min||100,this.max=opts.max||1e4,this.factor=opts.factor||2,this.jitter=opts.jitter>0&&opts.jitter<=1?opts.jitter:0,this.attempts=0}module.exports=Backoff,Backoff.prototype.duration=function(){var ms=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var rand=Math.random(),deviation=Math.floor(rand*this.jitter*ms);ms=0==(1&Math.floor(10*rand))?ms-deviation:ms+deviation}return 0|Math.min(ms,this.max)},Backoff.prototype.reset=function(){this.attempts=0},Backoff.prototype.setMin=function(min){this.ms=min},Backoff.prototype.setMax=function(max){this.max=max},Backoff.prototype.setJitter=function(jitter){this.jitter=jitter}},{}],8:[function(_dereq_,module,exports){var slice=[].slice;module.exports=function(obj,fn){if("string"==typeof fn&&(fn=obj[fn]),"function"!=typeof fn)throw new Error("bind() requires a function");var args=slice.call(arguments,2);return function(){return fn.apply(obj,args.concat(slice.call(arguments)))}}},{}],9:[function(_dereq_,module,exports){function Emitter(obj){return obj?mixin(obj):void 0}function mixin(obj){for(var key in Emitter.prototype)obj[key]=Emitter.prototype[key];return obj}module.exports=Emitter,Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){return this._callbacks=this._callbacks||{},(this._callbacks[event]=this._callbacks[event]||[]).push(fn),this},Emitter.prototype.once=function(event,fn){function on(){self.off(event,on),fn.apply(this,arguments)}var self=this;return this._callbacks=this._callbacks||{},
on.fn=fn,this.on(event,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length)return delete this._callbacks[event],this;for(var cb,i=0;i<callbacks.length;i++)if(cb=callbacks[i],cb===fn||cb.fn===fn){callbacks.splice(i,1);break}return this},Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;len>i;++i)callbacks[i].apply(this,args)}return this},Emitter.prototype.listeners=function(event){return this._callbacks=this._callbacks||{},this._callbacks[event]||[]},Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},{}],10:[function(_dereq_,module,exports){function debug(name){return debug.enabled(name)?function(fmt){fmt=coerce(fmt);var curr=new Date,ms=curr-(debug[name]||curr);debug[name]=curr,fmt=name+" "+fmt+" +"+debug.humanize(ms),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function coerce(val){return val instanceof Error?val.stack||val.message:val}module.exports=debug,debug.names=[],debug.skips=[],debug.enable=function(name){try{localStorage.debug=name}catch(e){}for(var split=(name||"").split(/[\s,]+/),len=split.length,i=0;len>i;i++)name=split[i].replace("*",".*?"),"-"===name[0]?debug.skips.push(new RegExp("^"+name.substr(1)+"$")):debug.names.push(new RegExp("^"+name+"$"))},debug.disable=function(){debug.enable("")},debug.humanize=function(ms){var sec=1e3,min=6e4,hour=60*min;return ms>=hour?(ms/hour).toFixed(1)+"h":ms>=min?(ms/min).toFixed(1)+"m":ms>=sec?(ms/sec|0)+"s":ms+"ms"},debug.enabled=function(name){for(var i=0,len=debug.skips.length;len>i;i++)if(debug.skips[i].test(name))return!1;for(var i=0,len=debug.names.length;len>i;i++)if(debug.names[i].test(name))return!0;return!1};try{window.localStorage&&debug.enable(localStorage.debug)}catch(e){}},{}],11:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/")},{"./lib/":12}],12:[function(_dereq_,module,exports){module.exports=_dereq_("./socket"),module.exports.parser=_dereq_("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(_dereq_,module,exports){(function(global){function Socket(uri,opts){if(!(this instanceof Socket))return new Socket(uri,opts);if(opts=opts||{},uri&&"object"==typeof uri&&(opts=uri,uri=null),uri&&(uri=parseuri(uri),opts.host=uri.host,opts.secure="https"==uri.protocol||"wss"==uri.protocol,opts.port=uri.port,uri.query&&(opts.query=uri.query)),this.secure=null!=opts.secure?opts.secure:global.location&&"https:"==location.protocol,opts.host){var pieces=opts.host.split(":");opts.hostname=pieces.shift(),pieces.length?opts.port=pieces.pop():opts.port||(opts.port=this.secure?"443":"80")}this.agent=opts.agent||!1,this.hostname=opts.hostname||(global.location?location.hostname:"localhost"),this.port=opts.port||(global.location&&location.port?location.port:this.secure?443:80),this.query=opts.query||{},"string"==typeof this.query&&(this.query=parseqs.decode(this.query)),this.upgrade=!1!==opts.upgrade,this.path=(opts.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!opts.forceJSONP,this.jsonp=!1!==opts.jsonp,this.forceBase64=!!opts.forceBase64,this.enablesXDR=!!opts.enablesXDR,this.timestampParam=opts.timestampParam||"t",this.timestampRequests=opts.timestampRequests,this.transports=opts.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=opts.policyPort||843,this.rememberUpgrade=opts.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=opts.onlyBinaryUpgrades,this.pfx=opts.pfx||null,this.key=opts.key||null,this.passphrase=opts.passphrase||null,this.cert=opts.cert||null,this.ca=opts.ca||null,this.ciphers=opts.ciphers||null,this.rejectUnauthorized=opts.rejectUnauthorized||null,this.open()}function clone(obj){var o={};for(var i in obj)obj.hasOwnProperty(i)&&(o[i]=obj[i]);return o}var transports=_dereq_("./transports"),Emitter=_dereq_("component-emitter"),debug=_dereq_("debug")("engine.io-client:socket"),index=_dereq_("indexof"),parser=_dereq_("engine.io-parser"),parseuri=_dereq_("parseuri"),parsejson=_dereq_("parsejson"),parseqs=_dereq_("parseqs");module.exports=Socket,Socket.priorWebsocketSuccess=!1,Emitter(Socket.prototype),Socket.protocol=parser.protocol,Socket.Socket=Socket,Socket.Transport=_dereq_("./transport"),Socket.transports=_dereq_("./transports"),Socket.parser=_dereq_("engine.io-parser"),Socket.prototype.createTransport=function(name){debug('creating transport "%s"',name);var query=clone(this.query);query.EIO=parser.protocol,query.transport=name,this.id&&(query.sid=this.id);var transport=new transports[name]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:query,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return transport},Socket.prototype.open=function(){var transport;if(this.rememberUpgrade&&Socket.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))transport="websocket";else{if(0==this.transports.length){var self=this;return void setTimeout(function(){self.emit("error","No transports available")},0)}transport=this.transports[0]}this.readyState="opening";var transport;try{transport=this.createTransport(transport)}catch(e){return this.transports.shift(),void this.open()}transport.open(),this.setTransport(transport)},Socket.prototype.setTransport=function(transport){debug("setting transport %s",transport.name);var self=this;this.transport&&(debug("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=transport,transport.on("drain",function(){self.onDrain()}).on("packet",function(packet){self.onPacket(packet)}).on("error",function(e){self.onError(e)}).on("close",function(){self.onClose("transport close")})},Socket.prototype.probe=function(name){function onTransportOpen(){if(self.onlyBinaryUpgrades){var upgradeLosesBinary=!this.supportsBinary&&self.transport.supportsBinary;failed=failed||upgradeLosesBinary}failed||(debug('probe transport "%s" opened',name),transport.send([{type:"ping",data:"probe"}]),transport.once("packet",function(msg){if(!failed)if("pong"==msg.type&&"probe"==msg.data){if(debug('probe transport "%s" pong',name),self.upgrading=!0,self.emit("upgrading",transport),!transport)return;Socket.priorWebsocketSuccess="websocket"==transport.name,debug('pausing current transport "%s"',self.transport.name),self.transport.pause(function(){failed||"closed"!=self.readyState&&(debug("changing transport and sending upgrade packet"),cleanup(),self.setTransport(transport),transport.send([{type:"upgrade"}]),self.emit("upgrade",transport),transport=null,self.upgrading=!1,self.flush())})}else{debug('probe transport "%s" failed',name);var err=new Error("probe error");err.transport=transport.name,self.emit("upgradeError",err)}}))}function freezeTransport(){failed||(failed=!0,cleanup(),transport.close(),transport=null)}function onerror(err){var error=new Error("probe error: "+err);error.transport=transport.name,freezeTransport(),debug('probe transport "%s" failed because of error: %s',name,err),self.emit("upgradeError",error)}function onTransportClose(){onerror("transport closed")}function onclose(){onerror("socket closed")}function onupgrade(to){transport&&to.name!=transport.name&&(debug('"%s" works - aborting "%s"',to.name,transport.name),freezeTransport())}function cleanup(){transport.removeListener("open",onTransportOpen),transport.removeListener("error",onerror),transport.removeListener("close",onTransportClose),self.removeListener("close",onclose),self.removeListener("upgrading",onupgrade)}debug('probing transport "%s"',name);var transport=this.createTransport(name,{probe:1}),failed=!1,self=this;Socket.priorWebsocketSuccess=!1,transport.once("open",onTransportOpen),transport.once("error",onerror),transport.once("close",onTransportClose),this.once("close",onclose),this.once("upgrading",onupgrade),transport.open()},Socket.prototype.onOpen=function(){if(debug("socket open"),this.readyState="open",Socket.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){debug("starting upgrade probes");for(var i=0,l=this.upgrades.length;l>i;i++)this.probe(this.upgrades[i])}},Socket.prototype.onPacket=function(packet){if("opening"==this.readyState||"open"==this.readyState)switch(debug('socket receive: type "%s", data "%s"',packet.type,packet.data),this.emit("packet",packet),this.emit("heartbeat"),packet.type){case"open":this.onHandshake(parsejson(packet.data));break;case"pong":this.setPing();break;case"error":var err=new Error("server error");err.code=packet.data,this.emit("error",err);break;case"message":this.emit("data",packet.data),this.emit("message",packet.data)}else debug('packet received with socket readyState "%s"',this.readyState)},Socket.prototype.onHandshake=function(data){this.emit("handshake",data),this.id=data.sid,this.transport.query.sid=data.sid,this.upgrades=this.filterUpgrades(data.upgrades),this.pingInterval=data.pingInterval,this.pingTimeout=data.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},Socket.prototype.onHeartbeat=function(timeout){clearTimeout(this.pingTimeoutTimer);var self=this;self.pingTimeoutTimer=setTimeout(function(){"closed"!=self.readyState&&self.onClose("ping timeout")},timeout||self.pingInterval+self.pingTimeout)},Socket.prototype.setPing=function(){var self=this;clearTimeout(self.pingIntervalTimer),self.pingIntervalTimer=setTimeout(function(){debug("writing ping packet - expecting pong within %sms",self.pingTimeout),self.ping(),self.onHeartbeat(self.pingTimeout)},self.pingInterval)},Socket.prototype.ping=function(){this.sendPacket("ping")},Socket.prototype.onDrain=function(){for(var i=0;i<this.prevBufferLen;i++)this.callbackBuffer[i]&&this.callbackBuffer[i]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},Socket.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(debug("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},Socket.prototype.write=Socket.prototype.send=function(msg,fn){return this.sendPacket("message",msg,fn),this},Socket.prototype.sendPacket=function(type,data,fn){if("closing"!=this.readyState&&"closed"!=this.readyState){var packet={type:type,data:data};this.emit("packetCreate",packet),this.writeBuffer.push(packet),this.callbackBuffer.push(fn),this.flush()}},Socket.prototype.close=function(){function close(){self.onClose("forced close"),debug("socket closing - telling transport to close"),self.transport.close()}function cleanupAndClose(){self.removeListener("upgrade",cleanupAndClose),self.removeListener("upgradeError",cleanupAndClose),close()}function waitForUpgrade(){self.once("upgrade",cleanupAndClose),self.once("upgradeError",cleanupAndClose)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var self=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?waitForUpgrade():close()}):this.upgrading?waitForUpgrade():close()}return this},Socket.prototype.onError=function(err){debug("socket error %j",err),Socket.priorWebsocketSuccess=!1,this.emit("error",err),this.onClose("transport error",err)},Socket.prototype.onClose=function(reason,desc){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){debug('socket close with reason: "%s"',reason);var self=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){self.writeBuffer=[],self.callbackBuffer=[],self.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",reason,desc)}},Socket.prototype.filterUpgrades=function(upgrades){for(var filteredUpgrades=[],i=0,j=upgrades.length;j>i;i++)~index(this.transports,upgrades[i])&&filteredUpgrades.push(upgrades[i]);return filteredUpgrades}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:40,parsejson:32,parseqs:33,parseuri:34}],14:[function(_dereq_,module,exports){function Transport(opts){this.path=opts.path,this.hostname=opts.hostname,this.port=opts.port,this.secure=opts.secure,this.query=opts.query,this.timestampParam=opts.timestampParam,this.timestampRequests=opts.timestampRequests,this.readyState="",this.agent=opts.agent||!1,this.socket=opts.socket,this.enablesXDR=opts.enablesXDR,this.pfx=opts.pfx,this.key=opts.key,this.passphrase=opts.passphrase,this.cert=opts.cert,this.ca=opts.ca,this.ciphers=opts.ciphers,this.rejectUnauthorized=opts.rejectUnauthorized}var parser=_dereq_("engine.io-parser"),Emitter=_dereq_("component-emitter");module.exports=Transport,Emitter(Transport.prototype),Transport.timestamps=0,Transport.prototype.onError=function(msg,desc){var err=new Error(msg);return err.type="TransportError",err.description=desc,this.emit("error",err),this},Transport.prototype.open=function(){return("closed"==this.readyState||""==this.readyState)&&(this.readyState="opening",this.doOpen()),this},Transport.prototype.close=function(){return("opening"==this.readyState||"open"==this.readyState)&&(this.doClose(),this.onClose()),this},Transport.prototype.send=function(packets){if("open"!=this.readyState)throw new Error("Transport not open");this.write(packets)},Transport.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},Transport.prototype.onData=function(data){var packet=parser.decodePacket(data,this.socket.binaryType);this.onPacket(packet)},Transport.prototype.onPacket=function(packet){this.emit("packet",packet)},Transport.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(_dereq_,module,exports){(function(global){function polling(opts){var xhr,xd=!1,xs=!1,jsonp=!1!==opts.jsonp;if(global.location){var isSSL="https:"==location.protocol,port=location.port;port||(port=isSSL?443:80),xd=opts.hostname!=location.hostname||port!=opts.port,xs=opts.secure!=isSSL}if(opts.xdomain=xd,opts.xscheme=xs,xhr=new XMLHttpRequest(opts),"open"in xhr&&!opts.forceJSONP)return new XHR(opts);if(!jsonp)throw new Error("JSONP disabled");return new JSONP(opts)}var XMLHttpRequest=_dereq_("xmlhttprequest"),XHR=_dereq_("./polling-xhr"),JSONP=_dereq_("./polling-jsonp"),websocket=_dereq_("./websocket");exports.polling=polling,exports.websocket=websocket}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(_dereq_,module,exports){(function(global){function empty(){}function JSONPPolling(opts){Polling.call(this,opts),this.query=this.query||{},callbacks||(global.___eio||(global.___eio=[]),callbacks=global.___eio),this.index=callbacks.length;var self=this;callbacks.push(function(msg){self.onData(msg)}),this.query.j=this.index,global.document&&global.addEventListener&&global.addEventListener("beforeunload",function(){self.script&&(self.script.onerror=empty)},!1)}var Polling=_dereq_("./polling"),inherit=_dereq_("component-inherit");module.exports=JSONPPolling;var callbacks,rNewline=/\n/g,rEscapedNewline=/\\n/g;inherit(JSONPPolling,Polling),JSONPPolling.prototype.supportsBinary=!1,JSONPPolling.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),Polling.prototype.doClose.call(this)},JSONPPolling.prototype.doPoll=function(){var self=this,script=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),script.async=!0,script.src=this.uri(),script.onerror=function(e){self.onError("jsonp poll error",e)};var insertAt=document.getElementsByTagName("script")[0];insertAt.parentNode.insertBefore(script,insertAt),this.script=script;var isUAgecko="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);isUAgecko&&setTimeout(function(){var iframe=document.createElement("iframe");document.body.appendChild(iframe),document.body.removeChild(iframe)},100)},JSONPPolling.prototype.doWrite=function(data,fn){function complete(){initIframe(),fn()}function initIframe(){if(self.iframe)try{self.form.removeChild(self.iframe)}catch(e){self.onError("jsonp polling iframe removal error",e)}try{var html='<iframe src="javascript:0" name="'+self.iframeId+'">';iframe=document.createElement(html)}catch(e){iframe=document.createElement("iframe"),iframe.name=self.iframeId,iframe.src="javascript:0"}iframe.id=self.iframeId,self.form.appendChild(iframe),self.iframe=iframe}var self=this;if(!this.form){var iframe,form=document.createElement("form"),area=document.createElement("textarea"),id=this.iframeId="eio_iframe_"+this.index;form.className="socketio",form.style.position="absolute",form.style.top="-1000px",form.style.left="-1000px",form.target=id,form.method="POST",form.setAttribute("accept-charset","utf-8"),area.name="d",form.appendChild(area),document.body.appendChild(form),this.form=form,this.area=area}this.form.action=this.uri(),initIframe(),data=data.replace(rEscapedNewline,"\\\n"),this.area.value=data.replace(rNewline,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==self.iframe.readyState&&complete()}:this.iframe.onload=complete}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(_dereq_,module,exports){(function(global){function empty(){}function XHR(opts){if(Polling.call(this,opts),global.location){var isSSL="https:"==location.protocol,port=location.port;port||(port=isSSL?443:80),this.xd=opts.hostname!=global.location.hostname||port!=opts.port,this.xs=opts.secure!=isSSL}}function Request(opts){this.method=opts.method||"GET",this.uri=opts.uri,this.xd=!!opts.xd,this.xs=!!opts.xs,this.async=!1!==opts.async,this.data=void 0!=opts.data?opts.data:null,this.agent=opts.agent,this.isBinary=opts.isBinary,this.supportsBinary=opts.supportsBinary,this.enablesXDR=opts.enablesXDR,this.pfx=opts.pfx,this.key=opts.key,this.passphrase=opts.passphrase,this.cert=opts.cert,this.ca=opts.ca,this.ciphers=opts.ciphers,this.rejectUnauthorized=opts.rejectUnauthorized,this.create()}function unloadHandler(){for(var i in Request.requests)Request.requests.hasOwnProperty(i)&&Request.requests[i].abort()}var XMLHttpRequest=_dereq_("xmlhttprequest"),Polling=_dereq_("./polling"),Emitter=_dereq_("component-emitter"),inherit=_dereq_("component-inherit"),debug=_dereq_("debug")("engine.io-client:polling-xhr");module.exports=XHR,module.exports.Request=Request,inherit(XHR,Polling),XHR.prototype.supportsBinary=!0,XHR.prototype.request=function(opts){return opts=opts||{},opts.uri=this.uri(),opts.xd=this.xd,opts.xs=this.xs,opts.agent=this.agent||!1,opts.supportsBinary=this.supportsBinary,opts.enablesXDR=this.enablesXDR,opts.pfx=this.pfx,opts.key=this.key,opts.passphrase=this.passphrase,opts.cert=this.cert,opts.ca=this.ca,opts.ciphers=this.ciphers,opts.rejectUnauthorized=this.rejectUnauthorized,new Request(opts)},XHR.prototype.doWrite=function(data,fn){var isBinary="string"!=typeof data&&void 0!==data,req=this.request({method:"POST",data:data,isBinary:isBinary}),self=this;req.on("success",fn),req.on("error",function(err){self.onError("xhr post error",err)}),this.sendXhr=req},XHR.prototype.doPoll=function(){debug("xhr poll");var req=this.request(),self=this;req.on("data",function(data){self.onData(data)}),req.on("error",function(err){self.onError("xhr poll error",err)}),this.pollXhr=req},Emitter(Request.prototype),Request.prototype.create=function(){var opts={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};opts.pfx=this.pfx,opts.key=this.key,opts.passphrase=this.passphrase,opts.cert=this.cert,opts.ca=this.ca,opts.ciphers=this.ciphers,opts.rejectUnauthorized=this.rejectUnauthorized;var xhr=this.xhr=new XMLHttpRequest(opts),self=this;try{if(debug("xhr open %s: %s",this.method,this.uri),xhr.open(this.method,this.uri,this.async),this.supportsBinary&&(xhr.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?xhr.setRequestHeader("Content-type","application/octet-stream"):xhr.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}"withCredentials"in xhr&&(xhr.withCredentials=!0),this.hasXDR()?(xhr.onload=function(){self.onLoad()},xhr.onerror=function(){self.onError(xhr.responseText)}):xhr.onreadystatechange=function(){4==xhr.readyState&&(200==xhr.status||1223==xhr.status?self.onLoad():setTimeout(function(){self.onError(xhr.status)},0))},debug("xhr data %s",this.data),xhr.send(this.data)}catch(e){return void setTimeout(function(){self.onError(e)},0)}global.document&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)},Request.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},Request.prototype.onData=function(data){this.emit("data",data),this.onSuccess()},Request.prototype.onError=function(err){this.emit("error",err),this.cleanup(!0)},Request.prototype.cleanup=function(fromError){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=empty:this.xhr.onreadystatechange=empty,fromError)try{this.xhr.abort()}catch(e){}global.document&&delete Request.requests[this.index],this.xhr=null}},Request.prototype.onLoad=function(){var data;try{var contentType;try{contentType=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}data="application/octet-stream"===contentType?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(e){this.onError(e)}null!=data&&this.onData(data)},Request.prototype.hasXDR=function(){return"undefined"!=typeof global.XDomainRequest&&!this.xs&&this.enablesXDR},Request.prototype.abort=function(){this.cleanup()},global.document&&(Request.requestsCount=0,Request.requests={},global.attachEvent?global.attachEvent("onunload",unloadHandler):global.addEventListener&&global.addEventListener("beforeunload",unloadHandler,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(_dereq_,module,exports){function Polling(opts){var forceBase64=opts&&opts.forceBase64;(!hasXHR2||forceBase64)&&(this.supportsBinary=!1),Transport.call(this,opts)}var Transport=_dereq_("../transport"),parseqs=_dereq_("parseqs"),parser=_dereq_("engine.io-parser"),inherit=_dereq_("component-inherit"),debug=_dereq_("debug")("engine.io-client:polling");module.exports=Polling;var hasXHR2=function(){var XMLHttpRequest=_dereq_("xmlhttprequest"),xhr=new XMLHttpRequest({xdomain:!1});return null!=xhr.responseType}();inherit(Polling,Transport),Polling.prototype.name="polling",Polling.prototype.doOpen=function(){this.poll()},Polling.prototype.pause=function(onPause){function pause(){debug("paused"),self.readyState="paused",onPause()}var self=this;if(this.readyState="pausing",this.polling||!this.writable){var total=0;this.polling&&(debug("we are currently polling - waiting to pause"),total++,this.once("pollComplete",function(){debug("pre-pause polling complete"),--total||pause()})),this.writable||(debug("we are currently writing - waiting to pause"),total++,this.once("drain",function(){debug("pre-pause writing complete"),--total||pause()}))}else pause()},Polling.prototype.poll=function(){debug("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},Polling.prototype.onData=function(data){var self=this;debug("polling got data %s",data);var callback=function(packet,index,total){return"opening"==self.readyState&&self.onOpen(),"close"==packet.type?(self.onClose(),!1):void self.onPacket(packet)};parser.decodePayload(data,this.socket.binaryType,callback),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():debug('ignoring poll - transport state "%s"',this.readyState))},Polling.prototype.doClose=function(){function close(){debug("writing close packet"),self.write([{type:"close"}])}var self=this;"open"==this.readyState?(debug("transport open - closing"),close()):(debug("transport not open - deferring close"),this.once("open",close))},Polling.prototype.write=function(packets){var self=this;this.writable=!1;var callbackfn=function(){self.writable=!0,self.emit("drain")},self=this;parser.encodePayload(packets,this.supportsBinary,function(data){self.doWrite(data,callbackfn)})},Polling.prototype.uri=function(){var query=this.query||{},schema=this.secure?"https":"http",port="";return!1!==this.timestampRequests&&(query[this.timestampParam]=+new Date+"-"+Transport.timestamps++),this.supportsBinary||query.sid||(query.b64=1),query=parseqs.encode(query),this.port&&("https"==schema&&443!=this.port||"http"==schema&&80!=this.port)&&(port=":"+this.port),query.length&&(query="?"+query),schema+"://"+this.hostname+port+this.path+query}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:33,xmlhttprequest:20}],19:[function(_dereq_,module,exports){function WS(opts){var forceBase64=opts&&opts.forceBase64;forceBase64&&(this.supportsBinary=!1),Transport.call(this,opts)}var Transport=_dereq_("../transport"),parser=_dereq_("engine.io-parser"),parseqs=_dereq_("parseqs"),inherit=_dereq_("component-inherit"),debug=_dereq_("debug")("engine.io-client:websocket"),WebSocket=_dereq_("ws");module.exports=WS,inherit(WS,Transport),WS.prototype.name="websocket",WS.prototype.supportsBinary=!0,WS.prototype.doOpen=function(){if(this.check()){var uri=this.uri(),protocols=void 0,opts={agent:this.agent};opts.pfx=this.pfx,opts.key=this.key,opts.passphrase=this.passphrase,opts.cert=this.cert,opts.ca=this.ca,opts.ciphers=this.ciphers,opts.rejectUnauthorized=this.rejectUnauthorized,this.ws=new WebSocket(uri,protocols,opts),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},WS.prototype.addEventListeners=function(){var self=this;this.ws.onopen=function(){self.onOpen()},this.ws.onclose=function(){self.onClose()},this.ws.onmessage=function(ev){self.onData(ev.data)},this.ws.onerror=function(e){self.onError("websocket error",e)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(WS.prototype.onData=function(data){var self=this;setTimeout(function(){Transport.prototype.onData.call(self,data)},0)}),WS.prototype.write=function(packets){function ondrain(){self.writable=!0,self.emit("drain")}var self=this;this.writable=!1;for(var i=0,l=packets.length;l>i;i++)parser.encodePacket(packets[i],this.supportsBinary,function(data){try{self.ws.send(data)}catch(e){debug("websocket closed before onclose event")}});setTimeout(ondrain,0)},WS.prototype.onClose=function(){Transport.prototype.onClose.call(this)},WS.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},WS.prototype.uri=function(){var query=this.query||{},schema=this.secure?"wss":"ws",port="";return this.port&&("wss"==schema&&443!=this.port||"ws"==schema&&80!=this.port)&&(port=":"+this.port),this.timestampRequests&&(query[this.timestampParam]=+new Date),this.supportsBinary||(query.b64=1),query=parseqs.encode(query),query.length&&(query="?"+query),schema+"://"+this.hostname+port+this.path+query},WS.prototype.check=function(){return!(!WebSocket||"__initialize"in WebSocket&&this.name===WS.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:33,ws:35}],20:[function(_dereq_,module,exports){var hasCORS=_dereq_("has-cors");module.exports=function(opts){var xdomain=opts.xdomain,xscheme=opts.xscheme,enablesXDR=opts.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!xdomain||hasCORS))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!xscheme&&enablesXDR)return new XDomainRequest}catch(e){}if(!xdomain)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}},{"has-cors":38}],21:[function(_dereq_,module,exports){module.exports=function(a,b){var fn=function(){};fn.prototype=b.prototype,a.prototype=new fn,a.prototype.constructor=a}},{}],22:[function(_dereq_,module,exports){function useColors(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function formatArgs(){var args=arguments,useColors=this.useColors;if(args[0]=(useColors?"%c":"")+this.namespace+(useColors?" %c":" ")+args[0]+(useColors?"%c ":" ")+"+"+exports.humanize(this.diff),!useColors)return args;var c="color: "+this.color;args=[args[0],c,"color: inherit"].concat(Array.prototype.slice.call(args,1));var index=0,lastC=0;return args[0].replace(/%[a-z%]/g,function(match){"%%"!==match&&(index++,"%c"===match&&(lastC=index))}),args.splice(lastC,0,c),args}function log(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(namespaces){try{null==namespaces?localStorage.removeItem("debug"):localStorage.debug=namespaces}catch(e){}}function load(){var r;try{r=localStorage.debug}catch(e){}return r}exports=module.exports=_dereq_("./debug"),exports.log=log,exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors,exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],exports.formatters.j=function(v){return JSON.stringify(v)},exports.enable(load())},{"./debug":23}],23:[function(_dereq_,module,exports){function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(namespace){function disabled(){}function enabled(){var self=enabled,curr=+new Date,ms=curr-(prevTime||curr);self.diff=ms,self.prev=prevTime,self.curr=curr,prevTime=curr,null==self.useColors&&(self.useColors=exports.useColors()),null==self.color&&self.useColors&&(self.color=selectColor());var args=Array.prototype.slice.call(arguments);args[0]=exports.coerce(args[0]),"string"!=typeof args[0]&&(args=["%o"].concat(args));var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if("%%"===match)return match;index++;var formatter=exports.formatters[format];if("function"==typeof formatter){var val=args[index];match=formatter.call(self,val),args.splice(index,1),index--}return match}),"function"==typeof exports.formatArgs&&(args=exports.formatArgs.apply(self,args));var logFn=enabled.log||exports.log||console.log.bind(console);logFn.apply(self,args)}disabled.enabled=!1,enabled.enabled=!0;var fn=exports.enabled(namespace)?enabled:disabled;return fn.namespace=namespace,fn}function enable(namespaces){exports.save(namespaces);for(var split=(namespaces||"").split(/[\s,]+/),len=split.length,i=0;len>i;i++)split[i]&&(namespaces=split[i].replace(/\*/g,".*?"),"-"===namespaces[0]?exports.skips.push(new RegExp("^"+namespaces.substr(1)+"$")):exports.names.push(new RegExp("^"+namespaces+"$")));
}function disable(){exports.enable("")}function enabled(name){var i,len;for(i=0,len=exports.skips.length;len>i;i++)if(exports.skips[i].test(name))return!1;for(i=0,len=exports.names.length;len>i;i++)if(exports.names[i].test(name))return!0;return!1}function coerce(val){return val instanceof Error?val.stack||val.message:val}exports=module.exports=debug,exports.coerce=coerce,exports.disable=disable,exports.enable=enable,exports.enabled=enabled,exports.humanize=_dereq_("ms"),exports.names=[],exports.skips=[],exports.formatters={};var prevTime,prevColor=0},{ms:24}],24:[function(_dereq_,module,exports){function parse(str){var match=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(str);if(match){var n=parseFloat(match[1]),type=(match[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"y":return n*y;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"h":return n*h;case"minutes":case"minute":case"m":return n*m;case"seconds":case"second":case"s":return n*s;case"ms":return n}}}function short(ms){return ms>=d?Math.round(ms/d)+"d":ms>=h?Math.round(ms/h)+"h":ms>=m?Math.round(ms/m)+"m":ms>=s?Math.round(ms/s)+"s":ms+"ms"}function long(ms){return plural(ms,d,"day")||plural(ms,h,"hour")||plural(ms,m,"minute")||plural(ms,s,"second")||ms+" ms"}function plural(ms,n,name){return n>ms?void 0:1.5*n>ms?Math.floor(ms/n)+" "+name:Math.ceil(ms/n)+" "+name+"s"}var s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;module.exports=function(val,options){return options=options||{},"string"==typeof val?parse(val):options["long"]?long(val):short(val)}},{}],25:[function(_dereq_,module,exports){(function(global){function encodeBase64Object(packet,callback){var message="b"+exports.packets[packet.type]+packet.data.data;return callback(message)}function encodeArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary)return exports.encodeBase64Packet(packet,callback);var data=packet.data,contentArray=new Uint8Array(data),resultBuffer=new Uint8Array(1+data.byteLength);resultBuffer[0]=packets[packet.type];for(var i=0;i<contentArray.length;i++)resultBuffer[i+1]=contentArray[i];return callback(resultBuffer.buffer)}function encodeBlobAsArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary)return exports.encodeBase64Packet(packet,callback);var fr=new FileReader;return fr.onload=function(){packet.data=fr.result,exports.encodePacket(packet,supportsBinary,!0,callback)},fr.readAsArrayBuffer(packet.data)}function encodeBlob(packet,supportsBinary,callback){if(!supportsBinary)return exports.encodeBase64Packet(packet,callback);if(dontSendBlobs)return encodeBlobAsArrayBuffer(packet,supportsBinary,callback);var length=new Uint8Array(1);length[0]=packets[packet.type];var blob=new Blob([length.buffer,packet.data]);return callback(blob)}function map(ary,each,done){for(var result=new Array(ary.length),next=after(ary.length,done),eachWithIndex=function(i,el,cb){each(el,function(error,msg){result[i]=msg,cb(error,result)})},i=0;i<ary.length;i++)eachWithIndex(i,ary[i],next)}var keys=_dereq_("./keys"),hasBinary=_dereq_("has-binary"),sliceBuffer=_dereq_("arraybuffer.slice"),base64encoder=_dereq_("base64-arraybuffer"),after=_dereq_("after"),utf8=_dereq_("utf8"),isAndroid=navigator.userAgent.match(/Android/i),isPhantomJS=/PhantomJS/i.test(navigator.userAgent),dontSendBlobs=isAndroid||isPhantomJS;exports.protocol=3;var packets=exports.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},packetslist=keys(packets),err={type:"error",data:"parser error"},Blob=_dereq_("blob");exports.encodePacket=function(packet,supportsBinary,utf8encode,callback){"function"==typeof supportsBinary&&(callback=supportsBinary,supportsBinary=!1),"function"==typeof utf8encode&&(callback=utf8encode,utf8encode=null);var data=void 0===packet.data?void 0:packet.data.buffer||packet.data;if(global.ArrayBuffer&&data instanceof ArrayBuffer)return encodeArrayBuffer(packet,supportsBinary,callback);if(Blob&&data instanceof global.Blob)return encodeBlob(packet,supportsBinary,callback);if(data&&data.base64)return encodeBase64Object(packet,callback);var encoded=packets[packet.type];return void 0!==packet.data&&(encoded+=utf8encode?utf8.encode(String(packet.data)):String(packet.data)),callback(""+encoded)},exports.encodeBase64Packet=function(packet,callback){var message="b"+exports.packets[packet.type];if(Blob&&packet.data instanceof Blob){var fr=new FileReader;return fr.onload=function(){var b64=fr.result.split(",")[1];callback(message+b64)},fr.readAsDataURL(packet.data)}var b64data;try{b64data=String.fromCharCode.apply(null,new Uint8Array(packet.data))}catch(e){for(var typed=new Uint8Array(packet.data),basic=new Array(typed.length),i=0;i<typed.length;i++)basic[i]=typed[i];b64data=String.fromCharCode.apply(null,basic)}return message+=global.btoa(b64data),callback(message)},exports.decodePacket=function(data,binaryType,utf8decode){if("string"==typeof data||void 0===data){if("b"==data.charAt(0))return exports.decodeBase64Packet(data.substr(1),binaryType);if(utf8decode)try{data=utf8.decode(data)}catch(e){return err}var type=data.charAt(0);return Number(type)==type&&packetslist[type]?data.length>1?{type:packetslist[type],data:data.substring(1)}:{type:packetslist[type]}:err}var asArray=new Uint8Array(data),type=asArray[0],rest=sliceBuffer(data,1);return Blob&&"blob"===binaryType&&(rest=new Blob([rest])),{type:packetslist[type],data:rest}},exports.decodeBase64Packet=function(msg,binaryType){var type=packetslist[msg.charAt(0)];if(!global.ArrayBuffer)return{type:type,data:{base64:!0,data:msg.substr(1)}};var data=base64encoder.decode(msg.substr(1));return"blob"===binaryType&&Blob&&(data=new Blob([data])),{type:type,data:data}},exports.encodePayload=function(packets,supportsBinary,callback){function setLengthHeader(message){return message.length+":"+message}function encodeOne(packet,doneCallback){exports.encodePacket(packet,isBinary?supportsBinary:!1,!0,function(message){doneCallback(null,setLengthHeader(message))})}"function"==typeof supportsBinary&&(callback=supportsBinary,supportsBinary=null);var isBinary=hasBinary(packets);return supportsBinary&&isBinary?Blob&&!dontSendBlobs?exports.encodePayloadAsBlob(packets,callback):exports.encodePayloadAsArrayBuffer(packets,callback):packets.length?void map(packets,encodeOne,function(err,results){return callback(results.join(""))}):callback("0:")},exports.decodePayload=function(data,binaryType,callback){if("string"!=typeof data)return exports.decodePayloadAsBinary(data,binaryType,callback);"function"==typeof binaryType&&(callback=binaryType,binaryType=null);var packet;if(""==data)return callback(err,0,1);for(var n,msg,length="",i=0,l=data.length;l>i;i++){var chr=data.charAt(i);if(":"!=chr)length+=chr;else{if(""==length||length!=(n=Number(length)))return callback(err,0,1);if(msg=data.substr(i+1,n),length!=msg.length)return callback(err,0,1);if(msg.length){if(packet=exports.decodePacket(msg,binaryType,!0),err.type==packet.type&&err.data==packet.data)return callback(err,0,1);var ret=callback(packet,i+n,l);if(!1===ret)return}i+=n,length=""}}return""!=length?callback(err,0,1):void 0},exports.encodePayloadAsArrayBuffer=function(packets,callback){function encodeOne(packet,doneCallback){exports.encodePacket(packet,!0,!0,function(data){return doneCallback(null,data)})}return packets.length?void map(packets,encodeOne,function(err,encodedPackets){var totalLength=encodedPackets.reduce(function(acc,p){var len;return len="string"==typeof p?p.length:p.byteLength,acc+len.toString().length+len+2},0),resultArray=new Uint8Array(totalLength),bufferIndex=0;return encodedPackets.forEach(function(p){var isString="string"==typeof p,ab=p;if(isString){for(var view=new Uint8Array(p.length),i=0;i<p.length;i++)view[i]=p.charCodeAt(i);ab=view.buffer}isString?resultArray[bufferIndex++]=0:resultArray[bufferIndex++]=1;for(var lenStr=ab.byteLength.toString(),i=0;i<lenStr.length;i++)resultArray[bufferIndex++]=parseInt(lenStr[i]);resultArray[bufferIndex++]=255;for(var view=new Uint8Array(ab),i=0;i<view.length;i++)resultArray[bufferIndex++]=view[i]}),callback(resultArray.buffer)}):callback(new ArrayBuffer(0))},exports.encodePayloadAsBlob=function(packets,callback){function encodeOne(packet,doneCallback){exports.encodePacket(packet,!0,!0,function(encoded){var binaryIdentifier=new Uint8Array(1);if(binaryIdentifier[0]=1,"string"==typeof encoded){for(var view=new Uint8Array(encoded.length),i=0;i<encoded.length;i++)view[i]=encoded.charCodeAt(i);encoded=view.buffer,binaryIdentifier[0]=0}for(var len=encoded instanceof ArrayBuffer?encoded.byteLength:encoded.size,lenStr=len.toString(),lengthAry=new Uint8Array(lenStr.length+1),i=0;i<lenStr.length;i++)lengthAry[i]=parseInt(lenStr[i]);if(lengthAry[lenStr.length]=255,Blob){var blob=new Blob([binaryIdentifier.buffer,lengthAry.buffer,encoded]);doneCallback(null,blob)}})}map(packets,encodeOne,function(err,results){return callback(new Blob(results))})},exports.decodePayloadAsBinary=function(data,binaryType,callback){"function"==typeof binaryType&&(callback=binaryType,binaryType=null);for(var bufferTail=data,buffers=[],numberTooLong=!1;bufferTail.byteLength>0;){for(var tailArray=new Uint8Array(bufferTail),isString=0===tailArray[0],msgLength="",i=1;255!=tailArray[i];i++){if(msgLength.length>310){numberTooLong=!0;break}msgLength+=tailArray[i]}if(numberTooLong)return callback(err,0,1);bufferTail=sliceBuffer(bufferTail,2+msgLength.length),msgLength=parseInt(msgLength);var msg=sliceBuffer(bufferTail,0,msgLength);if(isString)try{msg=String.fromCharCode.apply(null,new Uint8Array(msg))}catch(e){var typed=new Uint8Array(msg);msg="";for(var i=0;i<typed.length;i++)msg+=String.fromCharCode(typed[i])}buffers.push(msg),bufferTail=sliceBuffer(bufferTail,msgLength)}var total=buffers.length;buffers.forEach(function(buffer,i){callback(exports.decodePacket(buffer,binaryType,!0),i,total)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":36,utf8:31}],26:[function(_dereq_,module,exports){module.exports=Object.keys||function(obj){var arr=[],has=Object.prototype.hasOwnProperty;for(var i in obj)has.call(obj,i)&&arr.push(i);return arr}},{}],27:[function(_dereq_,module,exports){function after(count,callback,err_cb){function proxy(err,result){if(proxy.count<=0)throw new Error("after called too many times");--proxy.count,err?(bail=!0,callback(err),callback=err_cb):0!==proxy.count||bail||callback(null,result)}var bail=!1;return err_cb=err_cb||noop,proxy.count=count,0===count?callback():proxy}function noop(){}module.exports=after},{}],28:[function(_dereq_,module,exports){module.exports=function(arraybuffer,start,end){var bytes=arraybuffer.byteLength;if(start=start||0,end=end||bytes,arraybuffer.slice)return arraybuffer.slice(start,end);if(0>start&&(start+=bytes),0>end&&(end+=bytes),end>bytes&&(end=bytes),start>=bytes||start>=end||0===bytes)return new ArrayBuffer(0);for(var abv=new Uint8Array(arraybuffer),result=new Uint8Array(end-start),i=start,ii=0;end>i;i++,ii++)result[ii]=abv[i];return result.buffer}},{}],29:[function(_dereq_,module,exports){!function(chars){"use strict";exports.encode=function(arraybuffer){var i,bytes=new Uint8Array(arraybuffer),len=bytes.length,base64="";for(i=0;len>i;i+=3)base64+=chars[bytes[i]>>2],base64+=chars[(3&bytes[i])<<4|bytes[i+1]>>4],base64+=chars[(15&bytes[i+1])<<2|bytes[i+2]>>6],base64+=chars[63&bytes[i+2]];return len%3===2?base64=base64.substring(0,base64.length-1)+"=":len%3===1&&(base64=base64.substring(0,base64.length-2)+"=="),base64},exports.decode=function(base64){var i,encoded1,encoded2,encoded3,encoded4,bufferLength=.75*base64.length,len=base64.length,p=0;"="===base64[base64.length-1]&&(bufferLength--,"="===base64[base64.length-2]&&bufferLength--);var arraybuffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(arraybuffer);for(i=0;len>i;i+=4)encoded1=chars.indexOf(base64[i]),encoded2=chars.indexOf(base64[i+1]),encoded3=chars.indexOf(base64[i+2]),encoded4=chars.indexOf(base64[i+3]),bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return arraybuffer}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(_dereq_,module,exports){(function(global){function mapArrayBufferViews(ary){for(var i=0;i<ary.length;i++){var chunk=ary[i];if(chunk.buffer instanceof ArrayBuffer){var buf=chunk.buffer;if(chunk.byteLength!==buf.byteLength){var copy=new Uint8Array(chunk.byteLength);copy.set(new Uint8Array(buf,chunk.byteOffset,chunk.byteLength)),buf=copy.buffer}ary[i]=buf}}}function BlobBuilderConstructor(ary,options){options=options||{};var bb=new BlobBuilder;mapArrayBufferViews(ary);for(var i=0;i<ary.length;i++)bb.append(ary[i]);return options.type?bb.getBlob(options.type):bb.getBlob()}function BlobConstructor(ary,options){return mapArrayBufferViews(ary),new Blob(ary,options||{})}var BlobBuilder=global.BlobBuilder||global.WebKitBlobBuilder||global.MSBlobBuilder||global.MozBlobBuilder,blobSupported=function(){try{var a=new Blob(["hi"]);return 2===a.size}catch(e){return!1}}(),blobSupportsArrayBufferView=blobSupported&&function(){try{var b=new Blob([new Uint8Array([1,2])]);return 2===b.size}catch(e){return!1}}(),blobBuilderSupported=BlobBuilder&&BlobBuilder.prototype.append&&BlobBuilder.prototype.getBlob;module.exports=function(){return blobSupported?blobSupportsArrayBufferView?global.Blob:BlobConstructor:blobBuilderSupported?BlobBuilderConstructor:void 0}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(_dereq_,module,exports){(function(global){!function(root){function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;length>counter;)value=string.charCodeAt(counter++),value>=55296&&56319>=value&&length>counter?(extra=string.charCodeAt(counter++),56320==(64512&extra)?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--)):output.push(value);return output}function ucs2encode(array){for(var value,length=array.length,index=-1,output="";++index<length;)value=array[index],value>65535&&(value-=65536,output+=stringFromCharCode(value>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value);return output}function checkScalarValue(codePoint){if(codePoint>=55296&&57343>=codePoint)throw Error("Lone surrogate U+"+codePoint.toString(16).toUpperCase()+" is not a scalar value")}function createByte(codePoint,shift){return stringFromCharCode(codePoint>>shift&63|128)}function encodeCodePoint(codePoint){if(0==(4294967168&codePoint))return stringFromCharCode(codePoint);var symbol="";return 0==(4294965248&codePoint)?symbol=stringFromCharCode(codePoint>>6&31|192):0==(4294901760&codePoint)?(checkScalarValue(codePoint),symbol=stringFromCharCode(codePoint>>12&15|224),symbol+=createByte(codePoint,6)):0==(4292870144&codePoint)&&(symbol=stringFromCharCode(codePoint>>18&7|240),symbol+=createByte(codePoint,12),symbol+=createByte(codePoint,6)),symbol+=stringFromCharCode(63&codePoint|128)}function utf8encode(string){for(var codePoint,codePoints=ucs2decode(string),length=codePoints.length,index=-1,byteString="";++index<length;)codePoint=codePoints[index],byteString+=encodeCodePoint(codePoint);return byteString}function readContinuationByte(){if(byteIndex>=byteCount)throw Error("Invalid byte index");var continuationByte=255&byteArray[byteIndex];if(byteIndex++,128==(192&continuationByte))return 63&continuationByte;throw Error("Invalid continuation byte")}function decodeSymbol(){var byte1,byte2,byte3,byte4,codePoint;if(byteIndex>byteCount)throw Error("Invalid byte index");if(byteIndex==byteCount)return!1;if(byte1=255&byteArray[byteIndex],byteIndex++,0==(128&byte1))return byte1;if(192==(224&byte1)){var byte2=readContinuationByte();if(codePoint=(31&byte1)<<6|byte2,codePoint>=128)return codePoint;throw Error("Invalid continuation byte")}if(224==(240&byte1)){if(byte2=readContinuationByte(),byte3=readContinuationByte(),codePoint=(15&byte1)<<12|byte2<<6|byte3,codePoint>=2048)return checkScalarValue(codePoint),codePoint;throw Error("Invalid continuation byte")}if(240==(248&byte1)&&(byte2=readContinuationByte(),byte3=readContinuationByte(),byte4=readContinuationByte(),codePoint=(15&byte1)<<18|byte2<<12|byte3<<6|byte4,codePoint>=65536&&1114111>=codePoint))return codePoint;throw Error("Invalid UTF-8 detected")}function utf8decode(byteString){byteArray=ucs2decode(byteString),byteCount=byteArray.length,byteIndex=0;for(var tmp,codePoints=[];(tmp=decodeSymbol())!==!1;)codePoints.push(tmp);return ucs2encode(codePoints)}var freeExports="object"==typeof exports&&exports,freeModule="object"==typeof module&&module&&module.exports==freeExports&&module,freeGlobal="object"==typeof global&&global;(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal)&&(root=freeGlobal);var byteArray,byteCount,byteIndex,stringFromCharCode=String.fromCharCode,utf8={version:"2.0.0",encode:utf8encode,decode:utf8decode};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return utf8});else if(freeExports&&!freeExports.nodeType)if(freeModule)freeModule.exports=utf8;else{var object={},hasOwnProperty=object.hasOwnProperty;for(var key in utf8)hasOwnProperty.call(utf8,key)&&(freeExports[key]=utf8[key])}else root.utf8=utf8}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],32:[function(_dereq_,module,exports){(function(global){var rvalidchars=/^[\],:{}\s]*$/,rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rtrimLeft=/^\s+/,rtrimRight=/\s+$/;module.exports=function(data){return"string"==typeof data&&data?(data=data.replace(rtrimLeft,"").replace(rtrimRight,""),global.JSON&&JSON.parse?JSON.parse(data):rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))?new Function("return "+data)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(_dereq_,module,exports){exports.encode=function(obj){var str="";for(var i in obj)obj.hasOwnProperty(i)&&(str.length&&(str+="&"),str+=encodeURIComponent(i)+"="+encodeURIComponent(obj[i]));return str},exports.decode=function(qs){for(var qry={},pairs=qs.split("&"),i=0,l=pairs.length;l>i;i++){var pair=pairs[i].split("=");qry[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1])}return qry}},{}],34:[function(_dereq_,module,exports){var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];module.exports=function(str){var src=str,b=str.indexOf("["),e=str.indexOf("]");-1!=b&&-1!=e&&(str=str.substring(0,b)+str.substring(b,e).replace(/:/g,";")+str.substring(e,str.length));for(var m=re.exec(str||""),uri={},i=14;i--;)uri[parts[i]]=m[i]||"";return-1!=b&&-1!=e&&(uri.source=src,uri.host=uri.host.substring(1,uri.host.length-1).replace(/;/g,":"),uri.authority=uri.authority.replace("[","").replace("]","").replace(/;/g,":"),uri.ipv6uri=!0),uri}},{}],35:[function(_dereq_,module,exports){function ws(uri,protocols,opts){var instance;return instance=protocols?new WebSocket(uri,protocols):new WebSocket(uri)}var global=function(){return this}(),WebSocket=global.WebSocket||global.MozWebSocket;module.exports=WebSocket?ws:null,WebSocket&&(ws.prototype=WebSocket.prototype)},{}],36:[function(_dereq_,module,exports){(function(global){function hasBinary(data){function _hasBinary(obj){if(!obj)return!1;if(global.Buffer&&global.Buffer.isBuffer(obj)||global.ArrayBuffer&&obj instanceof ArrayBuffer||global.Blob&&obj instanceof Blob||global.File&&obj instanceof File)return!0;if(isArray(obj)){for(var i=0;i<obj.length;i++)if(_hasBinary(obj[i]))return!0}else if(obj&&"object"==typeof obj){obj.toJSON&&(obj=obj.toJSON());for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)&&_hasBinary(obj[key]))return!0}return!1}return _hasBinary(data)}var isArray=_dereq_("isarray");module.exports=hasBinary}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:37}],37:[function(_dereq_,module,exports){module.exports=Array.isArray||function(arr){return"[object Array]"==Object.prototype.toString.call(arr)}},{}],38:[function(_dereq_,module,exports){var global=_dereq_("global");try{module.exports="XMLHttpRequest"in global&&"withCredentials"in new global.XMLHttpRequest}catch(err){module.exports=!1}},{global:39}],39:[function(_dereq_,module,exports){module.exports=function(){return this}()},{}],40:[function(_dereq_,module,exports){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1}},{}],41:[function(_dereq_,module,exports){var has=Object.prototype.hasOwnProperty;exports.keys=Object.keys||function(obj){var keys=[];for(var key in obj)has.call(obj,key)&&keys.push(key);return keys},exports.values=function(obj){var vals=[];for(var key in obj)has.call(obj,key)&&vals.push(obj[key]);return vals},exports.merge=function(a,b){for(var key in b)has.call(b,key)&&(a[key]=b[key]);return a},exports.length=function(obj){return exports.keys(obj).length},exports.isEmpty=function(obj){return 0==exports.length(obj)}},{}],42:[function(_dereq_,module,exports){var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];module.exports=function(str){for(var m=re.exec(str||""),uri={},i=14;i--;)uri[parts[i]]=m[i]||"";return uri}},{}],43:[function(_dereq_,module,exports){(function(global){var isArray=_dereq_("isarray"),isBuf=_dereq_("./is-buffer");exports.deconstructPacket=function(packet){function _deconstructPacket(data){if(!data)return data;if(isBuf(data)){var placeholder={_placeholder:!0,num:buffers.length};return buffers.push(data),placeholder}if(isArray(data)){for(var newData=new Array(data.length),i=0;i<data.length;i++)newData[i]=_deconstructPacket(data[i]);return newData}if("object"==typeof data&&!(data instanceof Date)){var newData={};for(var key in data)newData[key]=_deconstructPacket(data[key]);return newData}return data}var buffers=[],packetData=packet.data,pack=packet;return pack.data=_deconstructPacket(packetData),pack.attachments=buffers.length,{packet:pack,buffers:buffers}},exports.reconstructPacket=function(packet,buffers){function _reconstructPacket(data){if(data&&data._placeholder){var buf=buffers[data.num];return buf}if(isArray(data)){for(var i=0;i<data.length;i++)data[i]=_reconstructPacket(data[i]);return data}if(data&&"object"==typeof data){for(var key in data)data[key]=_reconstructPacket(data[key]);return data}return data}return packet.data=_reconstructPacket(packet.data),packet.attachments=void 0,packet},exports.removeBlobs=function(data,callback){function _removeBlobs(obj,curKey,containingObject){if(!obj)return obj;if(global.Blob&&obj instanceof Blob||global.File&&obj instanceof File){pendingBlobs++;var fileReader=new FileReader;fileReader.onload=function(){containingObject?containingObject[curKey]=this.result:bloblessData=this.result,--pendingBlobs||callback(bloblessData)},fileReader.readAsArrayBuffer(obj)}else if(isArray(obj))for(var i=0;i<obj.length;i++)_removeBlobs(obj[i],i,obj);else if(obj&&"object"==typeof obj&&!isBuf(obj))for(var key in obj)_removeBlobs(obj[key],key,obj)}var pendingBlobs=0,bloblessData=data;_removeBlobs(bloblessData),pendingBlobs||callback(bloblessData)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":45,isarray:46}],44:[function(_dereq_,module,exports){function Encoder(){}function encodeAsString(obj){var str="",nsp=!1;return str+=obj.type,(exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type)&&(str+=obj.attachments,str+="-"),obj.nsp&&"/"!=obj.nsp&&(nsp=!0,str+=obj.nsp),null!=obj.id&&(nsp&&(str+=",",nsp=!1),str+=obj.id),null!=obj.data&&(nsp&&(str+=","),str+=json.stringify(obj.data)),debug("encoded %j as %s",obj,str),str}function encodeAsBinary(obj,callback){function writeEncoding(bloblessData){var deconstruction=binary.deconstructPacket(bloblessData),pack=encodeAsString(deconstruction.packet),buffers=deconstruction.buffers;buffers.unshift(pack),callback(buffers)}binary.removeBlobs(obj,writeEncoding)}function Decoder(){this.reconstructor=null}function decodeString(str){var p={},i=0;if(p.type=Number(str.charAt(0)),null==exports.types[p.type])return error();if(exports.BINARY_EVENT==p.type||exports.BINARY_ACK==p.type){for(var buf="";"-"!=str.charAt(++i)&&(buf+=str.charAt(i),i!=str.length););if(buf!=Number(buf)||"-"!=str.charAt(i))throw new Error("Illegal attachments");p.attachments=Number(buf)}if("/"==str.charAt(i+1))for(p.nsp="";++i;){var c=str.charAt(i);if(","==c)break;if(p.nsp+=c,i==str.length)break}else p.nsp="/";var next=str.charAt(i+1);if(""!==next&&Number(next)==next){for(p.id="";++i;){var c=str.charAt(i);if(null==c||Number(c)!=c){--i;break}if(p.id+=str.charAt(i),i==str.length)break}p.id=Number(p.id)}if(str.charAt(++i))try{p.data=json.parse(str.substr(i))}catch(e){return error()}return debug("decoded %s as %j",str,p),p}function BinaryReconstructor(packet){this.reconPack=packet,this.buffers=[]}function error(data){return{type:exports.ERROR,data:"parser error"}}var debug=_dereq_("debug")("socket.io-parser"),json=_dereq_("json3"),Emitter=(_dereq_("isarray"),_dereq_("component-emitter")),binary=_dereq_("./binary"),isBuf=_dereq_("./is-buffer");exports.protocol=4,exports.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],exports.CONNECT=0,exports.DISCONNECT=1,exports.EVENT=2,exports.ACK=3,exports.ERROR=4,exports.BINARY_EVENT=5,exports.BINARY_ACK=6,exports.Encoder=Encoder,exports.Decoder=Decoder,Encoder.prototype.encode=function(obj,callback){if(debug("encoding packet %j",obj),exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type)encodeAsBinary(obj,callback);else{var encoding=encodeAsString(obj);callback([encoding])}},Emitter(Decoder.prototype),Decoder.prototype.add=function(obj){var packet;if("string"==typeof obj)packet=decodeString(obj),exports.BINARY_EVENT==packet.type||exports.BINARY_ACK==packet.type?(this.reconstructor=new BinaryReconstructor(packet),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",packet)):this.emit("decoded",packet);else{if(!isBuf(obj)&&!obj.base64)throw new Error("Unknown type: "+obj);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");packet=this.reconstructor.takeBinaryData(obj),packet&&(this.reconstructor=null,this.emit("decoded",packet))}},Decoder.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},BinaryReconstructor.prototype.takeBinaryData=function(binData){if(this.buffers.push(binData),this.buffers.length==this.reconPack.attachments){var packet=binary.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),packet}return null},BinaryReconstructor.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":43,"./is-buffer":45,"component-emitter":9,debug:10,isarray:46,json3:47}],45:[function(_dereq_,module,exports){(function(global){function isBuf(obj){return global.Buffer&&global.Buffer.isBuffer(obj)||global.ArrayBuffer&&obj instanceof ArrayBuffer}module.exports=isBuf}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(_dereq_,module,exports){module.exports=_dereq_(37)},{}],47:[function(_dereq_,module,exports){!function(window){function has(name){if(has[name]!==undef)return has[name];var isSupported;if("bug-string-char-index"==name)isSupported="a"!="a"[0];else if("json"==name)isSupported=has("json-stringify")&&has("json-parse");else{var value,serialized='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==name){var stringify=JSON3.stringify,stringifySupported="function"==typeof stringify&&isExtended;if(stringifySupported){(value=function(){return 1}).toJSON=value;try{stringifySupported="0"===stringify(0)&&"0"===stringify(new Number)&&'""'==stringify(new String)&&stringify(getClass)===undef&&stringify(undef)===undef&&stringify()===undef&&"1"===stringify(value)&&"[1]"==stringify([value])&&"[null]"==stringify([undef])&&"null"==stringify(null)&&"[null,null,null]"==stringify([undef,getClass,null])&&stringify({a:[value,!0,!1,null,"\x00\b\n\f\r	"]})==serialized&&"1"===stringify(null,value)&&"[\n 1,\n 2\n]"==stringify([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==stringify(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==stringify(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==stringify(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==stringify(new Date(-1))}catch(exception){stringifySupported=!1}}isSupported=stringifySupported}if("json-parse"==name){var parse=JSON3.parse;if("function"==typeof parse)try{if(0===parse("0")&&!parse(!1)){value=parse(serialized);var parseSupported=5==value.a.length&&1===value.a[0];if(parseSupported){try{parseSupported=!parse('"	"')}catch(exception){}if(parseSupported)try{parseSupported=1!==parse("01")}catch(exception){}if(parseSupported)try{parseSupported=1!==parse("1.")}catch(exception){}}}}catch(exception){parseSupported=!1}isSupported=parseSupported}}return has[name]=!!isSupported}var isProperty,forEach,undef,getClass={}.toString,isLoader="function"==typeof define&&define.amd,nativeJSON="object"==typeof JSON&&JSON,JSON3="object"==typeof exports&&exports&&!exports.nodeType&&exports;JSON3&&nativeJSON?(JSON3.stringify=nativeJSON.stringify,JSON3.parse=nativeJSON.parse):JSON3=window.JSON=nativeJSON||{};var isExtended=new Date(-0xc782b5b800cec);try{isExtended=-109252==isExtended.getUTCFullYear()&&0===isExtended.getUTCMonth()&&1===isExtended.getUTCDate()&&10==isExtended.getUTCHours()&&37==isExtended.getUTCMinutes()&&6==isExtended.getUTCSeconds()&&708==isExtended.getUTCMilliseconds()}catch(exception){}if(!has("json")){var functionClass="[object Function]",dateClass="[object Date]",numberClass="[object Number]",stringClass="[object String]",arrayClass="[object Array]",booleanClass="[object Boolean]",charIndexBuggy=has("bug-string-char-index");if(!isExtended)var floor=Math.floor,Months=[0,31,59,90,120,151,181,212,243,273,304,334],getDay=function(year,month){return Months[month]+365*(year-1970)+floor((year-1969+(month=+(month>1)))/4)-floor((year-1901+month)/100)+floor((year-1601+month)/400)};(isProperty={}.hasOwnProperty)||(isProperty=function(property){var constructor,members={};return(members.__proto__=null,members.__proto__={toString:1},members).toString!=getClass?isProperty=function(property){var original=this.__proto__,result=property in(this.__proto__=null,this);return this.__proto__=original,result}:(constructor=members.constructor,isProperty=function(property){var parent=(this.constructor||constructor).prototype;return property in this&&!(property in parent&&this[property]===parent[property])}),members=null,isProperty.call(this,property)});var PrimitiveTypes={"boolean":1,number:1,string:1,undefined:1},isHostType=function(object,property){var type=typeof object[property];return"object"==type?!!object[property]:!PrimitiveTypes[type]};if(forEach=function(object,callback){var Properties,members,property,size=0;(Properties=function(){this.valueOf=0}).prototype.valueOf=0,members=new Properties;for(property in members)isProperty.call(members,property)&&size++;return Properties=members=null,size?forEach=2==size?function(object,callback){
var property,members={},isFunction=getClass.call(object)==functionClass;for(property in object)isFunction&&"prototype"==property||isProperty.call(members,property)||!(members[property]=1)||!isProperty.call(object,property)||callback(property)}:function(object,callback){var property,isConstructor,isFunction=getClass.call(object)==functionClass;for(property in object)isFunction&&"prototype"==property||!isProperty.call(object,property)||(isConstructor="constructor"===property)||callback(property);(isConstructor||isProperty.call(object,property="constructor"))&&callback(property)}:(members=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],forEach=function(object,callback){var property,length,isFunction=getClass.call(object)==functionClass,hasProperty=!isFunction&&"function"!=typeof object.constructor&&isHostType(object,"hasOwnProperty")?object.hasOwnProperty:isProperty;for(property in object)isFunction&&"prototype"==property||!hasProperty.call(object,property)||callback(property);for(length=members.length;property=members[--length];hasProperty.call(object,property)&&callback(property));}),forEach(object,callback)},!has("json-stringify")){var Escapes={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},leadingZeroes="000000",toPaddedString=function(width,value){return(leadingZeroes+(value||0)).slice(-width)},unicodePrefix="\\u00",quote=function(value){var symbols,result='"',index=0,length=value.length,isLarge=length>10&&charIndexBuggy;for(isLarge&&(symbols=value.split(""));length>index;index++){var charCode=value.charCodeAt(index);switch(charCode){case 8:case 9:case 10:case 12:case 13:case 34:case 92:result+=Escapes[charCode];break;default:if(32>charCode){result+=unicodePrefix+toPaddedString(2,charCode.toString(16));break}result+=isLarge?symbols[index]:charIndexBuggy?value.charAt(index):value[index]}}return result+'"'},serialize=function(property,object,callback,properties,whitespace,indentation,stack){var value,className,year,month,date,time,hours,minutes,seconds,milliseconds,results,element,index,length,prefix,result;try{value=object[property]}catch(exception){}if("object"==typeof value&&value)if(className=getClass.call(value),className!=dateClass||isProperty.call(value,"toJSON"))"function"==typeof value.toJSON&&(className!=numberClass&&className!=stringClass&&className!=arrayClass||isProperty.call(value,"toJSON"))&&(value=value.toJSON(property));else if(value>-1/0&&1/0>value){if(getDay){for(date=floor(value/864e5),year=floor(date/365.2425)+1970-1;getDay(year+1,0)<=date;year++);for(month=floor((date-getDay(year,0))/30.42);getDay(year,month+1)<=date;month++);date=1+date-getDay(year,month),time=(value%864e5+864e5)%864e5,hours=floor(time/36e5)%24,minutes=floor(time/6e4)%60,seconds=floor(time/1e3)%60,milliseconds=time%1e3}else year=value.getUTCFullYear(),month=value.getUTCMonth(),date=value.getUTCDate(),hours=value.getUTCHours(),minutes=value.getUTCMinutes(),seconds=value.getUTCSeconds(),milliseconds=value.getUTCMilliseconds();value=(0>=year||year>=1e4?(0>year?"-":"+")+toPaddedString(6,0>year?-year:year):toPaddedString(4,year))+"-"+toPaddedString(2,month+1)+"-"+toPaddedString(2,date)+"T"+toPaddedString(2,hours)+":"+toPaddedString(2,minutes)+":"+toPaddedString(2,seconds)+"."+toPaddedString(3,milliseconds)+"Z"}else value=null;if(callback&&(value=callback.call(object,property,value)),null===value)return"null";if(className=getClass.call(value),className==booleanClass)return""+value;if(className==numberClass)return value>-1/0&&1/0>value?""+value:"null";if(className==stringClass)return quote(""+value);if("object"==typeof value){for(length=stack.length;length--;)if(stack[length]===value)throw TypeError();if(stack.push(value),results=[],prefix=indentation,indentation+=whitespace,className==arrayClass){for(index=0,length=value.length;length>index;index++)element=serialize(index,value,callback,properties,whitespace,indentation,stack),results.push(element===undef?"null":element);result=results.length?whitespace?"[\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"]":"["+results.join(",")+"]":"[]"}else forEach(properties||value,function(property){var element=serialize(property,value,callback,properties,whitespace,indentation,stack);element!==undef&&results.push(quote(property)+":"+(whitespace?" ":"")+element)}),result=results.length?whitespace?"{\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"}":"{"+results.join(",")+"}":"{}";return stack.pop(),result}};JSON3.stringify=function(source,filter,width){var whitespace,callback,properties,className;if("function"==typeof filter||"object"==typeof filter&&filter)if((className=getClass.call(filter))==functionClass)callback=filter;else if(className==arrayClass){properties={};for(var value,index=0,length=filter.length;length>index;value=filter[index++],className=getClass.call(value),(className==stringClass||className==numberClass)&&(properties[value]=1));}if(width)if((className=getClass.call(width))==numberClass){if((width-=width%1)>0)for(whitespace="",width>10&&(width=10);whitespace.length<width;whitespace+=" ");}else className==stringClass&&(whitespace=width.length<=10?width:width.slice(0,10));return serialize("",(value={},value[""]=source,value),callback,properties,whitespace,"",[])}}if(!has("json-parse")){var Index,Source,fromCharCode=String.fromCharCode,Unescapes={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},abort=function(){throw Index=Source=null,SyntaxError()},lex=function(){for(var value,begin,position,isSigned,charCode,source=Source,length=source.length;length>Index;)switch(charCode=source.charCodeAt(Index)){case 9:case 10:case 13:case 32:Index++;break;case 123:case 125:case 91:case 93:case 58:case 44:return value=charIndexBuggy?source.charAt(Index):source[Index],Index++,value;case 34:for(value="@",Index++;length>Index;)if(charCode=source.charCodeAt(Index),32>charCode)abort();else if(92==charCode)switch(charCode=source.charCodeAt(++Index)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:value+=Unescapes[charCode],Index++;break;case 117:for(begin=++Index,position=Index+4;position>Index;Index++)charCode=source.charCodeAt(Index),charCode>=48&&57>=charCode||charCode>=97&&102>=charCode||charCode>=65&&70>=charCode||abort();value+=fromCharCode("0x"+source.slice(begin,Index));break;default:abort()}else{if(34==charCode)break;for(charCode=source.charCodeAt(Index),begin=Index;charCode>=32&&92!=charCode&&34!=charCode;)charCode=source.charCodeAt(++Index);value+=source.slice(begin,Index)}if(34==source.charCodeAt(Index))return Index++,value;abort();default:if(begin=Index,45==charCode&&(isSigned=!0,charCode=source.charCodeAt(++Index)),charCode>=48&&57>=charCode){for(48==charCode&&(charCode=source.charCodeAt(Index+1),charCode>=48&&57>=charCode)&&abort(),isSigned=!1;length>Index&&(charCode=source.charCodeAt(Index),charCode>=48&&57>=charCode);Index++);if(46==source.charCodeAt(Index)){for(position=++Index;length>position&&(charCode=source.charCodeAt(position),charCode>=48&&57>=charCode);position++);position==Index&&abort(),Index=position}if(charCode=source.charCodeAt(Index),101==charCode||69==charCode){for(charCode=source.charCodeAt(++Index),(43==charCode||45==charCode)&&Index++,position=Index;length>position&&(charCode=source.charCodeAt(position),charCode>=48&&57>=charCode);position++);position==Index&&abort(),Index=position}return+source.slice(begin,Index)}if(isSigned&&abort(),"true"==source.slice(Index,Index+4))return Index+=4,!0;if("false"==source.slice(Index,Index+5))return Index+=5,!1;if("null"==source.slice(Index,Index+4))return Index+=4,null;abort()}return"$"},get=function(value){var results,hasMembers;if("$"==value&&abort(),"string"==typeof value){if("@"==(charIndexBuggy?value.charAt(0):value[0]))return value.slice(1);if("["==value){for(results=[];value=lex(),"]"!=value;hasMembers||(hasMembers=!0))hasMembers&&(","==value?(value=lex(),"]"==value&&abort()):abort()),","==value&&abort(),results.push(get(value));return results}if("{"==value){for(results={};value=lex(),"}"!=value;hasMembers||(hasMembers=!0))hasMembers&&(","==value?(value=lex(),"}"==value&&abort()):abort()),(","==value||"string"!=typeof value||"@"!=(charIndexBuggy?value.charAt(0):value[0])||":"!=lex())&&abort(),results[value.slice(1)]=get(lex());return results}abort()}return value},update=function(source,property,callback){var element=walk(source,property,callback);element===undef?delete source[property]:source[property]=element},walk=function(source,property,callback){var length,value=source[property];if("object"==typeof value&&value)if(getClass.call(value)==arrayClass)for(length=value.length;length--;)update(value,length,callback);else forEach(value,function(property){update(value,property,callback)});return callback.call(source,property,value)};JSON3.parse=function(source,callback){var result,value;return Index=0,Source=""+source,result=get(lex()),"$"!=lex()&&abort(),Index=Source=null,callback&&getClass.call(callback)==functionClass?walk((value={},value[""]=result,value),"",callback):result}}}isLoader&&define(function(){return JSON3})}(this)},{}],48:[function(_dereq_,module,exports){function toArray(list,index){var array=[];index=index||0;for(var i=index||0;i<list.length;i++)array[i-index]=list[i];return array}module.exports=toArray},{}]},{},[1])(1)});